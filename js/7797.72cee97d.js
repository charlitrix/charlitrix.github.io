"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[7797],{7797:(e,l,a)=>{a.r(l),a.d(l,{default:()=>K});var t=a(9835),i=a(6970);const n={class:"row justify-end"},o={class:"column"},d={class:"column q-col-gutter-y-sm"},s={class:"column"},u={key:0},r={class:"row no-wrap q-gutter-x-md"},m={class:"column q-mx-lg q-mb-lg"},p={class:"row justify-end q-mt-md"},c={class:"q-mt-md"},g={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg"},v={class:"row justify-end"},b={key:0,class:"text-grey-8 text-weight-bold"},f={key:1,class:"text-grey-8"};function w(e,l,a,w,y,_){const U=(0,t.up)("q-btn"),D=(0,t.up)("q-separator"),W=(0,t.up)("q-td"),q=(0,t.up)("q-table"),h=(0,t.up)("q-page"),k=(0,t.up)("q-toolbar-title"),B=(0,t.up)("q-toolbar"),C=(0,t.up)("q-select"),V=(0,t.up)("q-item-label"),S=(0,t.up)("q-item"),H=(0,t.up)("q-input"),R=(0,t.up)("q-item-section"),Z=(0,t.up)("q-list"),x=(0,t.up)("q-form"),z=(0,t.up)("q-card"),O=(0,t.up)("q-dialog"),Q=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(h,{class:"q-ma-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",n,[e.permissionRequired("bar","add_brand")?((0,t.wg)(),(0,t.j4)(U,{key:0,"no-caps":"",rounded:"",color:"primary",label:"Create",onClick:l[0]||(l[0]=l=>e.createDialog=!e.createDialog)})):(0,t.kq)("",!0),e.permissionRequired("bar","add_salerates")?((0,t.wg)(),(0,t.j4)(U,{key:1,"no-caps":"",rounded:"",class:"q-ml-md",color:"primary",label:"Create Sale Rates",onClick:l[1]||(l[1]=l=>e.addSaleUnitsDialog=!e.addSaleUnitsDialog)})):(0,t.kq)("",!0)]),(0,t.Wm)(q,{flat:"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"Brands","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No brands available","loading-label":"Loading items..."},{"body-cell-units_details":(0,t.w5)((e=>[(0,t.Wm)(W,{props:e},{default:(0,t.w5)((()=>[(0,t._)("div",o,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.units_available_details,((l,a)=>((0,t.wg)(),(0,t.iD)("div",{key:a},[(0,t._)("div",null,(0,i.zw)(l.quantity)+" "+(0,i.zw)(l.unit),1),a!=e.row.units_available_details.length-1?((0,t.wg)(),(0,t.j4)(D,{key:0,class:"q-my-xs"})):(0,t.kq)("",!0)])))),128))])])),_:2},1032,["props"])])),"body-cell-sale_rates":(0,t.w5)((l=>[(0,t.Wm)(W,{props:l},{default:(0,t.w5)((()=>[(0,t._)("div",d,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.row.units_available_details,(l=>((0,t.wg)(),(0,t.iD)("div",{key:l.id},[(0,t._)("div",s,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.sale_rates,((a,n)=>((0,t.wg)(),(0,t.iD)("div",{class:"column",key:a.id},[(0,t._)("div",null,(0,i.zw)(e.formatPrice(a.amount))+" @ "+(0,i.zw)(a.unit),1),l.sale_rates.length>1&&n<l.sale_rates.length-1?((0,t.wg)(),(0,t.iD)("div",u,[(0,t.Wm)(D,{class:"q-my-sm"})])):(0,t.kq)("",!0)])))),128))])])))),128))])])),_:2},1032,["props"])])),"body-cell-actions":(0,t.w5)((l=>[(0,t.Wm)(W,{props:l},{default:(0,t.w5)((()=>[(0,t._)("div",r,[e.permissionRequired("bar","view_brand")?((0,t.wg)(),(0,t.j4)(U,{key:0,round:"",unelevated:"",size:"sm",icon:"keyboard_arrow_right",color:"primary",to:{name:"BarBrandDetails",params:{id:l.row.id}}},null,8,["to"])):(0,t.kq)("",!0),e.permissionRequired("bar","delete_brand")?((0,t.wg)(),(0,t.j4)(U,{key:1,round:"",unelevated:"",size:"sm",icon:"delete",color:"red",loading:e.submittingData,onClick:a=>e.showDeleteDialog(l.row.id)},null,8,["loading","onClick"])):(0,t.kq)("",!0)])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])])),_:1}),(0,t.Wm)(O,{modelValue:e.createDialog,"onUpdate:modelValue":l[3]||(l[3]=l=>e.createDialog=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{ref:"createDialogForm",onSubmit:e.submitBrandData},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Create New Brands")])),_:1}),(0,t.wy)((0,t.Wm)(U,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Q]])])),_:1}),(0,t.Wm)(D),(0,t._)("div",m,[(0,t.Wm)(C,{"emit-value":"","map-options":"",modelValue:e.categorySelected,"onUpdate:modelValue":l[2]||(l[2]=l=>e.categorySelected=l),label:"Category",loading:e.loadingCategories,options:e.categoriesOptions,"option-label":"name","option-value":"id","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.categoriesOptions.map((e=>e.id)))},null,8,["modelValue","loading","options","rules"]),(0,t._)("div",p,[(0,t.Wm)(U,{label:"Add",color:"primary",onClick:e.addBrand},null,8,["onClick"])]),(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(S,null,{default:(0,t.w5)((()=>[(0,t.Wm)(V,{header:""},{default:(0,t.w5)((()=>[(0,t.Uk)("Brands")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.brandData,((l,a)=>((0,t.wg)(),(0,t.j4)(S,{key:a},{default:(0,t.w5)((()=>[(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Wm)(H,{outlined:"",modelValue:l.name,"onUpdate:modelValue":e=>l.name=e,"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","onUpdate:modelValue","rules"])])),_:2},1024),(0,t.Wm)(R,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{round:"",size:"md",icon:"delete",color:"red",onClick:l=>e.removeBrand(a)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,t._)("div",c,[(0,t.Wm)(U,{rounded:"",loading:e.submittingData,color:"primary",label:"Create",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(O,{modelValue:e.addSaleUnitsDialog,"onUpdate:modelValue":l[6]||(l[6]=l=>e.addSaleUnitsDialog=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{style:{width:"700px",maxWidth:"700px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{ref:"addSaleUnitsDialogForm",onSubmit:e.submitSalesUnitsData},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Create Sales Units")])),_:1}),(0,t.wy)((0,t.Wm)(U,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Q]])])),_:1}),(0,t.Wm)(D),(0,t._)("div",g,[(0,t.Wm)(C,{"use-input":"","hide-selected":"","fill-input":"",modelValue:e.selectedBrand,"onUpdate:modelValue":l[4]||(l[4]=l=>e.selectedBrand=l),loading:e.loadingBrands,options:e.filteredBrandOptions,"option-label":"name",label:"Item",onFilter:e.filterBrandOptions,"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.filteredBrandOptions)},null,8,["modelValue","loading","options","onFilter","rules"]),(0,t.Wm)(C,{"emit-value":"","map-options":"",modelValue:e.selectedUnitAvailable,"onUpdate:modelValue":l[5]||(l[5]=l=>e.selectedUnitAvailable=l),options:e.unitsAvailable,"option-label":"unit",label:"Unit","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.unitsAvailable)},null,8,["modelValue","options","rules"]),(0,t._)("div",v,[(0,t.Wm)(U,{color:"primary",label:"Add",onClick:e.addSaleUnit},null,8,["onClick"])]),(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(S,null,{default:(0,t.w5)((()=>[(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Unit")])),_:1}),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" Total Items in "),e.selectedUnitAvailable?((0,t.wg)(),(0,t.iD)("span",b," Unit - "+(0,i.zw)(e.selectedUnitAvailable.unit),1)):((0,t.wg)(),(0,t.iD)("span",f,"-"))])),_:1})])),_:1}),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Unit Sale Price")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.saleUnitsData,((l,a)=>((0,t.wg)(),(0,t.j4)(S,{key:a},{default:(0,t.w5)((()=>[(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Wm)(C,{outlined:"","use-input":"","hide-selected":"","fill-input":"","emit-value":"","map-options":"",modelValue:l.unit,"onUpdate:modelValue":e=>l.unit=e,options:e.filteredUnitOptions,loading:e.loadingUnits,onFilter:e.filterUnitsOptions,"option-label":"name","option-value":"name",style:{width:"auto",maxWidth:"100%"},"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.filteredUnitOptions.map((e=>e.name)))},null,8,["modelValue","onUpdate:modelValue","options","loading","onFilter","rules"])])),_:2},1024),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Wm)(H,{outlined:"",type:"number",modelValue:l.quantity,"onUpdate:modelValue":e=>l.quantity=e,modelModifiers:{number:!0},"lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","onUpdate:modelValue","rules"])])),_:2},1024),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Wm)(H,{outlined:"",type:"number",modelValue:l.amount,"onUpdate:modelValue":e=>l.amount=e,modelModifiers:{number:!0},"lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","onUpdate:modelValue","rules"])])),_:2},1024),(0,t.Wm)(R,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{round:"",color:"red",icon:"delete",size:"sm",onClick:l=>e.removeSaleUnit(a)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,t._)("div",null,[(0,t.Wm)(U,{rounded:"",color:"primary",label:"Create",class:"full-width",loading:e.submittingData,type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}a(9665);var y=a(9302),_=a(499),U=a(4019),D=a(8221);const W=[{name:"id",label:"#",field:"id",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"units_available",label:"Units",field:"units_available",sortable:!0,align:"left"},{name:"units_details",label:"Units Details",sortable:!0,align:"left"},{name:"sale_rates",label:"Rates",sortable:!0,align:"left"},{name:"actions",label:"Actions",align:"left"}],q=(0,t.aZ)({name:"BarBrands",setup(){const e=(0,y.Z)(),l=(0,_.iH)([]),a=(0,_.iH)(!1),i=(0,_.iH)(!1),n=(0,_.iH)(null),o=(0,_.iH)([]),d=(0,_.iH)(null),s=(0,_.iH)(!1),u=(0,_.iH)([]),r=(0,_.iH)(!1),m=(0,_.iH)(null),p=(0,_.iH)(null),c=(0,_.iH)([]),g=(0,_.iH)([]),v=(0,_.iH)(!1),b=(0,_.iH)([]),f=(0,_.iH)(!1),w=(0,_.iH)(null),q=(0,t.Fl)((()=>p.value?p.value.units_available_details:[])),h=(0,_.iH)([]),k=(0,_.iH)([]),B=(0,_.iH)(!1),C=(0,_.iH)(null),V=(0,_.iH)({}),S=(0,_.iH)(!1);function H(){return a.value=!0,(0,U.getBarBrands)().then((e=>{l.value=e.data})).catch((e=>{})).finally((()=>{a.value=!1}))}function R(){return f.value=!0,(0,U.getUnits)().then((e=>{b.value=e.data,k.value=e.data})).finally((()=>{f.value=!1}))}function Z(){v.value=!0,(0,U.getBarBrands)("?available=True").then((e=>{g.value=e.data,c.value=e.data})).finally((()=>{v.value=!1}))}function x(){return s.value=!0,(0,U.getBarCategories)().then((e=>{u.value=e.data})).catch((e=>{})).finally((()=>{s.value=!1}))}return(0,t.bv)((()=>{H().then((()=>{x().then((()=>{R().then((()=>{Z()}))}))}))})),{loadingData:a,tableRows:l,tableColumns:W,brandData:o,createDialog:i,createDialogForm:n,categorySelected:d,loadingCategories:s,categoriesOptions:u,addSaleUnitsDialog:r,addSaleUnitsDialogForm:m,selectedBrand:p,filteredBrandOptions:c,selectedUnitAvailable:w,unitsAvailable:q,saleUnitsData:h,filteredUnitOptions:k,loadingUnits:f,loadingBrands:v,updateDialog:B,updateDialogForm:C,editItem:V,submittingData:S,addSaleUnit(){h.value.push({})},removeSaleUnit(e){h.value.splice(e,1)},addBrand(){o.value.push({})},removeBrand(l){e.dialog({title:"Confirm",message:"Are you sure ?",cancel:!0}).onOk((()=>{o.value.splice(l,1)}))},filterBrandOptions(e,l){l((()=>{c.value=g.value.filter((l=>l.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1))}))},filterUnitsOptions(e,l){l((()=>{k.value=b.value.filter((l=>l.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1))}))},submitBrandData(){n.value.validate()&&(S.value=!0,(0,U.createBarBrands)(d.value,{items:o.value}).then((l=>{e.notify({type:"positive",message:l.data}),o.value={},H(),i.value=!1,n.value.resetValidation()})).catch((l=>{e.notify({type:"negative",message:l.response.data.length<1e3?l.response.data:"Server error please contact system administrator"})})).finally((()=>{S.value=!1})))},updateBrandData(){if(C.value.validate()){S.value=!0;let l=V.value.id;delete V.value.id,(0,U.editBarBrands)(l,{...V.value}).then((l=>{e.notify({type:"positive",message:l.data}),V.value={},H(),B.value=!1,C.value.resetValidation()})).catch((l=>{e.notify({type:"negative",message:l.response.data.length<1e3?l.response.data:"Server error please contact system administrator"})})).finally((()=>{S.value=!1}))}},submitSalesUnitsData(){m.value.validate()&&(S.value=!0,(0,U.createBrandSaleRates)(w.value.id,{items:h.value}).then((l=>{p.value=null,w.value=null,h.value=[],r.value=!1,e.notify({type:"positive",message:l.data}),H(),m.value.resetValidation()})).catch((l=>{e.notify({type:"negative",message:l.response.data.length<1e3?l.response.data:"Server error please contact system administrator"})})).finally((()=>{S.value=!1})))},showDeleteDialog(l){e.dialog({title:"Confirm",message:"Please confirm delete?",cancel:!0}).onOk((()=>{S.value=!0,(0,U.deleteBarBrands)(l).then((e=>{(0,D.displayNotification)(e.data,"positive"),H()})).catch((e=>{(0,D.displayNotification)(e.response.data,"negative")})).finally((()=>{S.value=!1}))}))}}}});var h=a(1639),k=a(9885),B=a(8879),C=a(7355),V=a(7220),S=a(926),H=a(2074),R=a(4458),Z=a(8326),x=a(1663),z=a(1973),O=a(4581),Q=a(3246),I=a(490),A=a(3115),F=a(1233),L=a(6611),j=a(2146),T=a(9984),P=a.n(T);const Y=(0,h.Z)(q,[["render",w]]),K=Y;P()(q,"components",{QPage:k.Z,QBtn:B.Z,QTable:C.Z,QTd:V.Z,QSeparator:S.Z,QDialog:H.Z,QCard:R.Z,QForm:Z.Z,QToolbar:x.Z,QToolbarTitle:z.Z,QSelect:O.Z,QList:Q.Z,QItem:I.Z,QItemLabel:A.Z,QItemSection:F.Z,QInput:L.Z}),P()(q,"directives",{ClosePopup:j.Z})}}]);