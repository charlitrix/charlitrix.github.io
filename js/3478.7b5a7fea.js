"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[3478],{3478:(e,l,t)=>{t.r(l),t.d(l,{default:()=>R});var a=t(9835),u=t(6970);const i={class:"q-px-xl q-pb-xl q-pt-lg column q-gutter-y-lg"},d=(0,a._)("div",{class:"text-h5"},"Update Draft Item",-1),o={class:"column q-gutter-y-md q-mb-lg"},n={class:"q-px-lg"},m={class:"row justify-between"},s=(0,a._)("div",{class:"q-mx-md"},"Actions",-1),r={class:"row no-wrap"};function c(e,l,t,c,p,g){const f=(0,a.up)("q-input"),b=(0,a.up)("q-btn"),v=(0,a.up)("q-form"),w=(0,a.up)("q-item-label"),y=(0,a.up)("q-item-section"),I=(0,a.up)("q-item"),W=(0,a.up)("q-separator"),_=(0,a.up)("q-list"),q=(0,a.up)("q-card"),C=(0,a.up)("q-page"),D=(0,a.up)("q-toolbar-title"),h=(0,a.up)("q-toolbar"),k=(0,a.up)("q-card-section"),x=(0,a.up)("q-card-actions"),V=(0,a.up)("q-dialog"),Z=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(C,{class:"q-pa-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{flat:"",class:"q-mb-xl"},{default:(0,a.w5)((()=>[(0,a._)("div",i,[d,(0,a.Wm)(v,{ref:"updateCategoryForm",onSubmit:e.updateCategory},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(f,{label:"Code",modelValue:e.categoryData.code,"onUpdate:modelValue":l[0]||(l[0]=l=>e.categoryData.code=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,a.Wm)(f,{label:"Name",modelValue:e.categoryData.name,"onUpdate:modelValue":l[1]||(l[1]=l=>e.categoryData.name=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,a._)("div",n,[(0,a.Wm)(b,{rounded:"",class:"full-width",color:"primary",label:"Update",type:"submit",loading:e.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"]),(0,a._)("div",m,[(0,a._)("div",{class:"text-grey-9",style:(0,u.j5)({fontSize:"1.2rem"})}," Budget Items ",4),(0,a.Wm)(b,{color:"primary",class:"q-px-xl",label:"Add Item",onClick:l[2]||(l[2]=l=>e.subItemDialog=!e.subItemDialog)})]),(0,a._)("div",null,[(0,a.Wm)(_,{separator:""},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{class:"text-weight-medium"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Code")])),_:1})])),_:1}),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Name")])),_:1})])),_:1}),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Amount")])),_:1})])),_:1}),(0,a.Wm)(y,{side:""},{default:(0,a.w5)((()=>[s])),_:1})])),_:1}),(0,a.Wm)(W,{class:"bg-grey-7"}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.categoryData.items,((l,t)=>((0,a.wg)(),(0,a.j4)(I,{key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(l.code),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(l.name),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(e.formatPrice(l.amount)),1)])),_:2},1024),(0,a.Wm)(y,{side:""},{default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a.Wm)(b,{flat:"",round:"",color:"primary",icon:"edit",onClick:l=>e.selectEditItem(t),loading:e.submitting},null,8,["onClick","loading"]),(0,a.Wm)(b,{flat:"",round:"",color:"red",icon:"delete",onClick:t=>e.deleteSubItem(l.id),loading:e.submitting,disabled:1==e.categoryData.items.length},null,8,["onClick","loading","disabled"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])])),_:1})])),_:1}),(0,a.Wm)(V,{persistent:"",modelValue:e.subItemDialog,"onUpdate:modelValue":l[6]||(l[6]=l=>e.subItemDialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{style:{width:"500px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{ref:"subItemForm",onSubmit:e.submitSubItem},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"bg-primary text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{textContent:(0,u.zw)(e.subItem.id?"Update Budget Item":"New Budget Item")},null,8,["textContent"]),(0,a.wy)((0,a.Wm)(b,{flat:"",round:"",size:"md",icon:"close",onClick:e.resetForm},null,8,["onClick"]),[[Z]])])),_:1}),(0,a.Wm)(W),(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{modelValue:e.subItem.code,"onUpdate:modelValue":l[3]||(l[3]=l=>e.subItem.code=l),modelModifiers:{trim:!0},label:"Code","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,a.Wm)(f,{modelValue:e.subItem.name,"onUpdate:modelValue":l[4]||(l[4]=l=>e.subItem.name=l),modelModifiers:{trim:!0},label:"Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,a.Wm)(f,{modelValue:e.subItem.amount,"onUpdate:modelValue":l[5]||(l[5]=l=>e.subItem.amount=l),modelModifiers:{number:!0},type:"number",label:"Amount","lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"])])),_:1}),(0,a.Wm)(x,{align:"evenly",class:"q-mb-lg q-mx-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{rounded:"",label:e.subItem.id?"Update":"Add",class:"full-width",color:"primary",type:"submit",loading:e.submitting},null,8,["label","loading"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var p=t(499),g=t(9302),f=t(8221),b=t(4019);const v=(0,a.aZ)({name:"BudgetDraftDetails",props:["id"],setup(e){const l=(0,g.Z)(),t=(0,p.iH)(null),u=(0,p.iH)({}),i=(0,p.iH)({}),d=((0,p.iH)([]),(0,p.iH)(!1)),o=((0,p.iH)(!1),(0,p.iH)(!0)),n=(0,p.iH)(!1),m=(0,p.iH)(!1),s=(0,p.iH)(null);function r(){o.value=!0,(0,b.getBudgetDraft)(`/${e.id}`).then((e=>{u.value=e.data})).finally((()=>{o.value=!1}))}function c(){(i.value.id||m.value)&&(i.value={},m.value=!1)}function v(){if(i.value.id){let e=i.value.id;return delete i.value.id,(0,b.editDraftBudgetItem)(e,{...i.value})}return(0,b.addDraftBudgetItem)(e.id,{...i.value})}return(0,a.bv)((()=>{r()})),(0,a.m0)((()=>{o.value?l.loading.show({message:"Please wait..."}):l.loading.hide()})),{updateCategoryForm:t,categoryData:u,subItem:i,subItemDialog:d,submitting:n,resetForm:c,subItemForm:s,selectEditItem(e){i.value={...u.value.items[e]},d.value=!0},updateCategory(){t.value.validate()&&l.dialog({title:"Confirmation",message:"Confirm update",cancel:!0}).onOk((()=>{n.value=!0,(0,b.editDraftBudgetCategory)(e.id,{code:u.value.code,name:u.value.name}).then((e=>{(0,f.displayNotification)(e.data,"positive"),t.value.resetValidation(),r()})).catch((e=>{(0,f.displayNotification)(e.response.data,"negative")})).finally((()=>{n.value=!1}))}))},submitSubItem(){s.value.validate()&&l.dialog({title:"Confirmation",message:"Confirm update",cancel:!0}).onOk((()=>{n.value=!0,v().then((e=>{(0,f.displayNotification)(e.data,"positive"),d.value=!1,m.value=!0,c(),s.value.resetValidation(),r()})).catch((e=>{(0,f.displayNotification)(e.response.data,"negative")})).finally((()=>{n.value=!1}))}))},deleteSubItem(e){l.dialog({title:"Confirmation",message:"Confirm delete",cancel:!0}).onOk((()=>{n.value=!0,(0,b.deleteDraftBudgetItem)(e).then((e=>{(0,f.displayNotification)(e.data,"positive"),r()})).catch((e=>{(0,f.displayNotification)(e.response.data,"negative")})).finally((()=>{n.value=!1}))}))}}}});var w=t(1639),y=t(9885),I=t(4458),W=t(8326),_=t(6611),q=t(8879),C=t(3246),D=t(490),h=t(1233),k=t(3115),x=t(926),V=t(2074),Z=t(1663),Q=t(1973),U=t(3190),H=t(1821),S=t(2146),z=t(9984),B=t.n(z);const N=(0,w.Z)(v,[["render",c]]),R=N;B()(v,"components",{QPage:y.Z,QCard:I.Z,QForm:W.Z,QInput:_.Z,QBtn:q.Z,QList:C.Z,QItem:D.Z,QItemSection:h.Z,QItemLabel:k.Z,QSeparator:x.Z,QDialog:V.Z,QToolbar:Z.Z,QToolbarTitle:Q.Z,QCardSection:U.Z,QCardActions:H.Z}),B()(v,"directives",{ClosePopup:S.Z})}}]);