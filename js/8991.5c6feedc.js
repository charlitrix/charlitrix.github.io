"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[8991],{8991:(e,l,a)=>{a.r(l),a.d(l,{default:()=>C});var o=a(9835);const t={class:"row justify-end"},n={class:"row no-wrap q-gutter-x-md"},i={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg"},s={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg"};function d(e,l,a,d,u,m){const r=(0,o.up)("q-btn"),p=(0,o.up)("q-td"),c=(0,o.up)("q-table"),g=(0,o.up)("q-page"),b=(0,o.up)("q-toolbar-title"),x=(0,o.up)("q-toolbar"),v=(0,o.up)("q-separator"),f=(0,o.up)("q-select"),y=(0,o.up)("q-input"),w=(0,o.up)("q-form"),D=(0,o.up)("q-card"),E=(0,o.up)("q-dialog"),q=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(g,{class:"q-ma-xl"},{default:(0,o.w5)((()=>[(0,o._)("div",t,[e.permissionRequired("rooms","add_expense")?((0,o.wg)(),(0,o.j4)(r,{key:0,"no-caps":"",rounded:"",color:"primary",label:"Add Expense",onClick:l[0]||(l[0]=l=>e.addExpenseDialog=!e.addExpenseDialog)})):(0,o.kq)("",!0)]),(0,o.Wm)(c,{flat:"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"Expenses","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No expenses available","loading-label":"Loading expenses..."},{"body-cell-actions":(0,o.w5)((l=>[(0,o.Wm)(p,{props:l},{default:(0,o.w5)((()=>[(0,o._)("div",n,[e.permissionRequired("rooms","add_expense")?((0,o.wg)(),(0,o.j4)(r,{key:0,round:"",size:"sm",color:"primary",icon:"add",onClick:a=>e.addExpense(l.rowIndex),loading:e.submittedExpenseData},null,8,["onClick","loading"])):(0,o.kq)("",!0),e.permissionRequired("rooms","change_expense")?((0,o.wg)(),(0,o.j4)(r,{key:1,round:"",size:"sm",color:"primary",icon:"edit",onClick:a=>e.selectEditItem(l.rowIndex),loading:e.submittedExpenseData},null,8,["onClick","loading"])):(0,o.kq)("",!0),e.permissionRequired("rooms","delete_expense")?((0,o.wg)(),(0,o.j4)(r,{key:2,round:"",size:"sm",color:"red",icon:"delete",onClick:a=>e.showDeleteDialog(l.row.id),loading:e.submittedExpenseData},null,8,["onClick","loading"])):(0,o.kq)("",!0)])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])])),_:1}),(0,o.Wm)(E,{modelValue:e.addExpenseDialog,"onUpdate:modelValue":l[4]||(l[4]=l=>e.addExpenseDialog=l)},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{style:{width:"350px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{ref:"addExpenseDialogForm",onSubmit:e.submitExpenseData},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Uk)("Expense")])),_:1}),(0,o.wy)((0,o.Wm)(r,{flat:"",round:"",size:"md",icon:"close"},null,512),[[q]])])),_:1}),(0,o.Wm)(v),(0,o._)("div",i,[(0,o.Wm)(f,{"emit-value":"","map-options":"",modelValue:e.roomId,"onUpdate:modelValue":l[1]||(l[1]=l=>e.roomId=l),loading:e.loadingRooms,options:e.roomsOptions,label:"Room","option-label":"name","option-value":"id","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.roomsOptions.map((e=>e.id)))},null,8,["modelValue","loading","options","rules"]),(0,o.Wm)(y,{modelValue:e.expenseData.name,"onUpdate:modelValue":l[2]||(l[2]=l=>e.expenseData.name=l),modelModifiers:{trim:!0},label:"Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,o.Wm)(y,{modelValue:e.expenseData.amount,"onUpdate:modelValue":l[3]||(l[3]=l=>e.expenseData.amount=l),modelModifiers:{number:!0},type:"number",label:"Amount","lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,o._)("div",null,[(0,o.Wm)(r,{rounded:"","no-caps":"",loading:e.submittedExpenseData,color:"primary",label:"Add",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(E,{modelValue:e.updateDialog,"onUpdate:modelValue":l[7]||(l[7]=l=>e.updateDialog=l)},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{style:{width:"350px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{ref:"updateDialogForm",onSubmit:e.updateExpenseData},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Uk)("Update Expense Item")])),_:1}),(0,o.wy)((0,o.Wm)(r,{flat:"",round:"",size:"md",icon:"close"},null,512),[[q]])])),_:1}),(0,o.Wm)(v),(0,o._)("div",s,[(0,o.Wm)(f,{"emit-value":"","map-options":"",modelValue:e.editExpenseItem.room_id,"onUpdate:modelValue":l[5]||(l[5]=l=>e.editExpenseItem.room_id=l),loading:e.loadingRooms,options:e.roomsOptions,label:"Room","option-label":"name","option-value":"id","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.roomsOptions.map((e=>e.id)))},null,8,["modelValue","loading","options","rules"]),(0,o.Wm)(y,{modelValue:e.editExpenseItem.name,"onUpdate:modelValue":l[6]||(l[6]=l=>e.editExpenseItem.name=l),modelModifiers:{trim:!0},label:"Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,o._)("div",null,[(0,o.Wm)(r,{rounded:"","no-caps":"",loading:e.submittedExpenseData,color:"primary",label:"Update",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var u=a(9302),m=a(499),r=a(4019),p=a(8221);const c=[{name:"id",label:"#",field:"id",sortable:!0,align:"left"},{name:"room",label:"Room",field:e=>e.room.name,sortable:!0,align:"left"},{name:"expense",label:"Expense",field:"name",sortable:!0,align:"left"},{name:"amount",label:"Amount",field:e=>(0,p.formatPrice)(e.amount),sortable:!0,align:"left"},{name:"date",label:"Date",field:"created",sortable:!0,align:"left"},{name:"actions",label:"Actions",align:"left"}],g=(0,o.aZ)({name:"ExpensesIndex",setup(){const e=(0,u.Z)(),l=(0,m.iH)([]),a=(0,m.iH)(!1),t=(0,m.iH)(!1),n=(0,m.iH)(null),i=(0,m.iH)(!1),s=(0,m.iH)({}),d=(0,m.iH)([]),g=(0,m.iH)(!1),b=(0,m.iH)(null),x=(0,m.iH)(!1),v=(0,m.iH)(null),f=(0,m.iH)({});function y(){return a.value=!0,(0,r.getRoomsExpenses)().then((e=>{l.value=e.data})).catch((e=>{})).finally((()=>{a.value=!1}))}function w(){g.value=!0,(0,r.getRooms)().then((e=>{d.value=e.data})).finally((()=>{g.value=!1}))}return(0,o.bv)((()=>{y().then((()=>{w()}))})),{loadingData:a,tableRows:l,tableColumns:c,expenseData:s,addExpenseDialog:t,addExpenseDialogForm:n,submittedExpenseData:i,roomsOptions:d,loadingRooms:g,roomId:b,editExpenseItem:f,updateDialog:x,updateDialogForm:v,selectEditItem(e){let a=l.value[e];f.value={room_id:a.room.id,id:a.id,name:a.name},x.value=!0},updateExpenseData(){if(v.value.validate()){i.value=!0;let l=f.value.id;delete f.value.id,(0,r.editRoomsExpense)(l,{...f.value}).then((l=>{e.notify({type:"positive",message:l.data}),f.value={},y(),x.value=!1,v.value.resetValidation()})).catch((l=>{e.notify({type:"negative",message:l.response.data.length<1e3?l.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1}))}},submitExpenseData(){n.value.validate()&&(i.value=!0,(0,r.createRoomsExpense)(b.value,{...s.value}).then((l=>{e.notify({type:"positive",message:l.data}),s.value={},b.value=null,y(),t.value=!1,n.value.resetValidation()})).catch((l=>{e.notify({type:"negative",message:l.response.data.length<1e3?l.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1})))},addExpense(e){s.value={...l.value[e],amount:null},t.value=!0},showDeleteDialog(l){e.dialog({title:"Confirm",message:"Please confirm delete?",cancel:!0}).onOk((()=>{i.value=!0,(0,r.deleteRoomsExpense)(l).then((e=>{(0,p.displayNotification)(e.data,"positive"),y()})).catch((e=>{(0,p.displayNotification)(e.response.data,"negative")})).finally((()=>{i.value=!1}))}))}}}});var b=a(1639),x=a(9885),v=a(8879),f=a(7355),y=a(7220),w=a(2074),D=a(4458),E=a(8326),q=a(1663),h=a(1973),R=a(926),_=a(4581),W=a(6611),k=a(2146),V=a(9984),I=a.n(V);const Z=(0,b.Z)(g,[["render",d]]),C=Z;I()(g,"components",{QPage:x.Z,QBtn:v.Z,QTable:f.Z,QTd:y.Z,QDialog:w.Z,QCard:D.Z,QForm:E.Z,QToolbar:q.Z,QToolbarTitle:h.Z,QSeparator:R.Z,QSelect:_.Z,QInput:W.Z}),I()(g,"directives",{ClosePopup:k.Z})}}]);