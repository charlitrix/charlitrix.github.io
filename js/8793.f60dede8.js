"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[8793],{8793:(e,l,a)=>{a.r(l),a.d(l,{default:()=>Ue});var t=a(9835),u=a(6970),o=a(1957);const i={class:"row justify-end q-gutter-x-lg"},r={class:"q-ma-lg q-column q-col-gutter-y-lg q-mb-xl"},s=(0,t._)("div",{class:"row justify-center text-h4"},"Invoice Form",-1),n={class:"row q-gutter-x-lg"},d={class:"col-md-4"},m={class:"row q-col-gutter-x-md"},c=(0,t._)("div",{class:"text-h5 q-mb-md"},"Customer",-1),w={class:"row items-center"},_=(0,t._)("div",{class:"col-3 q-mb-lg"},"Name:",-1),p={class:"col"},f={class:"row items-center"},v=(0,t._)("div",{class:"col-3 q-mb-lg"},"Details:",-1),g={class:"col"},y={class:"col-md-3 q-py-xl"},W={class:"row items-center"},h=(0,t._)("div",{class:"col-3 q-mb-lg"},"Due Date:",-1),x={class:"col"},q={class:"row items-center justify-end"},C={class:"col-md-4 q-py-xl text-primary text-h5 text-center"},k=(0,t._)("div",null,"Invoice Total",-1),D={class:"full-width"},b=(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th",null,"#"),(0,t._)("th",null,"Name"),(0,t._)("th",null,"Specifications"),(0,t._)("th",null,"Quantity"),(0,t._)("th",null,"Rate"),(0,t._)("th",null,"Total (Ugx)")])],-1),U={key:0,class:"text-weight-bold"},L=(0,t._)("td",{colspan:"5",class:"text-right"},"Sub Total",-1),z={colspan:"5",class:"text-right"},V={class:"text-weight-bold"},F=(0,t._)("td",{colspan:"5",class:"text-right"},"Total",-1),I={key:1,class:"text-weight-bold"},P=(0,t._)("td",{colspan:"5",class:"text-right"},"Paid",-1),S={key:2,class:"text-weight-bold"},H=(0,t._)("td",{colspan:"5",class:"text-right"},"Balance Due",-1),O={class:"q-py-xl"},R={class:"column q-mx-lg q-mb-xl q-mt-lg"},Z=(0,t._)("div",{class:"q-px-lg"},null,-1),Q=(0,t._)("div",{class:"q-px-md"},null,-1),Y=(0,t._)("div",{class:"text-grey-9 q-pa-md"},"No sales orders...",-1),A=(0,t._)("div",{class:"text-grey-9 q-pa-md"},"No sales orders...",-1),N=(0,t._)("div",{class:"text-grey-9 q-pa-md"},"No sales orders...",-1),T=(0,t._)("div",{class:"q-py-md"},null,-1),E={class:"q-mx-lg q-mb-lg q-mt-sm"},j={class:"row q-my-lg q-gutter-x-lg items-center"},B={class:"q-column q-col-gutter-y-md q-mx-lg q-mb-lg"},M=(0,t._)("div",{class:"text-h5"},"Add Customer",-1),K={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg q-mt-sm"},$={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg q-mt-sm"};function G(e,l,a,G,J,X){const ee=(0,t.up)("q-btn"),le=(0,t.up)("q-field"),ae=(0,t.up)("q-date"),te=(0,t.up)("q-popup-proxy"),ue=(0,t.up)("q-markup-table"),oe=(0,t.up)("q-form"),ie=(0,t.up)("q-page"),re=(0,t.up)("q-toolbar-title"),se=(0,t.up)("q-toolbar"),ne=(0,t.up)("q-input"),de=(0,t.up)("q-item-section"),me=(0,t.up)("q-item"),ce=(0,t.up)("q-checkbox"),we=(0,t.up)("q-item-label"),_e=(0,t.up)("q-list"),pe=(0,t.up)("q-card"),fe=(0,t.up)("q-dialog"),ve=(0,t.up)("q-select"),ge=(0,t.up)("q-slide-transition"),ye=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(ie,{class:"q-pa-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t.Wm)(ee,{"no-caps":"",rounded:"",label:"Sales Orders",color:"primary",onClick:l[0]||(l[0]=l=>e.salesOrdersDialog=!e.salesOrdersDialog)}),(0,t.Wm)(ee,{"no-caps":"",rounded:"",label:"Add Extra Charges",color:"primary",onClick:l[1]||(l[1]=l=>e.extraChargesDialog=!e.extraChargesDialog)}),(0,t.Wm)(ee,{"no-caps":"",rounded:"",label:"Add Extra Items",color:"primary",onClick:l[2]||(l[2]=l=>e.newItemFormDialog=!e.newItemFormDialog)})]),(0,t.Wm)(oe,{ref:"invoiceForm",onSubmit:e.submitNewInvoice},{default:(0,t.w5)((()=>[(0,t._)("div",r,[s,(0,t._)("div",null,[(0,t._)("div",n,[(0,t._)("div",d,[(0,t._)("div",m,[c,(0,t._)("div",null,[(0,t.Wm)(ee,{round:"",unelevated:"",size:"sm",color:"primary",icon:"edit",onClick:l[3]||(l[3]=l=>e.setCustomerDialog=!e.setCustomerDialog)})])]),(0,t._)("div",w,[_,(0,t._)("div",p,[(0,t.Wm)(le,{dense:"",outlined:"",modelValue:e.invoiceCustomerData.name,"onUpdate:modelValue":l[4]||(l[4]=l=>e.invoiceCustomerData.name=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules("Name is required")},{control:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.invoiceCustomerData.name),1)])),_:1},8,["modelValue","rules"])])]),(0,t._)("div",f,[v,(0,t._)("div",g,[(0,t.Wm)(le,{dense:"",outlined:"",type:"textarea",rows:3,modelValue:e.invoiceCustomerData.details,"onUpdate:modelValue":l[5]||(l[5]=l=>e.invoiceCustomerData.details=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules("Other details like the address are required")},{control:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.invoiceCustomerData.details),1)])),_:1},8,["modelValue","rules"])])])]),(0,t._)("div",y,[(0,t._)("div",W,[h,(0,t._)("div",x,[(0,t.Wm)(le,{outlined:"",modelValue:e.invoiceDueDate,"onUpdate:modelValue":l[8]||(l[8]=l=>e.invoiceDueDate=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},{control:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.invoiceDueDate),1)])),append:(0,t.w5)((()=>[(0,t.Wm)(ee,{round:"",color:"primary",icon:"event"},{default:(0,t.w5)((()=>[(0,t.Wm)(te,{ref:"dateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(ae,{modelValue:e.invoiceDueDate,"onUpdate:modelValue":[l[6]||(l[6]=l=>e.invoiceDueDate=l),l[7]||(l[7]=l=>e.$refs.dateDialog.hide())],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",q,[(0,t.wy)((0,t.Wm)(ee,{label:"Close",color:"primary",flat:""},null,512),[[ye]])])])),_:1},8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue","rules"])])])]),(0,t._)("div",C,[k,(0,t._)("div",null,(0,u.zw)(e.formatPrice(e.invoiceTotal)),1)])])]),(0,t._)("div",null,[(0,t.Wm)(le,{outlined:"",modelValue:e.itemsList,"onUpdate:modelValue":l[9]||(l[9]=l=>e.itemsList=l),"lazy-rules":"ondemand",rules:e.nonEmptyRequiredRules("Cannot submit an empty invoice form")},{control:(0,t.w5)((()=>[(0,t._)("div",D,[(0,t.Wm)(ue,{bordered:"",flat:"",square:"",separator:"cell"},{default:(0,t.w5)((()=>[b,(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.itemsList,((l,a)=>((0,t.wg)(),(0,t.iD)("tr",{key:a},[(0,t._)("td",null,(0,u.zw)(a+1),1),(0,t._)("td",null,(0,u.zw)(l.name),1),(0,t._)("td",null,(0,u.zw)(l.specifications),1),(0,t._)("td",null,(0,u.zw)(l.quantity),1),(0,t._)("td",null,(0,u.zw)(e.formatPrice(l.unit_price)),1),(0,t._)("td",null,(0,u.zw)(e.formatPrice(l.unit_price*l.quantity)),1)])))),128)),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.extraItemsList,((l,a)=>((0,t.wg)(),(0,t.iD)("tr",{key:a+e.itemsList.length},[(0,t._)("td",null,(0,u.zw)(e.itemsList.length+a+1),1),(0,t._)("td",null,(0,u.zw)(l.name),1),(0,t._)("td",null,(0,u.zw)(l.specifications),1),(0,t._)("td",null,(0,u.zw)(l.quantity),1),(0,t._)("td",null,(0,u.zw)(e.formatPrice(l.unit_price)),1),(0,t._)("td",null,[(0,t.Uk)((0,u.zw)(e.formatPrice(l.unit_price*l.quantity))+" ",1),(0,t.Wm)(ee,{round:"",flat:"",icon:"delete",color:"red",size:"sm",onClick:l=>e.removeExtraItem(a)},null,8,["onClick"])])])))),128)),e.extraChargesList.length>0?((0,t.wg)(),(0,t.iD)("tr",U,[L,(0,t._)("td",null,(0,u.zw)(e.formatPrice(e.itemsProductSum(e.itemsList,"unit_price","quantity")+e.itemsProductSum(e.extraItemsList,"unit_price","quantity"))),1)])):(0,t.kq)("",!0),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.extraChargesList,((l,a)=>((0,t.wg)(),(0,t.iD)("tr",{key:a},[(0,t._)("td",z,(0,u.zw)(l.name),1),(0,t._)("td",null,[(0,t.Uk)((0,u.zw)(e.formatPrice(Math.ceil((e.itemsProductSum(e.itemsList,"unit_price","quantity")+e.itemsProductSum(e.extraItemsList,"unit_price","quantity"))*(l.rate/100))))+" ("+(0,u.zw)(l.rate)+"%) ",1),(0,t.Wm)(ee,{round:"",flat:"",icon:"delete",color:"red",size:"sm",onClick:l=>e.extraChargesList.splice(a,1)},null,8,["onClick"])])])))),128)),(0,t._)("tr",V,[F,(0,t._)("td",null,(0,u.zw)(e.formatPrice(e.invoiceTotal)),1)]),0!=e.totalPaidAmount?((0,t.wg)(),(0,t.iD)("tr",I,[P,(0,t._)("td",null,(0,u.zw)(e.formatPrice(e.totalPaidAmount)),1)])):(0,t.kq)("",!0),0!=e.totalPaidAmount?((0,t.wg)(),(0,t.iD)("tr",S,[H,(0,t._)("td",null,(0,u.zw)(e.formatPrice(e.invoiceTotal-e.totalPaidAmount)),1)])):(0,t.kq)("",!0)])])),_:1})])])),_:1},8,["modelValue","rules"]),(0,t._)("div",O,[(0,t.Wm)(ee,{"no-caps":"",rounded:"",class:"full-width",color:"primary",label:"Create Invoice",type:"submit",loading:e.submittingData},null,8,["loading"])])])])])),_:1},8,["onSubmit"])])),_:1}),(0,t.Wm)(fe,{modelValue:e.salesOrdersDialog,"onUpdate:modelValue":l[14]||(l[14]=l=>e.salesOrdersDialog=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(pe,{style:{width:"650px",maxWidth:"650px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(se,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(re,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Sales Orders")])),_:1}),(0,t.wy)((0,t.Wm)(ee,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ye]])])),_:1}),(0,t._)("div",R,[(0,t.Wm)(ne,{rounded:"",clearable:"",outlined:"",type:"search",placeholder:"Search here ...",hint:"For example customer name, contact, item name",modelValue:e.searchFilter,"onUpdate:modelValue":l[10]||(l[10]=l=>e.searchFilter=l)},null,8,["modelValue"]),(0,t.Wm)(_e,{separator:"",dense:"",bordered:"",class:"q-mt-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(me,{dense:"",class:"text-grey-9"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[Z])),_:1}),(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[Q])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" Customer ")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" Bill ")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" Paid ")])),_:1})])),_:1}),(0,t.Wm)(me,{dense:"",class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Restaurant and Bar")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.restuarantAndBarSalesFilter,(a=>((0,t.wg)(),(0,t.j4)(me,{dense:"",key:a.id},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(me,{dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(ce,{modelValue:e.selectedOrders,"onUpdate:modelValue":l[11]||(l[11]=l=>e.selectedOrders=l),val:"restaurantAndBar-"+a.id},null,8,["modelValue","val"])])])),_:2},1024),(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(ee,{flat:"",round:"",size:"sm",icon:a.show?"expand_less":"expand_more",color:"primary",onClick:e=>a.show=!a.show},null,8,["icon","onClick"])])])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(we,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.customer.name),1)])),_:2},1024),(0,t.Wm)(we,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.customer.contact),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(a.bill)),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(a.paid)),1)])),_:2},1024)])),_:2},1024),(0,t.wy)((0,t.Wm)(me,{dense:"",class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(me,{dense:"",class:"text-grey-9"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Name")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Rate")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Qty")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Total")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.sales,(l=>((0,t.wg)(),(0,t.j4)(me,{dense:"",key:l.id},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(l.item_name),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(l.unit_price)),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(l.quantity),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(l.unit_price*l.quantity)),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1536),[[o.F8,a.show]])])),_:2},1024)])),_:2},1024)))),128)),0==e.restuarantAndBarSalesFilter.length?((0,t.wg)(),(0,t.j4)(me,{key:0,dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[Y])),_:1})])),_:1})):(0,t.kq)("",!0),(0,t.Wm)(me,{dense:"",class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Rooms")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.roomSalesFilter,(a=>((0,t.wg)(),(0,t.j4)(me,{dense:"",key:a.id},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(me,{dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(ce,{modelValue:e.selectedOrders,"onUpdate:modelValue":l[12]||(l[12]=l=>e.selectedOrders=l),val:"room-"+a.id},null,8,["modelValue","val"])])])),_:2},1024),(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(ee,{flat:"",round:"",size:"sm",icon:a.show?"expand_less":"expand_more",color:"primary",onClick:e=>a.show=!a.show},null,8,["icon","onClick"])])])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(we,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.customer.name),1)])),_:2},1024),(0,t.Wm)(we,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.customer.contact),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(a.bill)),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(a.paid)),1)])),_:2},1024)])),_:2},1024),(0,t.wy)((0,t.Wm)(me,{dense:"",class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(me,{dense:"",class:"text-grey-9"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Name")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Rate")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Qty")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Total")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.details,(l=>((0,t.wg)(),(0,t.j4)(me,{dense:"",key:l.id},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(l.room_name),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(l.amount))+" (per "+(0,u.zw)(l.unit)+") ",1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(l.quantity),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(l.amount*l.quantity)),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1536),[[o.F8,a.show]])])),_:2},1024)])),_:2},1024)))),128)),0==e.roomSalesFilter.length?((0,t.wg)(),(0,t.j4)(me,{key:1,dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[A])),_:1})])),_:1})):(0,t.kq)("",!0),(0,t.Wm)(me,{dense:"",class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Other Services")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.otherServicesSalesFilter,(a=>((0,t.wg)(),(0,t.j4)(me,{dense:"",key:a.id},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(me,{dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(ce,{modelValue:e.selectedOrders,"onUpdate:modelValue":l[13]||(l[13]=l=>e.selectedOrders=l),val:"otherServices-"+a.id},null,8,["modelValue","val"])])])),_:2},1024),(0,t.Wm)(de,{side:""},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(ee,{flat:"",round:"",size:"sm",icon:a.show?"expand_less":"expand_more",color:"primary",onClick:e=>a.show=!a.show},null,8,["icon","onClick"])])])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(we,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.customer.name),1)])),_:2},1024),(0,t.Wm)(we,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.customer.contact),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(a.bill)),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(a.paid)),1)])),_:2},1024)])),_:2},1024),(0,t.wy)((0,t.Wm)(me,{dense:"",class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(me,{dense:"",class:"text-grey-9"},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Name")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Rate")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Qty")])),_:1}),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Total")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.sales,(l=>((0,t.wg)(),(0,t.j4)(me,{dense:"",key:l.id},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(l.service_name),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(l.amount)),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(l.quantity),1)])),_:2},1024),(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.formatPrice(l.amount*l.quantity)),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1536),[[o.F8,a.show]])])),_:2},1024)])),_:2},1024)))),128)),0==e.otherServicesSalesFilter.length?((0,t.wg)(),(0,t.j4)(me,{key:2,dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[N])),_:1})])),_:1})):(0,t.kq)("",!0)])),_:1}),T])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(fe,{modelValue:e.setCustomerDialog,"onUpdate:modelValue":l[19]||(l[19]=l=>e.setCustomerDialog=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(pe,{style:{width:"650px",maxWidth:"650px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(se,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(re,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Customers")])),_:1}),(0,t.wy)((0,t.Wm)(ee,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ye]])])),_:1}),(0,t._)("div",E,[(0,t._)("div",j,[(0,t._)("div",null,[(0,t.Wm)(ve,{clearable:"","map-options":"","emit-value":"","use-input":"","fill-input":"","hide-selected":"","input-debounce":"0",label:"Customers","option-label":"name",options:e.customersFilterOptions,style:{minWidth:"250px"},modelValue:e.selectedCustomer,"onUpdate:modelValue":l[15]||(l[15]=l=>e.selectedCustomer=l),"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.customersFilterOptions),loading:e.loadingCustomersOptions,ref:"customerSelected",onFilter:e.filterCustomersOptions},{option:(0,t.w5)((e=>[(0,t.Wm)(me,(0,u.vs)((0,t.F4)(e.itemProps)),{default:(0,t.w5)((()=>[(0,t.Wm)(de,null,{default:(0,t.w5)((()=>[(0,t.Wm)(we,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.opt.name),1)])),_:2},1024),(0,t.Wm)(we,{caption:"",lines:1},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.opt.address),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["options","modelValue","rules","loading","onFilter"])]),(0,t._)("div",null,[(0,t.Wm)(ee,{round:"",color:e.showCustomerForm?"red":"primary",icon:"add",class:(0,u.C_)([e.showCustomerForm?"rotate-45":""]),onClick:l[16]||(l[16]=l=>e.showCustomerForm=!e.showCustomerForm)},null,8,["color","class"])])]),(0,t.Wm)(ge,null,{default:(0,t.w5)((()=>[(0,t.wy)((0,t._)("div",null,[(0,t._)("div",B,[M,(0,t.Wm)(ne,{modelValue:e.customerData.name,"onUpdate:modelValue":l[17]||(l[17]=l=>e.customerData.name=l),modelModifiers:{trim:!0},label:"Name","lazy-rules":!0,rules:e.textInputRequiredRules(),ref:"customerName"},null,8,["modelValue","rules"]),(0,t.Wm)(ne,{type:"textarea",rows:3,modelValue:e.customerData.details,"onUpdate:modelValue":l[18]||(l[18]=l=>e.customerData.details=l),modelModifiers:{trim:!0},placeholder:"For example, Street address, City, State, Country. Contact.",label:"Address","lazy-rules":!0,rules:e.textInputRequiredRules(),ref:"customerDetails"},null,8,["modelValue","rules"])])],512),[[o.F8,e.showCustomerForm]])])),_:1}),(0,t._)("div",null,[(0,t.Wm)(ee,{rounded:"","no-caps":"",type:"submit",class:"full-width",label:"Update",color:"primary",onClick:e.setCustomer},null,8,["onClick"])])])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(fe,{modelValue:e.extraChargesDialog,"onUpdate:modelValue":l[22]||(l[22]=l=>e.extraChargesDialog=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(pe,{style:{width:"300px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(oe,{ref:"extraChargeForm",onSubmit:e.addExtraCharge},{default:(0,t.w5)((()=>[(0,t.Wm)(se,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(re,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Extra Charges")])),_:1}),(0,t.wy)((0,t.Wm)(ee,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ye]])])),_:1}),(0,t._)("div",K,[(0,t.Wm)(ne,{label:"Name",hint:"For example VAT",modelValue:e.extraChargeFormData.name,"onUpdate:modelValue":l[20]||(l[20]=l=>e.extraChargeFormData.name=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(ne,{label:"Percentage",hint:"For example 18",modelValue:e.extraChargeFormData.rate,"onUpdate:modelValue":l[21]||(l[21]=l=>e.extraChargeFormData.rate=l),type:"number","lazy-rules":"ondemand",rules:e.numberInputRequiredRules(),suffix:"%",style:{width:"110px"}},null,8,["modelValue","rules"]),(0,t._)("div",null,[(0,t.Wm)(ee,{rounded:"",label:"Add",type:"submit",color:"primary",class:"full-width"})])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(fe,{modelValue:e.newItemFormDialog,"onUpdate:modelValue":l[27]||(l[27]=l=>e.newItemFormDialog=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(pe,{style:{width:"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(oe,{ref:"newItemForm",onSubmit:e.addExtraItem},{default:(0,t.w5)((()=>[(0,t.Wm)(se,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(re,null,{default:(0,t.w5)((()=>[(0,t.Uk)("New Item")])),_:1}),(0,t.wy)((0,t.Wm)(ee,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ye]])])),_:1}),(0,t._)("div",$,[(0,t.Wm)(ne,{label:"Name",modelValue:e.newItemFormData.name,"onUpdate:modelValue":l[23]||(l[23]=l=>e.newItemFormData.name=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(ne,{label:"Specifications",type:"textarea",rows:"3",modelValue:e.newItemFormData.specifications,"onUpdate:modelValue":l[24]||(l[24]=l=>e.newItemFormData.specifications=l),"lazy-rules":"ondemand"},null,8,["modelValue"]),(0,t.Wm)(ne,{label:"Quantity",type:"number",modelValue:e.newItemFormData.quantity,"onUpdate:modelValue":l[25]||(l[25]=l=>e.newItemFormData.quantity=l),"lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(ne,{label:"Unit Price",type:"number",modelValue:e.newItemFormData.unit_price,"onUpdate:modelValue":l[26]||(l[26]=l=>e.newItemFormData.unit_price=l),"lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,t._)("div",null,[(0,t.Wm)(ee,{rounded:"",label:"Add",type:"submit",color:"primary",class:"full-width"})])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}a(9665);var J=a(9302),X=a(4170),ee=a(499),le=a(4019),ae=a(8221);const te=(0,t.aZ)({name:"CreateInvoice",setup(){const e=(0,J.Z)(),l=(0,ee.iH)(!1),a=(0,ee.iH)(null),u=(0,ee.iH)({}),o=(0,ee.iH)([]),i=(0,ee.iH)(null),r=(0,ee.iH)(!1),s=(0,ee.iH)(!1),n=(0,ee.iH)({name:"",details:""}),d=(0,ee.iH)(null),m=(0,ee.iH)(!1),c=(0,ee.iH)(!1),w=(0,ee.iH)([]),_=(0,ee.iH)([]),p=(0,ee.iH)(null),f=(0,ee.iH)(null),v=(0,ee.iH)(null),g=(0,ee.iH)([]),y=(0,ee.iH)([]),W=(0,ee.iH)([]),h=(0,ee.iH)(""),x=(0,t.Fl)((()=>""==h.value||null==h.value?g.value:g.value.filter((e=>e.customer.name.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1||e.customer.contact.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1||e.sales.filter((e=>e.item_name.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1)).length>0)))),q=(0,t.Fl)((()=>""==h.value||null==h.value?y.value:y.value.filter((e=>e.customer.name.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1||e.customer.contact.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1||e.details.filter((e=>e.room_name.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1)).length>0)))),C=(0,t.Fl)((()=>""==h.value||null==h.value?W.value:W.value.filter((e=>e.customer.name.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1||e.customer.contact.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1||e.sales.filter((e=>e.service_name.toLocaleLowerCase().indexOf(h.value.toLocaleLowerCase())>-1)).length>0)))),k=(0,ee.iH)([]),D=(0,ee.iH)([]),b=(0,ee.iH)([]),U=(0,ee.iH)(null),L=(0,ee.iH)({}),z=(0,ee.iH)(!1),V=(0,t.Fl)((()=>{let e=(0,ae.itemsProductSum)(o.value,"unit_price","quantity")+(0,ae.itemsProductSum)(H.value,"unit_price","quantity");return e+b.value.reduce(((l,a)=>l+Math.ceil(a.rate/100*e)),0)})),F=(0,ee.iH)(0),I=(0,ee.iH)(!1),P=(0,ee.iH)(null),S=(0,ee.iH)({specifications:""}),H=(0,ee.iH)([]);function O(){u.value={},o.value=[],H.value=[],k.value=[],b.value=[],D.value=[],i.value=null}function R(){return c.value=!0,(0,le.getInvoiceCustomers)().then((e=>{w.value=e.data,_.value=e.data})).finally((()=>{c.value=!1}))}function Z(){(0,le.getRestaurantAndBarSales)("?status=unpaid").then((e=>{g.value=e.data.map((e=>({...e,show:!1})))}))}function Q(){(0,le.getRoomsSales)("?status=unpaid").then((e=>{y.value=e.data.map((e=>({...e,show:!1})))}))}function Y(){(0,le.getOtherServicesSales)("?status=unpaid").then((e=>{W.value=e.data.map((e=>({...e,show:!1})))}))}return(0,t.bv)((()=>{R().then((()=>{Z(),Q(),Y()}))})),(0,t.m0)((()=>{o.value=[],F.value=0,k.value=[],D.value.forEach((e=>{let l=e.split("-");if("restaurantAndBar"===l[0]){let e=g.value.find((e=>e.id==parseInt(l[1])));F.value=F.value+e.paid,e.sales.forEach((l=>{let a=o.value.find((e=>e.name.toLocaleLowerCase()==l.item_name.toLocaleLowerCase()&&e.unit_price==l.unit_price&&e.specifications==l.unit));a?a.quantity=a.quantity+l.quantity:o.value.push({name:l.item_name,specifications:l.unit,quantity:l.quantity,unit_price:l.unit_price}),k.value.push("RestaurantAndBar_"+e.id)}))}else if("room"===l[0]){let e=y.value.find((e=>e.id==parseInt(l[1])));F.value=F.value+e.paid,e.details.forEach((l=>{let a=o.value.find((e=>e.name.toLocaleLowerCase()==l.room_name.toLocaleLowerCase()&&e.unit_price==l.amount&&e.specifications==`From ${l.arrival} to ${l.departure}`)),t=X.ZP.getDateDiff(X.ZP.extractDate(l.departure,"DD/MM/YYYY"),X.ZP.extractDate(l.arrival,"DD/MM/YYYY"))+1;a?(a.rooms=a.rooms+l.quantity,a.quantity=a.rooms*t):o.value.push({name:l.room_name,specifications:`From ${l.arrival} to ${l.departure}`,rooms:l.quantity,quantity:l.quantity*t,unit_price:l.amount}),k.value.push("Room_"+e.id)}))}else if("otherServices"===l[0]){let e=W.value.find((e=>e.id==parseInt(l[1])));F.value=F.value+e.paid,e.sales.forEach((l=>{let a=o.value.find((e=>e.name.toLocaleLowerCase()==l.service_name.toLocaleLowerCase()&&e.unit_price==l.amount));a?a.quantity=a.quantity+l.quantity:o.value.push({name:l.service_name,specifications:"",quantity:l.quantity,unit_price:l.amount}),k.value.push("OtherService_"+e.id)}))}})),null!==a.value&&a.value.resetValidation()})),{salesOrdersDialog:l,invoiceCustomerData:u,invoiceDueDate:i,itemsList:o,showCustomerForm:s,customerData:n,selectedCustomer:d,setCustomerDialog:m,loadingCustomersOptions:c,customersFilterOptions:_,customerName:p,customerDetails:f,customerSelected:v,invoiceForm:a,submittingData:r,restuarantAndBarSalesFilter:x,roomSalesFilter:q,otherServicesSalesFilter:C,selectedOrders:D,extraChargesList:b,extraChargeForm:U,extraChargeFormData:L,extraChargesDialog:z,invoiceTotal:V,totalPaidAmount:F,newItemFormDialog:I,newItemForm:P,newItemFormData:S,extraItemsList:H,searchFilter:h,filterCustomersOptions(e,l){l((()=>{_.value=w.value.filter((l=>l.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1||l.address.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1))}))},addExtraItem(){P.value.validate()&&(H.value.push({...S.value}),I.value=!1,S.value={specifications:""})},removeExtraItem(l){e.dialog({title:"Confirmation",message:"Confirm delete ?",cancel:!0}).onOk((()=>{H.value.splice(l,1)}))},addExtraCharge(){U.value.validate()&&(b.value.push({...L.value}),L.value={},z.value=!z.value)},setCustomer(){s.value?p.value.validate()&&f.value.validate()&&(u.value={...n.value},n.value={name:"",details:""},p.value.resetValidation(),f.value.resetValidation(),m.value=!1):v.value.validate()&&(u.value={...d.value},v.value.resetValidation(),m.value=!1),a.value.resetValidation()},submitNewInvoice(){a.value.validate()&&e.dialog({title:"Confirm",message:"Please confirm new requisition",cancel:!0}).onOk((()=>{r.value=!0,(0,le.createInvoice)({customer:u.value,items:[...o.value,...H.value],extra_charges:b.value,due_date:i.value,sales_orders:k.value}).then((e=>{O(),(0,ae.displayNotification)(e.data,"positive")})).catch((e=>{(0,ae.displayNotification)(e,"negative",{error:!0})})).finally((()=>{r.value=!1}))}))}}}});var ue=a(1639),oe=a(9885),ie=a(8879),re=a(8326),se=a(8149),ne=a(2765),de=a(4351),me=a(6933),ce=a(2074),we=a(4458),_e=a(1663),pe=a(1973),fe=a(6611),ve=a(3246),ge=a(490),ye=a(1233),We=a(1221),he=a(3115),xe=a(4581),qe=a(9003),Ce=a(2146),ke=a(9984),De=a.n(ke);const be=(0,ue.Z)(te,[["render",G]]),Ue=be;De()(te,"components",{QPage:oe.Z,QBtn:ie.Z,QForm:re.Z,QField:se.Z,QPopupProxy:ne.Z,QDate:de.Z,QMarkupTable:me.Z,QDialog:ce.Z,QCard:we.Z,QToolbar:_e.Z,QToolbarTitle:pe.Z,QInput:fe.Z,QList:ve.Z,QItem:ge.Z,QItemSection:ye.Z,QCheckbox:We.Z,QItemLabel:he.Z,QSelect:xe.Z,QSlideTransition:qe.Z}),De()(te,"directives",{ClosePopup:Ce.Z})}}]);