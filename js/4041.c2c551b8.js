"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[4041],{4041:(a,e,t)=>{t.r(e),t.d(e,{default:()=>ke});var l=t(9835),s=t(6970);const i={class:"row justify-around text-weight-bold q-mt-md items-center"},o={class:"row no-wrap"},d={key:1,class:"q-ml-sm"},n={class:"row no-wrap"},u={class:"col-md-5 column"},r={class:"row items-center q-col-gutter-x-xl"},m=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Customer Details",-1),c={key:0},p={class:"column q-col-gutter-y-md"},_={class:"row"},w=(0,l._)("div",{class:"col-2"},"Name:",-1),g={class:"col"},v={class:"row"},y=(0,l._)("div",{class:"col-2"},"Contact:",-1),b={class:"col"},D={class:"row"},h=(0,l._)("div",{class:"col-2"},"Address:",-1),f={class:"col"},q={class:"col-md-6"},x=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Items",-1),W=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Item"),(0,l._)("th",null,"Rate"),(0,l._)("th",null,"Quantity"),(0,l._)("th",null,"Discount"),(0,l._)("th",null,"Amount")])],-1),k={key:0},z={key:1},V={class:"text-no-wrap"},S={class:"row q-mt-md"},P={class:"col-7"},R=(0,l._)("div",{class:"text-weight-bold q-mb-md"},"Payments",-1),C=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Amount"),(0,l._)("th",null,"Mode of payment"),(0,l._)("th",null,"Details"),(0,l._)("th",null,"Date")])],-1),Z={key:0},U=(0,l._)("span",null," - ",-1),Q={key:0},I=(0,l._)("td",{colspan:"100%",class:"text-grey-10"}," No payments available ... ",-1),O=[I],F={key:0,class:"col-3 q-px-xl"},H=(0,l._)("div",{class:"text-weight-bold"},"Invoice",-1),A={class:"q-mt-md"},N={class:"print-only"},B={id:"orderReceiptPrintOut"},Y={class:"q-px-lg q-pt-xl q-mb-lg"},E={class:"row q-mb-sm"},j=(0,l._)("div",{class:"col-3"},"Name:",-1),M={class:"col"},T={class:"row"},L=(0,l._)("div",{class:"col-3"},"Transaction:",-1),K={class:"col"},$=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Amount")])],-1),G={class:"text-weight-bold"},J=(0,l._)("td",{colspan:"2",class:"text-right"},"Total",-1),X={class:"text-center"},aa={class:"text-weight-bold"},ea=(0,l._)("td",{colspan:"2",class:"text-right"},"Paid",-1),ta={class:"text-center"},la={class:"text-weight-bold"},sa=(0,l._)("td",{colspan:"2",class:"text-right"},"Balance",-1),ia={class:"text-center"},oa=(0,l._)("div",{class:"q-py-md"},null,-1),da={class:"column q-col-gutter-y-sm q-mt-sm q-mx-lg q-mb-xl"},na={class:"q-mb-md"},ua={class:"row justify-end"},ra={class:"q-px-lg q-pt-lg"},ma={style:{minWidth:"100%",width:"100%"}},ca={class:"q-px-lg q-pt-xl q-mb-lg"},pa={class:"row q-mb-sm"},_a=(0,l._)("div",{class:"col-3"},"Name:",-1),wa={class:"col"},ga={class:"row"},va=(0,l._)("div",{class:"col-3"},"Transaction:",-1),ya={class:"col"},ba=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Amount")])],-1),Da={class:"text-weight-bold"},ha=(0,l._)("td",{colspan:"2",class:"text-right"},"Total",-1),fa={class:"text-center"},qa={class:"text-weight-bold"},xa=(0,l._)("td",{colspan:"2",class:"text-right"},"Paid",-1),Wa={class:"text-center"},ka={class:"text-weight-bold"},za=(0,l._)("td",{colspan:"2",class:"text-right"},"Balance",-1),Va={class:"text-center"},Sa={class:"q-px-md column q-gutter-y-md"},Pa=(0,l._)("div",{class:"q-py-md"},null,-1),Ra={class:"column"},Ca={key:0,class:"q-px-lg"},Za={class:"q-pt-md"},Ua={class:"row items-center q-col-gutter-x-md"},Qa=(0,l._)("div",{class:"col-3 text-subtitle1"},"Name:",-1),Ia={class:"col"},Oa={class:"row items-center q-col-gutter-x-md"},Fa=(0,l._)("div",{class:"col-3 text-subtitle1"},"Contact:",-1),Ha={class:"col"},Aa={class:"row items-center q-col-gutter-x-md"},Na=(0,l._)("div",{class:"col-3 text-subtitle1"},"Address:",-1),Ba={class:"col"},Ya={class:"q-pt-md"};function Ea(a,e,t,I,Ea,ja){const Ma=(0,l.up)("q-breadcrumbs-el"),Ta=(0,l.up)("q-breadcrumbs"),La=(0,l.up)("q-btn"),Ka=(0,l.up)("q-separator"),$a=(0,l.up)("q-markup-table"),Ga=(0,l.up)("q-card-section"),Ja=(0,l.up)("q-card"),Xa=(0,l.up)("q-page"),ae=(0,l.up)("q-spinner-ios"),ee=(0,l.up)("q-inner-loading"),te=(0,l.up)("q-toolbar-title"),le=(0,l.up)("q-toolbar"),se=(0,l.up)("balance-calculator-component"),ie=(0,l.up)("q-expansion-item"),oe=(0,l.up)("q-date"),de=(0,l.up)("q-popup-proxy"),ne=(0,l.up)("q-field"),ue=(0,l.up)("money-input-component"),re=(0,l.up)("q-select"),me=(0,l.up)("q-input"),ce=(0,l.up)("q-form"),pe=(0,l.up)("q-dialog"),_e=(0,l.up)("q-radio"),we=(0,l.up)("q-slide-transition"),ge=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(Xa,{class:"q-mx-xl q-mb-lg q-mt-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(Ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Ma,{to:{name:"RestaurantAndBarSales"}},{default:(0,l.w5)((()=>[(0,l.Uk)("Sales")])),_:1}),(0,l.Wm)(Ma,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(a.Id),1)])),_:1})])),_:1}),(0,l._)("div",i,[(0,l._)("div",null,"Date: "+(0,s.zw)(a.pageData.date),1),(0,l._)("div",null,"Bill: "+(0,s.zw)(a.formatPrice(a.pageData.bill)),1),(0,l._)("div",null,"Paid: "+(0,s.zw)(a.formatPrice(a.pageData.paid)),1),(0,l._)("div",null,"Balance: "+(0,s.zw)(a.formatPrice(a.pageData.bill-a.pageData.paid)),1),(0,l._)("div",o,[a.pageData.bill===a.pageData.paid||"OPEN"!==a.pageData.status||a.pageData.invoice_id?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(La,{key:0,dense:"","no-caps":"",rounded:"",color:"primary",label:"Add Payment",class:"full-width q-px-md",onClick:e[0]||(e[0]=e=>a.addPaymentDialog=!a.addPaymentDialog)})),"CLOSED"!==a.pageData.status?((0,l.wg)(),(0,l.iD)("div",d,[a.permissionRequired("bar","change_brandsale")||a.permissionRequired("restaurant","change_itemsale")?((0,l.wg)(),(0,l.j4)(La,{key:0,dense:"","no-caps":"",rounded:"","no-wrap":"",color:"primary",label:"Update Status",class:"full-width q-px-md",onClick:e[1]||(e[1]=e=>a.updateStatusDialog=!a.updateStatusDialog)})):(0,l.kq)("",!0)])):(0,l.kq)("",!0)])]),(0,l.Wm)(Ka,{class:"q-my-sm bg-grey"}),a.permissionRequired("bar","change_brandsale")||a.permissionRequired("restaurant","change_itemsale")?((0,l.wg)(),(0,l.j4)(La,{key:0,unelevated:"",dense:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:e[2]||(e[2]=e=>a.orderReceipt=!a.orderReceipt),disable:!a.$q.platform.is.electron},null,8,["disable"])):(0,l.kq)("",!0),(0,l._)("div",n,[(0,l._)("div",u,[(0,l._)("div",r,[m,"OPEN"===a.pageData.status?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(La,{round:"",size:"sm",color:"primary",icon:"edit",onClick:e[3]||(e[3]=e=>a.customerFormDialog=!a.customerFormDialog)})])):(0,l.kq)("",!0)]),(0,l._)("div",p,[(0,l._)("div",_,[w,(0,l._)("div",g,(0,s.zw)(a.customerData.name),1)]),(0,l._)("div",v,[y,(0,l._)("div",b,(0,s.zw)(a.customerData.contact),1)]),(0,l._)("div",D,[h,(0,l._)("div",f,(0,s.zw)(a.customerData.address),1)])])]),(0,l.Wm)(Ka,{class:"q-mx-md",inset:"",vertical:""}),(0,l._)("div",q,[x,(0,l.Wm)($a,{flat:"",bordered:"","wrap-cells":"",separator:"vertical"},{default:(0,l.w5)((()=>[W,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.itemsData,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,(0,s.zw)(e.item_name),1),(0,l._)("td",null,(0,s.zw)(a.formatPrice(e.final_unit_price))+" @ "+(0,s.zw)(e.unit),1),(0,l._)("td",null,(0,s.zw)(e.quantity),1),(0,l._)("td",null,[e.discount>0?((0,l.wg)(),(0,l.iD)("span",k,(0,s.zw)(e.discount)+"%",1)):((0,l.wg)(),(0,l.iD)("span",z,"-"))]),(0,l._)("td",V,(0,s.zw)(a.formatPrice(e.quantity*e.final_unit_price)),1)])))),128))])])),_:1})])]),(0,l._)("div",S,[(0,l._)("div",P,[R,(0,l.Wm)($a,{flat:"",bordered:"",separator:"vertical"},{default:(0,l.w5)((()=>[C,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.paymentsData,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,(0,s.zw)(a.formatPrice(e.amount)),1),(0,l._)("td",null,(0,s.zw)(e.method),1),(0,l._)("td",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(e?.other_details),(a=>((0,l.wg)(),(0,l.iD)("div",{key:a},[a.startsWith("_")?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("span",Z,[(0,l.Uk)((0,s.zw)(a),1),U,(0,l.Uk)((0,s.zw)(e?.other_details[a]),1)]))])))),128))]),(0,l._)("td",null,(0,s.zw)(e.date),1)])))),128)),a.paymentsData.length<1?((0,l.wg)(),(0,l.iD)("tr",Q,O)):(0,l.kq)("",!0)])])),_:1})]),a.pageData.invoice_id?((0,l.wg)(),(0,l.iD)("div",F,[H,(0,l.Wm)(Ka,{class:"q-mt-sm"}),(0,l._)("div",A,[(0,l.Wm)(La,{outline:"",label:"invoice # "+a.pageData.invoice_id,"icon-right":"keyboard_arrow_right",color:"primary",to:{name:"InvoiceDetails",params:{id:a.pageData.invoice_id}}},null,8,["label","to"])])])):(0,l.kq)("",!0)]),(0,l._)("div",N,[(0,l._)("div",B,[(0,l.Wm)(Ja,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l.Wm)(Ga,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l._)("div",Y,[(0,l._)("div",E,[j,(0,l._)("div",M,(0,s.zw)(a.pageData.customer.name),1)]),(0,l._)("div",T,[L,(0,l._)("div",K,(0,s.zw)(a.pageData.id),1)])]),(0,l.Wm)($a,{"wrap-cells":"",bordered:"",flat:"",cell:"horizontal",class:"overflow-hidden"},{default:(0,l.w5)((()=>[$,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pageData.sales,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id,class:"text-center"},[(0,l._)("td",null,(0,s.zw)(e.quantity),1),(0,l._)("td",null,(0,s.zw)(e.item_name),1),(0,l._)("td",null,(0,s.zw)(a.formatPrice(e.unit_price*e.quantity)),1)])))),128)),(0,l._)("tr",G,[J,(0,l._)("td",X,(0,s.zw)(a.formatPrice(a.pageData.bill)),1)]),(0,l._)("tr",aa,[ea,(0,l._)("td",ta,(0,s.zw)(a.formatPrice(a.pageData.paid)),1)]),(0,l._)("tr",la,[sa,(0,l._)("td",ia,(0,s.zw)(a.formatPrice(a.pageData.bill-a.pageData.paid)),1)])])])),_:1}),oa])])),_:1})])),_:1})])])])),_:1}),(0,l.Wm)(ee,{showing:a.loadingData},{default:(0,l.w5)((()=>[(0,l.Wm)(ae,{size:"50px",color:"primary"})])),_:1},8,["showing"]),(0,l.Wm)(pe,{modelValue:a.addPaymentDialog,"onUpdate:modelValue":e[8]||(e[8]=e=>a.addPaymentDialog=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(Ja,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(ce,{ref:"paymentForm",onSubmit:a.savePayment},{default:(0,l.w5)((()=>[(0,l.Wm)(le,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Payment")])),_:1}),(0,l.wy)((0,l.Wm)(La,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ge]])])),_:1}),(0,l.Wm)(Ka),(0,l._)("div",da,[(0,l._)("div",na,[(0,l.Wm)(ie,{dense:"","dense-toggle":"",label:"Balance Calculator","header-class":"text-primary",class:"rounded-borders",style:(0,s.j5)({border:"1px solid var(--q-primary)"})},{default:(0,l.w5)((()=>[(0,l.Wm)(se,{defaultAmount:a.pageData.bill-a.pageData.paid},null,8,["defaultAmount"])])),_:1},8,["style"])]),(0,l.Wm)(ne,{outlined:"",label:"Date",modelValue:a.paymentData.date,"onUpdate:modelValue":e[5]||(e[5]=e=>a.paymentData.date=e),"lazy-rules":"ondemand",rules:a.textInputRequiredRules()},{control:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(a.paymentData.date),1)])),append:(0,l.w5)((()=>[(0,l.Wm)(La,{size:"sm",round:"",color:"primary",icon:"event"},{default:(0,l.w5)((()=>[(0,l.Wm)(de,null,{default:(0,l.w5)((()=>[(0,l.Wm)(oe,{modelValue:a.paymentData.date,"onUpdate:modelValue":e[4]||(e[4]=e=>a.paymentData.date=e),mask:"DD/MM/YYYY"},{default:(0,l.w5)((()=>[(0,l._)("div",ua,[(0,l.wy)((0,l.Wm)(La,{"no-caps":"",label:"Close"},null,512),[[ge]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,l.Wm)(ue,{modelValue:a.paymentData.amount,"onUpdate:modelValue":e[6]||(e[6]=e=>a.paymentData.amount=e),"input-class":"text-h6",label:"Amount"},null,8,["modelValue"]),(0,l.Wm)(re,{outlined:"",modelValue:a.paymentData.method,"onUpdate:modelValue":e[7]||(e[7]=e=>a.paymentData.method=e),label:"Mode of payment",options:a.paymentMethodOptions,"option-label":"name","lazy-rules":"ondemand",rules:a.selectInputRequiredRules(a.paymentMethodOptions)},null,8,["modelValue","options","rules"]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(a.fields),((e,t)=>((0,l.wg)(),(0,l.j4)(me,{outlined:"",key:t,"model-value":a.fields[e],"onUpdate:modelValue":t=>a.fields[e]=t,label:e},null,8,["model-value","onUpdate:modelValue","label"])))),128)),(0,l._)("div",ra,[(0,l.Wm)(La,{rounded:"","no-caps":"",color:"primary",label:"Add Payment",class:"full-width",type:"submit",loading:a.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(pe,{modelValue:a.orderReceipt,"onUpdate:modelValue":e[10]||(e[10]=e=>a.orderReceipt=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(Ja,{style:{minWidth:"500px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(le,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Receipt # "+(0,s.zw)(a.pageData.id),1)])),_:1}),(0,l.wy)((0,l.Wm)(La,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ge]])])),_:1}),(0,l.Wm)(Ga,null,{default:(0,l.w5)((()=>[(0,l._)("div",ma,[(0,l._)("div",ca,[(0,l._)("div",pa,[_a,(0,l._)("div",wa,(0,s.zw)(a.pageData.customer.name),1)]),(0,l._)("div",ga,[va,(0,l._)("div",ya,(0,s.zw)(a.pageData.id),1)])]),(0,l.Wm)($a,{"wrap-cells":"",bordered:"",flat:"",cell:"horizontal",class:"overflow-hidden"},{default:(0,l.w5)((()=>[ba,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pageData.sales,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id,class:"text-center"},[(0,l._)("td",null,(0,s.zw)(e.quantity),1),(0,l._)("td",null,(0,s.zw)(e.item_name),1),(0,l._)("td",null,(0,s.zw)(a.formatPrice(e.unit_price*e.quantity)),1)])))),128)),(0,l._)("tr",Da,[ha,(0,l._)("td",fa,(0,s.zw)(a.formatPrice(a.itemsProductSum(a.pageData.sales,a.attribute1="unit_price",a.attribute2="quantity"))),1)]),(0,l._)("tr",qa,[xa,(0,l._)("td",Wa,(0,s.zw)(a.formatPrice(a.itemsSum(a.pageData.payments))),1)]),(0,l._)("tr",ka,[za,(0,l._)("td",Va,(0,s.zw)(a.formatPrice(a.itemsProductSum(a.pageData.sales,a.attribute1="unit_price",a.attribute2="quantity")-a.itemsSum(a.pageData.payments))),1)])])])),_:1}),(0,l._)("div",Sa,[a.$q.platform.is.electron?((0,l.wg)(),(0,l.j4)(La,{key:0,rounded:"",label:"print",icon:"print",color:"primary",class:"full-width",onClick:e[9]||(e[9]=e=>a.printDocument("orderReceiptPrintOut",a.printingSettings))})):(0,l.kq)("",!0)]),Pa])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(pe,{modelValue:a.updateStatusDialog,"onUpdate:modelValue":e[16]||(e[16]=e=>a.updateStatusDialog=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(Ja,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(le,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Status")])),_:1}),(0,l.wy)((0,l.Wm)(La,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ge]])])),_:1}),(0,l.Wm)(Ka),(0,l.Wm)(Ga,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ce,{ref:"updateStatusForm",onSubmit:a.submitStatusData},{default:(0,l.w5)((()=>[(0,l.Wm)(ne,{outlined:"",modelValue:a.newStatus,"onUpdate:modelValue":e[15]||(e[15]=e=>a.newStatus=e),"lazy-rules":"ondemand",rules:a.textInputRequiredRules("Please select an option")},{control:(0,l.w5)((()=>[(0,l._)("div",Ra,["CANCELLED"==a.pageData.status?((0,l.wg)(),(0,l.j4)(_e,{key:0,modelValue:a.newStatus,"onUpdate:modelValue":e[11]||(e[11]=e=>a.newStatus=e),val:a.statusOptions.open.value,label:a.statusOptions.open.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==a.pageData.status?((0,l.wg)(),(0,l.j4)(_e,{key:1,modelValue:a.newStatus,"onUpdate:modelValue":e[12]||(e[12]=e=>a.newStatus=e),val:a.statusOptions.close.value,label:a.statusOptions.close.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==a.pageData.status?((0,l.wg)(),(0,l.j4)(_e,{key:2,modelValue:a.newStatus,"onUpdate:modelValue":e[13]||(e[13]=e=>a.newStatus=e),val:a.statusOptions.cancel.value,label:a.statusOptions.cancel.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),(0,l.Wm)(we,null,{default:(0,l.w5)((()=>["cancel"==a.newStatus?((0,l.wg)(),(0,l.iD)("div",Ca,[(0,l.Wm)(me,{outlined:"",label:"Reason",type:"textarea",rows:"5","lazy-rules":"ondemand",rules:[...a.textInputRequiredRules(),...a.minimumRequiredRules(10)],modelValue:a.statusOptions.cancel.data.reason,"onUpdate:modelValue":e[14]||(e[14]=e=>a.statusOptions.cancel.data.reason=e)},null,8,["rules","modelValue"])])):(0,l.kq)("",!0)])),_:1})])])),_:1},8,["modelValue","rules"]),(0,l._)("div",Za,[(0,l.Wm)(La,{rounded:"",type:"submit",color:"primary",label:"submit",class:"full-width",loading:a.submitting},null,8,["loading"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(pe,{modelValue:a.customerFormDialog,"onUpdate:modelValue":e[20]||(e[20]=e=>a.customerFormDialog=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(Ja,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(ce,{ref:"customerForm",onSubmit:a.submitCustomerData},{default:(0,l.w5)((()=>[(0,l.Wm)(le,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Customer Details")])),_:1}),(0,l.wy)((0,l.Wm)(La,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ge]])])),_:1}),(0,l.Wm)(Ka),(0,l.Wm)(Ga,{class:"column q-col-gutter-y-md q-ma-md"},{default:(0,l.w5)((()=>[(0,l._)("div",Ua,[Qa,(0,l._)("div",Ia,[(0,l.Wm)(me,{dense:"",outlined:"",modelValue:a.customerFormData.name,"onUpdate:modelValue":e[17]||(e[17]=e=>a.customerFormData.name=e),"lazy-rules":"ondemand",rules:a.textInputRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",Oa,[Fa,(0,l._)("div",Ha,[(0,l.Wm)(me,{dense:"",outlined:"",mask:"### ### ######","unmasked-value":"",modelValue:a.customerFormData.contact,"onUpdate:modelValue":e[18]||(e[18]=e=>a.customerFormData.contact=e),"lazy-rules":"ondemand",rules:a.textInputRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",Aa,[Na,(0,l._)("div",Ba,[(0,l.Wm)(me,{dense:"",outlined:"",type:"textarea",rows:"1",modelValue:a.customerFormData.address,"onUpdate:modelValue":e[19]||(e[19]=e=>a.customerFormData.address=e)},null,8,["modelValue"])])]),(0,l._)("div",Ya,[(0,l.Wm)(La,{rounded:"",class:"full-width",label:"submit",color:"primary",type:"submit",loading:a.submitting},null,8,["loading"])])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var ja=t(9302),Ma=t(4170),Ta=t(499),La=t(2580),Ka=t(9258),$a=t(4019),Ga=t(8221);const Ja=(0,l.aZ)({name:"RestaurantAndBarSalesDetails",props:{Id:{required:!0}},components:{MoneyInputComponent:La.Z,BalanceCalculatorComponent:Ka.Z},setup(a){(0,ja.Z)();const e=(0,Ta.iH)({}),t={customer:{},payments:[],sales:[],bill:0,paid:0},s=(0,Ta.iH)({...t}),i=(0,l.Fl)((()=>s.value.customer?s.value.customer:{})),o=(0,l.Fl)((()=>s.value.payments?s.value.payments:[])),d=(0,l.Fl)((()=>s.value.sales?s.value.sales:[])),n=(0,Ta.iH)(!1),u=(0,Ta.iH)(!1),r=(0,Ta.iH)({}),m=(0,Ta.iH)([]),c=(0,Ta.iH)(null),p=(0,Ta.iH)({}),_=(0,Ta.iH)(null),w={open:{label:"Open",value:"open",data:{status:"OPEN"}},close:{label:"Close",value:"close",data:{status:"CLOSED"}},cancel:{label:"Cancel",value:"cancel",data:{status:"CANCELLED",reason:""}}},g=(0,Ta.iH)(),v=(0,Ta.iH)(!1),y=(0,Ta.iH)(!1),b=(0,Ta.iH)(!1),D=(0,Ta.iH)(!1),h=(0,Ta.iH)(null),f=(0,Ta.iH)({});function q(){return n.value=!0,s.value={...t},(0,$a.getRestaurantAndBarSales)(`/${a.Id}`).then((a=>{s.value=a.data})).then((()=>{f.value={...i.value}})).finally((()=>{n.value=!1}))}function x(){return(0,$a.getGeneralSettings)("?name=PRINTERS").then((a=>{e.value=a.data.details["items"].find((a=>"bar and restaurant receipts"==a.item))||a.data.details["items"].find((a=>"receipts"==a.item))}))}return(0,l.m0)((()=>{r.value&&r.value.method&&r.value.method.other_details&&r.value.method.other_details.fields?p.value=r.value.method.other_details.fields.reduce(((a,e)=>({...a,[e]:null})),{}):p.value={}})),(0,l.bv)((()=>{r.value.date=Ma.ZP.formatDate(new Date,"DD/MM/YYYY"),q().then((()=>{(0,$a.getPaymentMethods)().then((a=>{m.value=a.data,x()}))}))})),{pageData:s,loadingData:n,customerData:i,paymentsData:o,itemsData:d,addPaymentDialog:u,paymentData:r,paymentMethodOptions:m,fields:p,newStatus:_,statusOptions:w,updateStatusForm:g,submitting:v,updateStatusDialog:y,orderReceipt:b,printingSettings:e,paymentForm:c,customerForm:h,customerFormData:f,customerFormDialog:D,submitCustomerData(){h.value.validate()&&(v.value=!0,(0,$a.updateRestaurantAndBarSaleCustomer)(a.Id,f.value).then((a=>{(0,Ga.displayNotification)(a.data,"positive"),f.value={},h.value.resetValidation(),D.value=!1,q()})).catch((a=>{(0,Ga.displayNotification)(a,"negative",{error:!0})})).finally((()=>{v.value=!1})))},savePayment(){c.value.validate()&&(v.value=!0,(0,$a.addRestaurantAndBarSalePayment)(a.Id,{...r.value,method:o.value.method.id,other_details:p.value}).then((a=>{(0,Ga.displayNotification)(a.data,"positive"),r.value={},q(),u.value=!1,c.value.resetValidation()})).catch((a=>{(0,Ga.displayNotification)(a,"negative",{error:!0})})).finally((()=>{v.value=!1})))},submitStatusData(){g.value.validate()&&(v.value=!0,(0,$a.updateRestaurantAndBarSaleStatus)(a.Id,w[_.value].data).then((a=>{(0,Ga.displayNotification)(a.data,"positive"),_.value=null,y.value=!1,q()})).catch((a=>{(0,Ga.displayNotification)(a.response.data,"negative")})).finally((()=>{v.value=!1})))}}}});var Xa=t(1639),ae=t(9885),ee=t(2605),te=t(8052),le=t(8879),se=t(926),ie=t(6933),oe=t(4458),de=t(3190),ne=t(854),ue=t(8359),re=t(2074),me=t(8326),ce=t(1663),pe=t(1973),_e=t(651),we=t(8149),ge=t(2765),ve=t(4351),ye=t(4581),be=t(6611),De=t(1480),he=t(9003),fe=t(2146),qe=t(9984),xe=t.n(qe);const We=(0,Xa.Z)(Ja,[["render",Ea]]),ke=We;xe()(Ja,"components",{QPage:ae.Z,QBreadcrumbs:ee.Z,QBreadcrumbsEl:te.Z,QBtn:le.Z,QSeparator:se.Z,QMarkupTable:ie.Z,QCard:oe.Z,QCardSection:de.Z,QInnerLoading:ne.Z,QSpinnerIos:ue.Z,QDialog:re.Z,QForm:me.Z,QToolbar:ce.Z,QToolbarTitle:pe.Z,QExpansionItem:_e.Z,QField:we.Z,QPopupProxy:ge.Z,QDate:ve.Z,QSelect:ye.Z,QInput:be.Z,QRadio:De.Z,QSlideTransition:he.Z}),xe()(Ja,"directives",{ClosePopup:fe.Z})}}]);