"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[8513],{8513:(e,a,l)=>{l.r(a),l.d(a,{default:()=>T});var t=l(9835),i=l(6970);const o={class:"row justify-end q-gutter-x-md"},s={class:"column"},n={key:0},r={class:"row no-wrap q-gutter-x-md"},u={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg"},d={class:"column q-col-gutter-y-md q-mx-lg q-mb-lg"},m={class:"row justify-end"};function c(e,a,l,c,p,g){const v=(0,t.up)("q-btn"),w=(0,t.up)("q-separator"),b=(0,t.up)("q-td"),f=(0,t.up)("q-table"),y=(0,t.up)("q-page"),D=(0,t.up)("q-toolbar-title"),h=(0,t.up)("q-toolbar"),S=(0,t.up)("q-select"),q=(0,t.up)("q-input"),R=(0,t.up)("q-form"),_=(0,t.up)("q-card"),W=(0,t.up)("q-dialog"),k=(0,t.up)("q-item-section"),V=(0,t.up)("q-item"),C=(0,t.up)("q-list"),Z=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(y,{class:"q-ma-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",o,[e.permissionRequired("otherservices","add_service")?((0,t.wg)(),(0,t.j4)(v,{key:0,rounded:"","no-caps":"",color:"primary",label:"Create",onClick:a[0]||(a[0]=a=>e.createDialog=!e.createDialog)})):(0,t.kq)("",!0),e.permissionRequired("otherservices","add_salerates")?((0,t.wg)(),(0,t.j4)(v,{key:1,rounded:"","no-caps":"",color:"primary",label:"Create Sale Rates",onClick:a[1]||(a[1]=a=>e.addSaleRatesDialog=!e.addSaleRatesDialog)})):(0,t.kq)("",!0)]),(0,t.Wm)(f,{flat:"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"Services","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No services available","loading-label":"Loading services..."},{"body-cell-rates":(0,t.w5)((a=>[(0,t.Wm)(b,{props:a},{default:(0,t.w5)((()=>[(0,t._)("div",s,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.row.sale_rates,((l,o)=>((0,t.wg)(),(0,t.iD)("div",{key:l.id,class:"column"},[(0,t._)("div",null,(0,i.zw)(e.formatPrice(l.amount))+" ("+(0,i.zw)(l.specification)+") ",1),a.row.sale_rates.length>1&&o<a.row.sale_rates.length-1?((0,t.wg)(),(0,t.iD)("div",n,[(0,t.Wm)(w,{class:"q-my-sm"})])):(0,t.kq)("",!0)])))),128))])])),_:2},1032,["props"])])),"body-cell-actions":(0,t.w5)((a=>[(0,t.Wm)(b,{props:a},{default:(0,t.w5)((()=>[(0,t._)("div",r,[e.permissionRequired("otherservices","view_service")?((0,t.wg)(),(0,t.j4)(v,{key:0,round:"",unelevated:"",size:"sm",icon:"keyboard_arrow_right",color:"primary",to:{name:"OtherServicesDetails",params:{id:a.row.id}}},null,8,["to"])):(0,t.kq)("",!0),e.permissionRequired("otherservices","delete_service")?((0,t.wg)(),(0,t.j4)(v,{key:1,round:"",unelevated:"",size:"sm",icon:"delete",color:"red",loading:e.submittingData,onClick:l=>e.showDeleteDialog(a.row.id)},null,8,["loading","onClick"])):(0,t.kq)("",!0)])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])])),_:1}),(0,t.Wm)(W,{modelValue:e.createDialog,"onUpdate:modelValue":a[5]||(a[5]=a=>e.createDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{ref:"createDialogForm",onSubmit:e.submitServiceData},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Create New Service")])),_:1}),(0,t.wy)((0,t.Wm)(v,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Z]])])),_:1}),(0,t.Wm)(w),(0,t._)("div",u,[(0,t.Wm)(S,{"map-options":"","emit-value":"",modelValue:e.selectedCategory,"onUpdate:modelValue":a[2]||(a[2]=a=>e.selectedCategory=a),"option-label":"name","option-value":"id",options:e.categoryData,label:"Category","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.categoryData.map((e=>e.id)))},null,8,["modelValue","options","rules"]),(0,t.Wm)(q,{modelValue:e.serviceData.name,"onUpdate:modelValue":a[3]||(a[3]=a=>e.serviceData.name=a),label:"Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(q,{modelValue:e.serviceData.description,"onUpdate:modelValue":a[4]||(a[4]=a=>e.serviceData.description=a),label:"Description",type:"textarea",rows:5,"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t._)("div",null,[(0,t.Wm)(v,{rounded:"",loading:e.submittingData,color:"primary",label:"Create",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(W,{modelValue:e.addSaleRatesDialog,"onUpdate:modelValue":a[7]||(a[7]=a=>e.addSaleRatesDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{style:{width:"700px",maxWidth:"700px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{ref:"addSaleRatesDialogForm",onSubmit:e.submitSalesRatesData},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Create Sales Rates")])),_:1}),(0,t.wy)((0,t.Wm)(v,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Z]])])),_:1}),(0,t.Wm)(w),(0,t._)("div",d,[(0,t.Wm)(S,{"emit-value":"","map-options":"","use-input":"","hide-selected":"","fill-input":"",modelValue:e.selectedService,"onUpdate:modelValue":a[6]||(a[6]=a=>e.selectedService=a),loading:e.loadingData,options:e.tableRows,"option-label":"name","option-value":"id",label:"Service","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.tableRows.map((e=>e.id)))},null,8,["modelValue","loading","options","rules"]),(0,t._)("div",m,[(0,t.Wm)(v,{color:"primary",label:"Add",onClick:e.addSaleRate},null,8,["onClick"])]),(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Specification")])),_:1}),(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Rate")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.saleRatesData,((a,l)=>((0,t.wg)(),(0,t.j4)(V,{key:l},{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{outlined:"",modelValue:a.specification,"onUpdate:modelValue":e=>a.specification=e,modelModifiers:{trim:!0},"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","onUpdate:modelValue","rules"])])),_:2},1024),(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{outlined:"",type:"number",modelValue:a.amount,"onUpdate:modelValue":e=>a.amount=e,modelModifiers:{number:!0},"lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","onUpdate:modelValue","rules"])])),_:2},1024),(0,t.Wm)(k,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{round:"",color:"red",icon:"delete",size:"sm",onClick:a=>e.removeSaleRate(l)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,t._)("div",null,[(0,t.Wm)(v,{rounded:"",color:"primary",label:"Create",class:"full-width",onLoading:e.submittingData,type:"submit"},null,8,["onLoading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}l(9665);var p=l(9302),g=l(499),v=l(4019),w=l(8221);const b=[{name:"id",label:"#",field:"id",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"description",label:"Description",field:"description",sortable:!0,align:"left"},{name:"rates",label:"Rates",align:"left"},{name:"actions",label:"Actions",align:"left"}],f=(0,t.aZ)({name:"OtherServices",setup(){const e=(0,p.Z)(),a=(0,g.iH)([]),l=(0,g.iH)(!1),i=(0,g.iH)(!1),o=(0,g.iH)(null),s=(0,g.iH)(!1),n=(0,g.iH)({}),r=(0,g.iH)(null),u=(0,g.iH)({}),d=(0,g.iH)(!1),m=(0,g.iH)(null),c=(0,g.iH)([]),f=(0,g.iH)(null),y=(0,g.iH)(!1);function D(){return l.value=!0,(0,v.getOtherServices)().then((e=>{a.value=e.data})).catch((e=>{})).finally((()=>{l.value=!1}))}function h(){return s.value=!0,(0,v.getOtherServicesCategories)().then((e=>{n.value=e.data})).finally((()=>{s.value=!1}))}return(0,t.bv)((()=>{D().then((()=>{h()}))})),{loadingData:l,tableRows:a,tableColumns:b,periods:["hour","day","week","month"],serviceData:u,createDialog:i,createDialogForm:o,loadingCategories:s,selectedCategory:r,categoryData:n,addSaleRatesDialog:d,addSaleRatesDialogForm:m,selectedService:f,saleRatesData:c,submittingData:y,addSaleRate(){c.value.push({})},removeSaleRate(e){c.value.splice(e,1)},submitServiceData(){o.value.validate()&&(y.value=!0,(0,v.createOtherServices)(r.value,{...u.value}).then((a=>{e.notify({type:"positive",message:a.data}),u.value={},r.value=null,D(),i.value=!1,o.value.resetValidation()})).catch((a=>{e.notify({type:"negative",message:a.response.data.length<1e3?a.response.data:"Server error please contact system administrator"})})).finally((()=>{y.value=!1})))},submitSalesRatesData(){m.value.validate()&&(y.value=!0,(0,v.createOtherServicesSaleRates)(f.value,{items:[...c.value]}).then((a=>{f.value=null,c.value=[],d.value=!1,e.notify({type:"positive",message:a.data}),m.value.resetValidation(),D()})).catch((a=>{e.notify({type:"negative",message:a.response.data.length<1e3?a.response.data:"Server error please contact system administrator"})})).finally((()=>{y.value=!1})))},showDeleteDialog(a){e.dialog({title:"Confirm",message:"Please confirm delete?",cancel:!0}).onOk((()=>{y.value=!0,(0,v.deleteOtherServices)(a).then((e=>{(0,w.displayNotification)(e.data,"positive"),D()})).catch((e=>{(0,w.displayNotification)(e.response.data,"negative")})).finally((()=>{y.value=!1}))}))}}}});var y=l(1639),D=l(9885),h=l(8879),S=l(7355),q=l(7220),R=l(926),_=l(2074),W=l(4458),k=l(8326),V=l(1663),C=l(1973),Z=l(4581),x=l(6611),H=l(3246),Q=l(490),U=l(1233),z=l(2146),I=l(9984),O=l.n(I);const j=(0,y.Z)(f,[["render",c]]),T=j;O()(f,"components",{QPage:D.Z,QBtn:h.Z,QTable:S.Z,QTd:q.Z,QSeparator:R.Z,QDialog:_.Z,QCard:W.Z,QForm:k.Z,QToolbar:V.Z,QToolbarTitle:C.Z,QSelect:Z.Z,QInput:x.Z,QList:H.Z,QItem:Q.Z,QItemSection:U.Z}),O()(f,"directives",{ClosePopup:z.Z})}}]);