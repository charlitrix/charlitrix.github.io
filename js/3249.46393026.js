"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[3249],{3249:(e,s,u)=>{u.r(s),u.d(s,{default:()=>$});var t=u(9835),a=u(6970);const l={class:"column q-col-gutter-y-md q-mt-md q-mx-lg"},n={class:"q-px-md q-pt-xl"},o={class:"column q-col-gutter-y-md q-mt-md q-mx-lg"},i={class:"q-px-md q-pt-xl"},r={class:"column q-col-gutter-y-lg q-mt-md q-mx-lg"},d=(0,t._)("div",null," Security questions will help in resetting account password. ",-1),m={class:"column q-col-gutter-y-xl"},c=(0,t._)("div",{class:"text-weight-bold"},"Question 1",-1),p={class:"column q-gutter-y-md"},q=(0,t._)("div",{class:"text-subtitle1 text-weight-bold"},"Answer:",-1),v=(0,t._)("div",{class:"text-weight-bold"},"Question 2",-1),w={class:"column q-gutter-y-md"},y=(0,t._)("div",{class:"text-subtitle1 text-weight-bold"},"Answer:",-1),b=(0,t._)("div",{class:"text-weight-bold"},"Question 3",-1),g={class:"column q-gutter-y-md"},f=(0,t._)("div",{class:"text-subtitle1 text-weight-bold"},"Answer:",-1),_={class:"q-mt-lg"},V=(0,t._)("div",{class:"q-py-xl"},null,-1);function Q(e,s,u,Q,h,S){const x=(0,t.up)("q-tab"),R=(0,t.up)("q-tabs"),W=(0,t.up)("q-field"),U=(0,t.up)("q-input"),P=(0,t.up)("q-btn"),T=(0,t.up)("q-form"),I=(0,t.up)("q-tab-panel"),H=(0,t.up)("q-select"),Z=(0,t.up)("q-tab-panels"),k=(0,t.up)("q-spinner-ios"),z=(0,t.up)("q-inner-loading"),D=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(D,{class:"q-mx-xl q-mb-xl q-pt-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{modelValue:e.tab,"onUpdate:modelValue":s[0]||(s[0]=s=>e.tab=s),"inline-label":"",align:"justify"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{"no-caps":"",name:"personal",icon:"person",label:"Personal Info"}),(0,t.Wm)(x,{"no-caps":"",name:"password",icon:"lock",label:"Password"}),(0,t.Wm)(x,{"no-caps":"",name:"accountRecovery",icon:"refresh",label:"Account Recovery"})])),_:1},8,["modelValue"]),(0,t.Wm)(Z,{modelValue:e.tab,"onUpdate:modelValue":s[15]||(s[15]=s=>e.tab=s),animated:""},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{name:"personal"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{ref:"userInfoForm",onSubmit:e.submitData},{default:(0,t.w5)((()=>[(0,t._)("div",l,[(0,t.Wm)(W,{"stack-label":"",label:"User Name"},{control:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(e.userData.username),1)])),_:1}),(0,t.Wm)(U,{label:"First Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules(),modelValue:e.userData.first_name,"onUpdate:modelValue":s[1]||(s[1]=s=>e.userData.first_name=s)},null,8,["rules","modelValue"]),(0,t.Wm)(U,{label:"Last Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules(),modelValue:e.userData.last_name,"onUpdate:modelValue":s[2]||(s[2]=s=>e.userData.last_name=s)},null,8,["rules","modelValue"]),(0,t.Wm)(U,{label:"Email","lazy-rules":"ondemand",rules:e.textInputRequiredRules(),modelValue:e.userData.email,"onUpdate:modelValue":s[3]||(s[3]=s=>e.userData.email=s)},null,8,["rules","modelValue"]),(0,t._)("div",n,[(0,t.Wm)(P,{rounded:"",color:"primary",label:"Update",type:"submit",class:"full-width",loading:e.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1}),(0,t.Wm)(I,{name:"password"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{ref:"passwordResetForm",onSubmit:e.submitPasswordUpdate},{default:(0,t.w5)((()=>[(0,t._)("div",o,[(0,t.Wm)(U,{modelValue:e.currentPassword,"onUpdate:modelValue":s[5]||(s[5]=s=>e.currentPassword=s),label:"Current password","lazy-rules":"ondemand",rules:e.textInputRequiredRules(),type:e.passwordToggle1?"password":"text"},{append:(0,t.w5)((()=>[(0,t.Wm)(P,{flat:"",round:"",icon:e.passwordToggle1?"visibility_off":"visibility",onClick:s[4]||(s[4]=s=>e.passwordToggle1=!e.passwordToggle1)},null,8,["icon"])])),_:1},8,["modelValue","rules","type"]),(0,t.Wm)(U,{modelValue:e.newPassword,"onUpdate:modelValue":s[7]||(s[7]=s=>e.newPassword=s),label:"New password","lazy-rules":"ondemand",rules:e.textInputRequiredRules(),type:e.passwordToggle2?"password":"text"},{append:(0,t.w5)((()=>[(0,t.Wm)(P,{flat:"",round:"",icon:e.passwordToggle2?"visibility_off":"visibility",onClick:s[6]||(s[6]=s=>e.passwordToggle2=!e.passwordToggle2)},null,8,["icon"])])),_:1},8,["modelValue","rules","type"]),(0,t.Wm)(U,{modelValue:e.confirmPassword,"onUpdate:modelValue":s[8]||(s[8]=s=>e.confirmPassword=s),label:"Confirm password","lazy-rules":"ondemand",rules:[...e.textInputRequiredRules(),...e.equalToRequiredRules(e.newPassword,"Passwords do not match.")],type:"password"},null,8,["modelValue","rules"]),(0,t._)("div",i,[(0,t.Wm)(P,{rounded:"",color:"primary",label:"Update",class:"full-width",type:"submit",loading:e.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1}),(0,t.Wm)(I,{name:"accountRecovery"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{ref:"securityQuestionsForm",onSubmit:e.submitUserSecurityQuestions},{default:(0,t.w5)((()=>[(0,t._)("div",r,[d,(0,t._)("div",m,[(0,t._)("div",null,[c,(0,t._)("div",p,[(0,t.Wm)(H,{modelValue:e.userSecurityQuestions.question1.question,"onUpdate:modelValue":s[9]||(s[9]=s=>e.userSecurityQuestions.question1.question=s),options:e.userSecurityQuestions.question1.options,"option-label":e=>e+" ?","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.userSecurityQuestions.question1.options)},null,8,["modelValue","options","option-label","rules"]),(0,t.Wm)(U,{dense:"",outlined:"",modelValue:e.userSecurityQuestions.question1.answer,"onUpdate:modelValue":s[10]||(s[10]=s=>e.userSecurityQuestions.question1.answer=s),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},{before:(0,t.w5)((()=>[q])),_:1},8,["modelValue","rules"])])]),(0,t._)("div",null,[v,(0,t._)("div",w,[(0,t.Wm)(H,{modelValue:e.userSecurityQuestions.question2.question,"onUpdate:modelValue":s[11]||(s[11]=s=>e.userSecurityQuestions.question2.question=s),options:e.userSecurityQuestions.question2.options,"option-label":e=>e+" ?","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.userSecurityQuestions.question2.options)},null,8,["modelValue","options","option-label","rules"]),(0,t.Wm)(U,{dense:"",outlined:"",modelValue:e.userSecurityQuestions.question2.answer,"onUpdate:modelValue":s[12]||(s[12]=s=>e.userSecurityQuestions.question2.answer=s),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},{before:(0,t.w5)((()=>[y])),_:1},8,["modelValue","rules"])])]),(0,t._)("div",null,[b,(0,t._)("div",g,[(0,t.Wm)(H,{modelValue:e.userSecurityQuestions.question3.question,"onUpdate:modelValue":s[13]||(s[13]=s=>e.userSecurityQuestions.question3.question=s),options:e.userSecurityQuestions.question3.options,"option-label":e=>e+" ?","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.userSecurityQuestions.question3.options)},null,8,["modelValue","options","option-label","rules"]),(0,t.Wm)(U,{dense:"",outlined:"",modelValue:e.userSecurityQuestions.question3.answer,"onUpdate:modelValue":s[14]||(s[14]=s=>e.userSecurityQuestions.question3.answer=s),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},{before:(0,t.w5)((()=>[f])),_:1},8,["modelValue","rules"])])])]),(0,t._)("div",_,[(0,t.Wm)(P,{rounded:"",loading:e.submitting,class:"full-width",color:"primary",label:e.updateQuestions?"Update":"Submit",type:"submit"},null,8,["loading","label"])]),V])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(z,{dark:"",showing:e.loadingData},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{size:"50px",color:"white"})])),_:1},8,["showing"])])),_:1})}var h=u(9302),S=u(499),x=u(4019),R=u(8221),W=u(8339),U=u(6144),P=u(1809);const T=(0,t.aZ)({name:"AccountInfo",props:["currentTab"],setup(e){const s=(0,h.Z)(),u=((0,W.tv)(),(0,U.L)()),a={question1:{question:null,options:[],answer:null},question2:{question:null,options:[],answer:null},question3:{question:null,options:[],answer:null}},{user:l}=(0,P.Jk)(u),{saveUser:n}=u,o=(0,S.iH)("personal"),i=(0,S.iH)(!0),r=(0,S.iH)(!0),d=(0,S.iH)(!1),m=(0,S.iH)(null),c=(0,S.iH)([]),p=(0,S.iH)(!1),q=(0,S.iH)(""),v=(0,S.iH)(""),w=(0,S.iH)(""),y=(0,S.iH)({username:l.value.username,first_name:l.value.first_name,last_name:l.value.last_name,email:l.value.email}),b=(0,S.iH)(null),g=(0,S.iH)(null),f=(0,S.iH)([]),_=(0,S.iH)({...a}),V=(0,S.iH)(null),Q=(0,S.iH)(!1);function T(){return d.value=!0,(0,x.getUsers)(`/${l.value.id}`).then((e=>{n(e.data)})).finally((()=>{d.value=!1}))}function I(){d.value=!0,(0,x.getAccountRecoveryQuestions)().then((e=>{f.value=e.data.map((e=>e.question))})).finally((()=>{d.value=!1}))}function H(){d.value=!0,(0,x.getUserSecurityQuestions)().then((e=>{e.data&&3==e.data.length&&(_.value.question1.question=e.data[0].question,_.value.question1.answer=e.data[0].answer,_.value.question1.id=e.data[0].id,_.value.question2.question=e.data[1].question,_.value.question2.answer=e.data[1].answer,_.value.question2.id=e.data[1].id,_.value.question3.question=e.data[2].question,_.value.question3.answer=e.data[2].answer,_.value.question3.id=e.data[2].id,Q.value=!0)})).finally((()=>{d.value=!1}))}function Z(){return Q.value?(0,x.updateUserSecurityQuestions)([{id:_.value.question1.id,question:_.value.question1.question,answer:_.value.question1.answer},{id:_.value.question2.id,question:_.value.question2.question,answer:_.value.question2.answer},{id:_.value.question3.id,question:_.value.question3.question,answer:_.value.question3.answer}]):(0,x.createUserSecurityQuestions)([{question:_.value.question1.question,answer:_.value.question1.answer},{question:_.value.question2.question,answer:_.value.question2.answer},{question:_.value.question3.question,answer:_.value.question3.answer}])}return(0,t.m0)((()=>{_.value.question1.options=f.value.filter((e=>e!=_.value.question2.question&&e!=_.value.question3.question)),_.value.question2.options=f.value.filter((e=>e!=_.value.question1.question&&e!=_.value.question3.question)),_.value.question3.options=f.value.filter((e=>e!=_.value.question1.question&&e!=_.value.question2.question))})),(0,t.bv)((()=>{e.currentTab&&(o.value=e.currentTab),T().then((()=>{I(),H()}))})),{tab:o,passwordToggle1:i,passwordToggle2:r,userData:y,userInfoForm:b,passwordResetForm:g,accountData:c,accountType:m,submitting:p,newPassword:v,currentPassword:q,confirmPassword:w,userSecurityQuestions:_,securityQuestionsForm:V,updateQuestions:Q,loadingData:d,submitPasswordUpdate(){g.value.validate().then((e=>{e&&s.dialog({title:"Confirm",message:"Please confirm",cancel:!0}).onOk((()=>{p.value=!0,(0,x.updatePassword)(l.value.id,{current_password:q.value,new_password:v.value}).then((e=>{s.notify({message:e.data,color:"positive",timeout:2e4}),q.value="",v.value="",w.value="",g.value.resetValidation(),_.value.question1.question||(o.value="accountRecovery")})).catch((e=>{(0,R.displayNotification)(e.response.data,"negative")})).finally((()=>{p.value=!1}))}))}))},submitData(){b.value.validate().then((e=>{e&&s.dialog({title:"Confirm",message:"Please confirm",cancel:!0}).onOk((()=>{p.value=!0,(0,x.editUser)(l.value.id,{...y.value,account_type_id:l.value.account_type.id}).then((e=>{(0,R.displayNotification)(e.data,"positive"),b.value.resetValidation(),T()})).catch((e=>{(0,R.displayNotification)(e.response.data,"negative")})).finally((()=>{p.value=!1}))}))}))},submitUserSecurityQuestions(){V.value.validate().then((e=>{e&&s.dialog({title:"Confirm",message:"Please confirm",cancel:!0}).onOk((()=>{p.value=!0,Z().then((e=>{(0,R.displayNotification)(e.data,"positive"),H(),V.value.resetValidation()})).catch((e=>{(0,R.displayNotification)(e.response.data,"negative")})).finally((()=>{p.value=!1}))}))}))}}}});var I=u(1639),H=u(9885),Z=u(7817),k=u(900),z=u(9800),D=u(4106),C=u(8326),F=u(8149),N=u(6611),A=u(8879),L=u(4581),O=u(854),j=u(8359),B=u(9984),E=u.n(B);const J=(0,I.Z)(T,[["render",Q]]),$=J;E()(T,"components",{QPage:H.Z,QTabs:Z.Z,QTab:k.Z,QTabPanels:z.Z,QTabPanel:D.Z,QForm:C.Z,QField:F.Z,QInput:N.Z,QBtn:A.Z,QSelect:L.Z,QInnerLoading:O.Z,QSpinnerIos:j.Z})}}]);