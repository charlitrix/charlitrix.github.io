"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[1009],{1009:(a,e,t)=>{t.r(e),t.d(e,{default:()=>Fe});var l=t(9835),u=t(6970);const o={class:"row justify-around text-weight-bold q-mt-md items-center"},s={class:"row no-wrap"},d={key:1,class:"q-ml-sm"},n={class:"row no-wrap"},i={class:"col-md-4 column"},m={class:"row items-center q-col-gutter-x-xl"},r=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Customer Details",-1),c={key:0},p={class:"col-md-7 column"},_=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Rooms",-1),w=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Room"),(0,l._)("th",null,"Arrival"),(0,l._)("th",null,"Departure"),(0,l._)("th",null,"Price"),(0,l._)("th",null,"Quantity"),(0,l._)("th",null,"Amount")])],-1),g={class:"text-nowrap"},v={key:1,class:"row q-mt-xl"},y={class:"col-7"},D=(0,l._)("div",{class:"text-weight-bold"},"Payments",-1),f={class:"q-mt-md"},b=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Amount"),(0,l._)("th",null,"Mode of payment"),(0,l._)("th",null,"Details"),(0,l._)("th",null,"Date")])],-1),q={key:0},h=(0,l._)("span",null," - ",-1),W={key:0},x=(0,l._)("td",{colspan:"100%",class:"text-grey-10"}," No payments available ... ",-1),k=[x],V={key:0,class:"col-3 q-px-xl"},z=(0,l._)("div",{class:"text-weight-bold"},"Invoice",-1),S={class:"q-mt-md"},P={class:"print-only"},U={id:"orderReceiptPrintOut"},R={class:"q-px-lg q-pt-xl q-mb-lg"},Z={class:"row q-mb-sm"},F=(0,l._)("div",{class:"col-3"},"Name:",-1),C={class:"col"},Q={class:"row"},O=(0,l._)("div",{class:"col-3"},"Transaction:",-1),I={class:"col"},H=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Days"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Amount")])],-1),Y={class:"text-weight-bold"},N=(0,l._)("td",{colspan:"3",class:"text-right"},"Total",-1),M={key:0,class:"text-center"},E={class:"text-weight-bold"},A=(0,l._)("td",{colspan:"3",class:"text-right"},"Paid",-1),T={class:"text-center"},j={class:"text-weight-bold"},B=(0,l._)("td",{colspan:"3",class:"text-right"},"Balance",-1),L={class:"text-center"},K=(0,l._)("div",{class:"q-py-md"},null,-1),G={class:"column q-col-gutter-y-sm q-mt-sm q-mx-lg q-mb-xl"},$={class:"q-mb-md"},J={class:"row justify-end"},X={class:"q-px-lg q-pt-lg"},aa={class:"column"},ea={key:0,class:"q-px-lg"},ta={class:"q-pt-md"},la={style:{minWidth:"100%",width:"100%"}},ua={class:"q-px-lg q-pt-xl q-mb-lg"},oa={class:"row q-mb-sm"},sa=(0,l._)("div",{class:"col-3"},"Name:",-1),da={class:"col"},na={class:"row"},ia=(0,l._)("div",{class:"col-3"},"Transaction:",-1),ma={class:"col"},ra=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Days"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Amount")])],-1),ca={class:"text-weight-bold"},pa=(0,l._)("td",{colspan:"3",class:"text-right"},"Total",-1),_a={key:0,class:"text-center"},wa={class:"text-weight-bold"},ga=(0,l._)("td",{colspan:"3",class:"text-right"},"Paid",-1),va={class:"text-center"},ya={class:"text-weight-bold"},Da=(0,l._)("td",{colspan:"3",class:"text-right"},"Balance",-1),fa={class:"text-center"},ba={class:"q-px-md"},qa=(0,l._)("div",{class:"q-py-md"},null,-1),ha={class:"row items-center q-col-gutter-x-lg"},Wa=(0,l._)("div",{class:"col-3 text-right"},"Name:",-1),xa={class:"col-8"},ka={class:"row items-center q-col-gutter-x-lg"},Va=(0,l._)("div",{class:"col-3 text-right"},"Contact:",-1),za={class:"col-8"},Sa={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Pa=(0,l._)("div",{class:"col-3 text-right"},"Address:",-1),Ua={class:"col-8"},Ra={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Za=(0,l._)("div",{class:"col-3 text-right"},"ID:",-1),Fa={class:"col-8"},Ca={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Qa=(0,l._)("div",{class:"col-3 text-right"},"Nationality:",-1),Oa={class:"col-8"},Ia={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ha=(0,l._)("div",{class:"col-3 text-right"},"District:",-1),Ya={class:"col-8"},Na={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ma=(0,l._)("div",{class:"col-3 text-right"},"Occupation:",-1),Ea={class:"col-8"},Aa={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ta=(0,l._)("div",{class:"col-3 text-right"},"Organisation:",-1),ja={class:"col-8"},Ba={class:"q-pt-lg"};function La(a,e,t,x,La,Ka){const Ga=(0,l.up)("q-breadcrumbs-el"),$a=(0,l.up)("q-breadcrumbs"),Ja=(0,l.up)("q-btn"),Xa=(0,l.up)("q-separator"),ae=(0,l.up)("q-item-label"),ee=(0,l.up)("q-item-section"),te=(0,l.up)("q-item"),le=(0,l.up)("q-list"),ue=(0,l.up)("q-markup-table"),oe=(0,l.up)("q-card-section"),se=(0,l.up)("q-card"),de=(0,l.up)("q-page"),ne=(0,l.up)("q-spinner-ios"),ie=(0,l.up)("q-inner-loading"),me=(0,l.up)("q-toolbar-title"),re=(0,l.up)("q-toolbar"),ce=(0,l.up)("balance-calculator-component"),pe=(0,l.up)("q-expansion-item"),_e=(0,l.up)("q-date"),we=(0,l.up)("q-popup-proxy"),ge=(0,l.up)("q-field"),ve=(0,l.up)("money-input-component"),ye=(0,l.up)("q-select"),De=(0,l.up)("q-input"),fe=(0,l.up)("q-form"),be=(0,l.up)("q-dialog"),qe=(0,l.up)("q-radio"),he=(0,l.up)("q-slide-transition"),We=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(de,{class:"q-mx-xl q-mb-lg q-mt-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)($a,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Ga,{to:{name:"RoomsSales"}},{default:(0,l.w5)((()=>[(0,l.Uk)("Sales")])),_:1}),(0,l.Wm)(Ga,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.Id),1)])),_:1})])),_:1}),(0,l._)("div",o,[(0,l._)("div",null,"Date: "+(0,u.zw)(a.pageData.date),1),(0,l._)("div",null,"Bill: "+(0,u.zw)(a.formatPrice(a.pageData.bill)),1),(0,l._)("div",null,"Paid: "+(0,u.zw)(a.formatPrice(a.pageData.paid)),1),(0,l._)("div",null,"Balance: "+(0,u.zw)(a.formatPrice(a.pageData.bill-a.pageData.paid)),1),(0,l._)("div",s,[a.pageData.bill!==a.pageData.paid&&"OPEN"==a.pageData.status&&a.permissionRequired("rooms","add_payment")&&!a.pageData.invoice_id?((0,l.wg)(),(0,l.j4)(Ja,{key:0,dense:"","no-caps":"",rounded:"",color:"primary",label:"Add Payment",class:"full-width q-px-md",onClick:e[0]||(e[0]=e=>a.addPaymentDialog=!a.addPaymentDialog)})):(0,l.kq)("",!0),"CLOSED"!==a.pageData.status?((0,l.wg)(),(0,l.iD)("div",d,[a.permissionRequired("rooms","change_sale")?((0,l.wg)(),(0,l.j4)(Ja,{key:0,dense:"","no-caps":"",rounded:"","no-wrap":"",color:"primary",label:"Update Status",class:"full-width q-px-md",onClick:e[1]||(e[1]=e=>a.updateStatusDialog=!a.updateStatusDialog)})):(0,l.kq)("",!0)])):(0,l.kq)("",!0)])]),(0,l.Wm)(Xa,{class:"q-my-sm bg-grey"}),a.permissionRequired("rooms","change_sale")?((0,l.wg)(),(0,l.j4)(Ja,{key:0,unelevated:"",dense:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:e[2]||(e[2]=e=>a.orderReceipt=!a.orderReceipt)})):(0,l.kq)("",!0),(0,l._)("div",n,[(0,l._)("div",i,[(0,l._)("div",m,[r,"OPEN"===a.pageData.status?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(Ja,{round:"",size:"sm",color:"primary",icon:"edit",onClick:e[3]||(e[3]=e=>a.customerFormDialog=!a.customerFormDialog)})])):(0,l.kq)("",!0)]),(0,l.Wm)(le,{dense:""},{default:(0,l.w5)((()=>[(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Name :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.name),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Contact :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.contact),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Address :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.address),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("ID :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.identification_number),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Nationality :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.nationality),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("District :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.district),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Occupation :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.occupation),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(te,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Organisation :")])),_:1})])),_:1}),(0,l.Wm)(ee,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ae,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.customerData.organisation),1)])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l.Wm)(Xa,{class:"q-mx-md",inset:"",vertical:""}),(0,l._)("div",p,[_,(0,l.Wm)(ue,{flat:"",bordered:"",separator:"vertical"},{default:(0,l.w5)((()=>[w,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.roomsData,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,(0,u.zw)(e.room_name),1),(0,l._)("td",null,(0,u.zw)(e.arrival),1),(0,l._)("td",null,(0,u.zw)(e.departure),1),(0,l._)("td",null,(0,u.zw)(a.formatPrice(e.amount))+" @ "+(0,u.zw)(e.unit),1),(0,l._)("td",null,(0,u.zw)(e.quantity),1),(0,l._)("td",g,(0,u.zw)(a.formatPrice(e.total_price)),1)])))),128))])])),_:1})])]),a.permissionRequired("rooms","view_payment")?((0,l.wg)(),(0,l.iD)("div",v,[(0,l._)("div",y,[D,(0,l.Wm)(Xa,{class:"q-mt-sm"}),(0,l._)("div",f,[(0,l.Wm)(ue,{flat:"",bordered:"",separator:"vertical"},{default:(0,l.w5)((()=>[b,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.paymentsData,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,(0,u.zw)(a.formatPrice(e.amount)),1),(0,l._)("td",null,(0,u.zw)(e.method),1),(0,l._)("td",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(e?.other_details),(a=>((0,l.wg)(),(0,l.iD)("div",{key:a},[a.startsWith("_")?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("span",q,[(0,l.Uk)((0,u.zw)(a),1),h,(0,l.Uk)((0,u.zw)(e?.other_details[a]),1)]))])))),128))]),(0,l._)("td",null,(0,u.zw)(e.date),1)])))),128)),a.paymentsData.length<1?((0,l.wg)(),(0,l.iD)("tr",W,k)):(0,l.kq)("",!0)])])),_:1})])]),a.pageData.invoice_id?((0,l.wg)(),(0,l.iD)("div",V,[z,(0,l.Wm)(Xa,{class:"q-mt-sm"}),(0,l._)("div",S,[(0,l.Wm)(Ja,{outline:"",label:"invoice # "+a.pageData.invoice_id,"icon-right":"keyboard_arrow_right",color:"primary",to:{name:"InvoiceDetails",params:{id:a.pageData.invoice_id}}},null,8,["label","to"])])])):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l._)("div",P,[(0,l._)("div",U,[(0,l.Wm)(se,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l.Wm)(oe,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l._)("div",R,[(0,l._)("div",Z,[F,(0,l._)("div",C,(0,u.zw)(a.pageData.customer.name),1)]),(0,l._)("div",Q,[O,(0,l._)("div",I,(0,u.zw)(a.pageData.id),1)])]),(0,l.Wm)(ue,{"wrap-cells":"",bordered:"",flat:"",cell:"horizontal",class:"overflow-hidden"},{default:(0,l.w5)((()=>[H,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pageData.details,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id,class:"text-center"},[(0,l._)("td",null,(0,u.zw)(e.quantity),1),(0,l._)("td",null,(0,u.zw)(e.days),1),(0,l._)("td",null,(0,u.zw)(e.room_name),1),(0,l._)("td",null,(0,u.zw)(a.formatPrice(e.amount*e.quantity*e.days)),1)])))),128)),(0,l._)("tr",Y,[N,a.pageData.details?((0,l.wg)(),(0,l.iD)("td",M,(0,u.zw)(a.formatPrice(a.itemsProductSum2(a.pageData.details,a.attrubutes=["amount","quantity","days"]))),1)):(0,l.kq)("",!0)]),(0,l._)("tr",E,[A,(0,l._)("td",T,(0,u.zw)(a.formatPrice(a.itemsSum(a.pageData.payments))),1)]),(0,l._)("tr",j,[B,(0,l._)("td",L,(0,u.zw)(a.formatPrice(a.itemsProductSum2(a.pageData.details,a.attrubutes=["amount","quantity","days"])-a.itemsSum(a.pageData.payments))),1)])])])),_:1}),K])])),_:1})])),_:1})])])])),_:1}),(0,l.Wm)(ie,{showing:a.loadingData},{default:(0,l.w5)((()=>[(0,l.Wm)(ne,{size:"50px",color:"primary"})])),_:1},8,["showing"]),(0,l.Wm)(be,{modelValue:a.addPaymentDialog,"onUpdate:modelValue":e[8]||(e[8]=e=>a.addPaymentDialog=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(se,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(fe,{ref:"paymentForm",onSubmit:a.savePayment},{default:(0,l.w5)((()=>[(0,l.Wm)(re,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(me,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Payment")])),_:1}),(0,l.wy)((0,l.Wm)(Ja,{flat:"",round:"",size:"md",icon:"close"},null,512),[[We]])])),_:1}),(0,l.Wm)(Xa),(0,l._)("div",G,[(0,l._)("div",$,[(0,l.Wm)(pe,{dense:"","dense-toggle":"",label:"Balance Calculator","header-class":"text-primary",class:"rounded-borders",style:(0,u.j5)({border:"1px solid var(--q-primary)"})},{default:(0,l.w5)((()=>[(0,l.Wm)(ce,{defaultAmount:a.pageData.bill-a.pageData.paid},null,8,["defaultAmount"])])),_:1},8,["style"])]),(0,l.Wm)(ge,{outlined:"",label:"Date",modelValue:a.paymentData.date,"onUpdate:modelValue":e[5]||(e[5]=e=>a.paymentData.date=e),"lazy-rules":"ondemand",rules:a.textInputRequiredRules()},{control:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(a.paymentData.date),1)])),append:(0,l.w5)((()=>[(0,l.Wm)(Ja,{size:"sm",round:"",color:"primary",icon:"event"},{default:(0,l.w5)((()=>[(0,l.Wm)(we,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_e,{modelValue:a.paymentData.date,"onUpdate:modelValue":e[4]||(e[4]=e=>a.paymentData.date=e),mask:"DD/MM/YYYY"},{default:(0,l.w5)((()=>[(0,l._)("div",J,[(0,l.wy)((0,l.Wm)(Ja,{"no-caps":"",label:"Close"},null,512),[[We]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,l.Wm)(ve,{modelValue:a.paymentData.amount,"onUpdate:modelValue":e[6]||(e[6]=e=>a.paymentData.amount=e),"input-class":"text-h6",label:"Amount"},null,8,["modelValue"]),(0,l.Wm)(ye,{outlined:"",modelValue:a.paymentData.method,"onUpdate:modelValue":e[7]||(e[7]=e=>a.paymentData.method=e),label:"Mode of payment",options:a.paymentMethodOptions,"option-label":"name","lazy-rules":"ondemand",rules:a.selectInputRequiredRules(a.paymentMethodOptions)},null,8,["modelValue","options","rules"]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(a.fields),((e,t)=>((0,l.wg)(),(0,l.j4)(De,{outlined:"",key:t,"model-value":a.fields[e],"onUpdate:modelValue":t=>a.fields[e]=t,label:e},null,8,["model-value","onUpdate:modelValue","label"])))),128)),(0,l._)("div",X,[(0,l.Wm)(Ja,{rounded:"","no-caps":"",color:"primary",label:"Add Payment",class:"full-width",type:"submit",loading:a.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(be,{modelValue:a.updateStatusDialog,"onUpdate:modelValue":e[14]||(e[14]=e=>a.updateStatusDialog=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(se,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(re,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(me,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Status")])),_:1}),(0,l.wy)((0,l.Wm)(Ja,{flat:"",round:"",size:"md",icon:"close"},null,512),[[We]])])),_:1}),(0,l.Wm)(Xa),(0,l.Wm)(oe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(fe,{ref:"updateStatusForm",onSubmit:a.submitStatusData},{default:(0,l.w5)((()=>[(0,l.Wm)(ge,{outlined:"",modelValue:a.newStatus,"onUpdate:modelValue":e[13]||(e[13]=e=>a.newStatus=e),"lazy-rules":"ondemand",rules:a.textInputRequiredRules("Please select an option")},{control:(0,l.w5)((()=>[(0,l._)("div",aa,["CANCELLED"==a.pageData.status?((0,l.wg)(),(0,l.j4)(qe,{key:0,modelValue:a.newStatus,"onUpdate:modelValue":e[9]||(e[9]=e=>a.newStatus=e),val:a.statusOptions.open.value,label:a.statusOptions.open.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==a.pageData.status?((0,l.wg)(),(0,l.j4)(qe,{key:1,modelValue:a.newStatus,"onUpdate:modelValue":e[10]||(e[10]=e=>a.newStatus=e),val:a.statusOptions.close.value,label:a.statusOptions.close.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==a.pageData.status?((0,l.wg)(),(0,l.j4)(qe,{key:2,modelValue:a.newStatus,"onUpdate:modelValue":e[11]||(e[11]=e=>a.newStatus=e),val:a.statusOptions.cancel.value,label:a.statusOptions.cancel.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),(0,l.Wm)(he,null,{default:(0,l.w5)((()=>["cancel"==a.newStatus?((0,l.wg)(),(0,l.iD)("div",ea,[(0,l.Wm)(De,{outlined:"",label:"Reason",type:"textarea",rows:"5","lazy-rules":"ondemand",rules:[...a.textInputRequiredRules(),...a.minimumRequiredRules(10)],modelValue:a.statusOptions.cancel.data.reason,"onUpdate:modelValue":e[12]||(e[12]=e=>a.statusOptions.cancel.data.reason=e)},null,8,["rules","modelValue"])])):(0,l.kq)("",!0)])),_:1})])])),_:1},8,["modelValue","rules"]),(0,l._)("div",ta,[(0,l.Wm)(Ja,{rounded:"",type:"submit",color:"primary",label:"submit",class:"full-width",loading:a.submitting},null,8,["loading"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(be,{modelValue:a.orderReceipt,"onUpdate:modelValue":e[16]||(e[16]=e=>a.orderReceipt=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(se,{style:{minWidth:"500px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(oe,null,{default:(0,l.w5)((()=>[(0,l._)("div",la,[(0,l._)("div",ua,[(0,l._)("div",oa,[sa,(0,l._)("div",da,(0,u.zw)(a.pageData.customer.name),1)]),(0,l._)("div",na,[ia,(0,l._)("div",ma,(0,u.zw)(a.pageData.id),1)])]),(0,l.Wm)(ue,{bordered:"",flat:"",cell:"horizontal"},{default:(0,l.w5)((()=>[ra,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pageData.details,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id,class:"text-center"},[(0,l._)("td",null,(0,u.zw)(e.quantity),1),(0,l._)("td",null,(0,u.zw)(e.days),1),(0,l._)("td",null,(0,u.zw)(e.room_name),1),(0,l._)("td",null,(0,u.zw)(a.formatPrice(e.amount*e.quantity*e.days)),1)])))),128)),(0,l._)("tr",ca,[pa,a.pageData.details?((0,l.wg)(),(0,l.iD)("td",_a,(0,u.zw)(a.formatPrice(a.itemsProductSum2(a.pageData.details,a.attrubutes=["amount","quantity","days"]))),1)):(0,l.kq)("",!0)]),(0,l._)("tr",wa,[ga,(0,l._)("td",va,(0,u.zw)(a.formatPrice(a.itemsSum(a.pageData.payments))),1)]),(0,l._)("tr",ya,[Da,(0,l._)("td",fa,(0,u.zw)(a.formatPrice(a.itemsProductSum2(a.pageData.details,a.attrubutes=["amount","quantity","days"])-a.itemsSum(a.pageData.payments))),1)])])])),_:1}),(0,l._)("div",ba,[(0,l.Wm)(Ja,{rounded:"",label:"print",icon:"print",color:"primary",class:"full-width",onClick:e[15]||(e[15]=e=>a.printDocument("orderReceiptPrintOut",a.printingSettings))})]),qa])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(be,{modelValue:a.customerFormDialog,"onUpdate:modelValue":e[25]||(e[25]=e=>a.customerFormDialog=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(se,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(fe,{ref:"customerForm",onSubmit:a.submitCustomerData},{default:(0,l.w5)((()=>[(0,l.Wm)(re,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(me,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Customer Details")])),_:1}),(0,l.wy)((0,l.Wm)(Ja,{flat:"",round:"",size:"md",icon:"close"},null,512),[[We]])])),_:1}),(0,l.Wm)(oe,{class:"column q-col-gutter-y-md q-mx-md q-mt-sm"},{default:(0,l.w5)((()=>[(0,l._)("div",ha,[Wa,(0,l._)("div",xa,[(0,l.Wm)(De,{dense:"",outlined:"",modelValue:a.customerFormData.name,"onUpdate:modelValue":e[17]||(e[17]=e=>a.customerFormData.name=e),"lazy-rules":"ondemand",rules:a.textInputRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",ka,[Va,(0,l._)("div",za,[(0,l.Wm)(De,{dense:"",outlined:"",mask:"### ### ######","unmasked-value":"",modelValue:a.customerFormData.contact,"onUpdate:modelValue":e[18]||(e[18]=e=>a.customerFormData.contact=e),"lazy-rules":"ondemand",rules:a.contactRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",Sa,[Pa,(0,l._)("div",Ua,[(0,l.Wm)(De,{dense:"",outlined:"",modelValue:a.customerFormData.address,"onUpdate:modelValue":e[19]||(e[19]=e=>a.customerFormData.address=e)},null,8,["modelValue"])])]),(0,l._)("div",Ra,[Za,(0,l._)("div",Fa,[(0,l.Wm)(De,{dense:"",outlined:"",modelValue:a.customerFormData.identification_number,"onUpdate:modelValue":e[20]||(e[20]=e=>a.customerFormData.identification_number=e)},null,8,["modelValue"])])]),(0,l._)("div",Ca,[Qa,(0,l._)("div",Oa,[(0,l.Wm)(De,{dense:"",outlined:"",modelValue:a.customerFormData.nationality,"onUpdate:modelValue":e[21]||(e[21]=e=>a.customerFormData.nationality=e)},null,8,["modelValue"])])]),(0,l._)("div",Ia,[Ha,(0,l._)("div",Ya,[(0,l.Wm)(De,{dense:"",outlined:"",modelValue:a.customerFormData.district,"onUpdate:modelValue":e[22]||(e[22]=e=>a.customerFormData.district=e)},null,8,["modelValue"])])]),(0,l._)("div",Na,[Ma,(0,l._)("div",Ea,[(0,l.Wm)(De,{dense:"",outlined:"",modelValue:a.customerFormData.occupation,"onUpdate:modelValue":e[23]||(e[23]=e=>a.customerFormData.occupation=e)},null,8,["modelValue"])])]),(0,l._)("div",Aa,[Ta,(0,l._)("div",ja,[(0,l.Wm)(De,{dense:"",outlined:"",modelValue:a.customerFormData.organisation,"onUpdate:modelValue":e[24]||(e[24]=e=>a.customerFormData.organisation=e)},null,8,["modelValue"])])]),(0,l._)("div",Ba,[(0,l.Wm)(Ja,{rounded:"",class:"full-width",label:"submit",color:"primary",type:"submit",loading:a.submitting},null,8,["loading"])])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var Ka=t(9302),Ga=t(4170),$a=t(499),Ja=t(2580),Xa=t(9258),ae=t(4019),ee=t(8221);const te=(0,l.aZ)({name:"RoomTypes",props:{Id:{required:!0}},components:{MoneyInputComponent:Ja.Z,BalanceCalculatorComponent:Xa.Z},setup(a){(0,Ka.Z)();const e={customer:{},payments:[],details:[],bill:0,paid:0},t=(0,$a.iH)({}),u=(0,$a.iH)({...e}),o=(0,l.Fl)((()=>u.value.customer?u.value.customer:{})),s=(0,l.Fl)((()=>u.value.payments?u.value.payments:[])),d=(0,l.Fl)((()=>u.value.details?u.value.details:[])),n=(0,$a.iH)(!1),i=(0,$a.iH)(!1),m=(0,$a.iH)({}),r=(0,$a.iH)([]),c=(0,$a.iH)(null),p={open:{label:"Open",value:"open",data:{status:"OPEN"}},close:{label:"Close",value:"close",data:{status:"CLOSED"}},cancel:{label:"Cancel",value:"cancel",data:{status:"CANCELLED",reason:""}}},_=(0,$a.iH)(),w=(0,$a.iH)(!1),g=(0,$a.iH)(!1),v=(0,$a.iH)(!1),y=(0,$a.iH)({}),D=(0,$a.iH)(null),f=(0,$a.iH)(!1),b=(0,$a.iH)(null),q=(0,$a.iH)({});function h(){return n.value=!0,u.value={...e},(0,ae.getRoomsSales)(`/${a.Id}`).then((a=>{u.value=a.data})).then((()=>{q.value={...o.value}})).finally((()=>{n.value=!1}))}function W(){return(0,ae.getGeneralSettings)("?name=PRINTERS").then((a=>{t.value=a.data.details["items"].find((a=>"rooms receipts"==a.item))||a.data.details["items"].find((a=>"receipts"==a.item))}))}return(0,l.m0)((()=>{m.value&&m.value.method&&m.value.method.other_details&&m.value.method.other_details.fields?y.value=m.value.method.other_details.fields.reduce(((a,e)=>({...a,[e]:null})),{}):y.value={}})),(0,l.bv)((()=>{m.value.date=Ga.ZP.formatDate(new Date,"DD/MM/YYYY"),h().then((()=>{(0,ae.getPaymentMethods)().then((a=>{r.value=a.data,W()}))}))})),(0,l.m0)((()=>{d.value.forEach((a=>{a.arrival&&a.departure?(a.days=parseInt(Ga.ZP.getDateDiff(Ga.ZP.extractDate(a.departure,"DD/MM/YYYY"),Ga.ZP.extractDate(a.arrival,"DD/MM/YYYY"))+1),a.total_price=a.days*a.amount*a.quantity):a.total_price=0}))})),{pageData:u,customerData:o,paymentsData:s,roomsData:d,addPaymentDialog:i,paymentData:m,paymentMethodOptions:r,submitting:w,fields:y,updateStatusDialog:g,newStatus:c,statusOptions:p,loadingData:n,updateStatusForm:_,orderReceipt:v,printingSettings:t,paymentForm:D,customerForm:b,customerFormDialog:f,customerFormData:q,submitCustomerData(){b.value.validate()&&(w.value=!0,(0,ae.updateRoomSalesCustomer)(a.Id,q.value).then((a=>{(0,ee.displayNotification)(a.data,"positive"),q.value={},b.value.resetValidation(),f.value=!1,h()})).catch((a=>{(0,ee.displayNotification)(a,"negative",{error:!0})})).finally((()=>{w.value=!1})))},savePayment(){D.value.validate()&&(w.value=!0,(0,ae.addRoomSalePayments)(a.Id,{...m.value,method:m.value.method.id,other_details:y.value}).then((a=>{(0,ee.displayNotification)(a.data,"positive"),m.value={},h(),i.value=!1,D.value.resetValidation()})).catch((a=>{(0,ee.displayNotification)(a,"negative",{error:!0})})).finally((()=>{w.value=!1})))},submitStatusData(){_.value.validate()&&(w.value=!0,(0,ae.updateRoomSalesStatus)(a.Id,p[c.value].data).then((a=>{(0,ee.displayNotification)(a.data,"positive"),c.value=null,g.value=!1,h()})).catch((a=>{(0,ee.displayNotification)(a.response.data,"negative")})).finally((()=>{w.value=!1})))}}}});var le=t(1639),ue=t(9885),oe=t(2605),se=t(8052),de=t(8879),ne=t(926),ie=t(3246),me=t(490),re=t(1233),ce=t(3115),pe=t(6933),_e=t(4458),we=t(3190),ge=t(854),ve=t(8359),ye=t(2074),De=t(8326),fe=t(1663),be=t(1973),qe=t(651),he=t(8149),We=t(2765),xe=t(4351),ke=t(4581),Ve=t(6611),ze=t(1480),Se=t(9003),Pe=t(2146),Ue=t(9984),Re=t.n(Ue);const Ze=(0,le.Z)(te,[["render",La]]),Fe=Ze;Re()(te,"components",{QPage:ue.Z,QBreadcrumbs:oe.Z,QBreadcrumbsEl:se.Z,QBtn:de.Z,QSeparator:ne.Z,QList:ie.Z,QItem:me.Z,QItemSection:re.Z,QItemLabel:ce.Z,QMarkupTable:pe.Z,QCard:_e.Z,QCardSection:we.Z,QInnerLoading:ge.Z,QSpinnerIos:ve.Z,QDialog:ye.Z,QForm:De.Z,QToolbar:fe.Z,QToolbarTitle:be.Z,QExpansionItem:qe.Z,QField:he.Z,QPopupProxy:We.Z,QDate:xe.Z,QSelect:ke.Z,QInput:Ve.Z,QRadio:ze.Z,QSlideTransition:Se.Z}),Re()(te,"directives",{ClosePopup:Pe.Z})}}]);