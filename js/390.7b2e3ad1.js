"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[390],{390:(e,a,l)=>{l.r(a),l.d(a,{default:()=>R});var s=l(9835),o=l(6970);const t={class:"row justify-end"},i={class:"row q-gutter-x-sm"},n={class:"column q-col-gutter-y-md"};function r(e,a,l,r,d,u){const m=(0,s.up)("q-btn"),p=(0,s.up)("q-td"),c=(0,s.up)("q-table"),w=(0,s.up)("q-page"),b=(0,s.up)("q-toolbar-title"),g=(0,s.up)("q-toolbar"),f=(0,s.up)("q-field"),v=(0,s.up)("q-input"),y=(0,s.up)("q-card-section"),h=(0,s.up)("q-form"),_=(0,s.up)("q-card"),k=(0,s.up)("q-dialog"),q=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(w,{class:"q-ma-xl"},{default:(0,s.w5)((()=>[(0,s._)("div",t,[e.permissionRequired("auth","add_user")?((0,s.wg)(),(0,s.j4)(m,{key:0,rounded:"",color:"primary",label:"Create",to:{name:"UsersCreate"}})):(0,s.kq)("",!0)]),(0,s.Wm)(c,{flat:"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"Users","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No users available","loading-label":"Loading users..."},{"body-cell-actions":(0,s.w5)((a=>[(0,s.Wm)(p,{props:a},{default:(0,s.w5)((()=>[(0,s._)("div",i,[(0,s._)("div",null,[e.permissionRequired("auth","change_user")?((0,s.wg)(),(0,s.j4)(m,{key:0,round:"",unelevated:"",size:"sm",icon:"edit",color:"primary",to:{name:"UsersEdit",params:{Id:a.row.id}}},null,8,["to"])):(0,s.kq)("",!0)]),(0,s.Wm)(m,{"no-caps":"",rounded:"",outline:"",size:".8rem",color:"primary",label:"Reset Password",onClick:l=>e.showResetDialog(a.rowIndex)},null,8,["onClick"])])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])])),_:1}),(0,s.Wm)(k,{modelValue:e.resetPasswordDialog,"onUpdate:modelValue":a[2]||(a[2]=a=>e.resetPasswordDialog=a)},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{style:{maxWidth:"280px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{ref:"resetPasswordForm",onSubmit:e.submitPasswordReset},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bg-primary text-white"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Uk)("User Credentials")])),_:1}),(0,s.wy)((0,s.Wm)(m,{round:"",flat:"",icon:"close"},null,512),[[q]])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" User should use the details to login and change their password. Click submit below to complete password reset "),(0,s._)("div",n,[(0,s.Wm)(f,{"stack-label":"",label:"User Name"},{control:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(e.userData.username),1)])),_:1}),(0,s.Wm)(v,{"stack-label":"",label:"Password",type:e.passwordToggle?"password":"text",loading:e.submitting,modelValue:e.userData.password,"onUpdate:modelValue":a[1]||(a[1]=a=>e.userData.password=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},{append:(0,s.w5)((()=>[(0,s.Wm)(m,{flat:"",round:"",icon:e.passwordToggle?"visibility_off":"visibility",onClick:a[0]||(a[0]=a=>e.passwordToggle=!e.passwordToggle)},null,8,["icon"])])),after:(0,s.w5)((()=>[(0,s.Wm)(m,{flat:"",dense:"",round:"",icon:"refresh",onClick:e.createNewPassword},null,8,["onClick"])])),_:1},8,["type","loading","modelValue","rules"]),(0,s._)("div",null,[(0,s.Wm)(m,{"no-caps":"",unelevated:"",color:"grey",class:"full-width",label:"Copy Password",onClick:e.copyPassword},null,8,["onClick"])])])])),_:1}),(0,s.Wm)(y,{class:"row justify-center q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{"no-caps":"",rounded:"",color:"primary",label:"Submit",loading:e.submitting,type:"submit"},null,8,["loading"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var d=l(9302),u=l(5054),m=l(499),p=l(4019),c=l(8221);const w=[{name:"id",label:"#",field:"id",sortable:!0,align:"left"},{name:"username",label:"User Name",field:"username",sortable:!0,align:"left"},{name:"email",label:"Email",field:"email",sortable:!0,align:"left"},{name:"name",label:"Name",field:e=>`${e.first_name} ${e.last_name}`,classes:"text-capitalize",sortable:!0,align:"left"},{name:"department",label:"Department",field:e=>e.department.name,sortable:!0,align:"left"},{name:"account_type",label:"Account",field:e=>e.account_type.name,sortable:!0,align:"left"},{name:"actions",label:"Actions",align:"left"}],b=(0,s.aZ)({name:"UsersIndex ",setup(){const e=(0,d.Z)(),a=(0,m.iH)([]),l=(0,m.iH)(!1),o=(0,m.iH)({}),t=(0,m.iH)(!1),i=(0,m.iH)(!0),n=((0,m.iH)(!1),(0,m.iH)(null)),r=(0,m.iH)(!1);function b(){l.value=!0,(0,p.getUsers)().then((e=>{a.value=e.data})).catch((e=>{})).finally((()=>{l.value=!1}))}function g(){r.value=!0,(0,p.generateNewPassword)().then((e=>{o.value.password=e.data})).finally((()=>{r.value=!1}))}return(0,s.bv)((()=>{b()})),{loadingData:l,tableRows:a,tableColumns:w,userData:o,passwordToggle:i,createNewPassword:g,resetPasswordForm:n,resetPasswordDialog:t,submitting:r,copyPassword(){(0,u.Z)(o.value.password).then((()=>{e.notify({message:"Copied password to clipboard",position:"bottom"})}))},showResetDialog(e){let l={...a.value[e]};o.value={id:l.id,username:l.username},g(),t.value=!0},submitPasswordReset(){n.value.validate()&&(r.value=!0,(0,p.adminUpdateUserPassword)(o.value.id,{new_password:o.value.password}).then((e=>{(0,c.displayNotification)(e.data,"positive"),t.value=!1,n.value.resetValidation()})).catch((e=>{(0,c.displayNotification)(e.response.data,"negative")})).finally((()=>{r.value=!1})))}}}});var g=l(1639),f=l(9885),v=l(8879),y=l(7355),h=l(7220),_=l(2074),k=l(4458),q=l(8326),C=l(1663),P=l(1973),W=l(3190),Z=l(8149),U=l(6611),D=l(2146),Q=l(9984),T=l.n(Q);const x=(0,g.Z)(b,[["render",r]]),R=x;T()(b,"components",{QPage:f.Z,QBtn:v.Z,QTable:y.Z,QTd:h.Z,QDialog:_.Z,QCard:k.Z,QForm:q.Z,QToolbar:C.Z,QToolbarTitle:P.Z,QCardSection:W.Z,QField:Z.Z,QInput:U.Z}),T()(b,"directives",{ClosePopup:D.Z})}}]);