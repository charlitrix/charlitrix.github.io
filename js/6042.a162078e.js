"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[6042],{6042:(e,l,a)=>{a.r(l),a.d(l,{default:()=>F});var t=a(9835),o=a(6970);const n={class:"row q-mb-lg justify-between"},i={class:"row q-gutter-x-xl"},s={class:"row items-center q-gutter-x-md"},r={key:0,class:"text-grey-9 q-ml-sm"},u={key:1,class:"text-grey-9 q-ml-sm"},d={class:"row justify-end"},p={key:0,class:"text-grey-9 q-ml-sm"},m={key:1,class:"text-grey-9 q-ml-sm"},c={class:"row justify-end"},v={class:"row items-center"},g={id:"reportToPrint"},f={class:"column justify-center q-col-gutter-y-sm"};function b(e,l,a,b,w,D){const k=(0,t.up)("q-select"),h=(0,t.up)("q-form"),y=(0,t.up)("q-btn"),_=(0,t.up)("q-date"),q=(0,t.up)("q-popup-proxy"),W=(0,t.up)("q-field"),V=(0,t.up)("q-separator"),C=(0,t.up)("q-td"),S=(0,t.up)("q-table"),Z=(0,t.up)("q-spinner-ios"),P=(0,t.up)("q-inner-loading"),x=(0,t.up)("q-page"),H=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(x,{class:"q-pa-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",i,[(0,t._)("div",null,[(0,t.Wm)(h,{ref:"stockItemForm"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedStockOption,"onUpdate:modelValue":[l[0]||(l[0]=l=>e.selectedStockOption=l),e.stockOptionChanged],options:e.stockOptions,"lazy-rules":"ondemand",style:{minWidth:"150px"},rules:e.selectInputRequiredRules(e.stockValidOptions.map((e=>e.value)))},null,8,["modelValue","onUpdate:modelValue","options","rules"])])),_:1},512)]),(0,t._)("div",null,[(0,t.Wm)(k,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedFilter,"onUpdate:modelValue":[l[1]||(l[1]=l=>e.selectedFilter=l),e.filterOptionChanged],options:e.filterOptions},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,t._)("div",null,[(0,t._)("div",s,[(0,t.Wm)(W,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)(" From: "),e.fromDate?((0,t.wg)(),(0,t.iD)("span",r,(0,o.zw)(e.fromDate),1)):((0,t.wg)(),(0,t.iD)("span",u,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(y,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{ref:"fromDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:e.fromDate,"onUpdate:modelValue":[l[2]||(l[2]=l=>e.fromDate=l),e.fromDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t.wy)((0,t.Wm)(y,{flat:"",label:"Close",color:"primary"},null,512),[[H]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1}),(0,t.Wm)(W,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)("To: "),e.toDate?((0,t.wg)(),(0,t.iD)("span",p,(0,o.zw)(e.toDate),1)):((0,t.wg)(),(0,t.iD)("span",m,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(y,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{ref:"toDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:e.toDate,"onUpdate:modelValue":[l[3]||(l[3]=l=>e.toDate=l),e.toDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",c,[(0,t.wy)((0,t.Wm)(y,{flat:"",label:"Close",color:"primary"},null,512),[[H]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1})])])]),(0,t._)("div",v,[(0,t.Wm)(y,{unelevated:"",flat:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:l[4]||(l[4]=l=>e.printDocument("reportToPrint",e.printingSettings))}),(0,t.Wm)(V,{vertical:""}),(0,t.Wm)(y,{unelevated:"",flat:"","no-caps":"",icon:"file_download",color:"grey-9",label:"Download",onClick:l[5]||(l[5]=l=>e.printDocumentPDF("reportToPrint"))})])]),(0,t._)("div",null,[(0,t._)("div",g,[(0,t.Wm)(S,{flat:"",bordered:"",square:"","hide-pagination":"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No stock available","loading-label":"Loading stock..."},{"body-cell-units":(0,t.w5)((e=>[(0,t.Wm)(C,{props:e},{default:(0,t.w5)((()=>[(0,t._)("div",f,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.units_available_details,(e=>((0,t.wg)(),(0,t.iD)("div",{key:e.id},(0,o.zw)(e.quantity)+" "+(0,o.zw)(e.unit),1)))),128))])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])]),(0,t.Wm)(P,{label:"Please wait",showing:e.loadingData},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"50px",color:"primary"})])),_:1},8,["showing"])])])),_:1})}var w=a(9302),D=a(499),k=a(4019);a(8221);const h=(0,t.aZ)({name:"ReportsIndex",setup(){(0,w.Z)();const e=(0,D.iH)(!1),l=(0,D.iH)(),a=(0,D.iH)(),o=(0,D.iH)("1"),n=(0,D.iH)("?month"),i=(0,D.iH)("month"),s=[{label:"Select Period",value:null,disable:!0},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}],r=(0,D.iH)(""),u=(0,D.iH)(""),d=(0,D.iH)(null),p=[{label:"Kitchen",value:"kitchen"},{label:"Bar",value:"bar"},{label:"Restaurant",value:"restaurant"},{label:"Store",value:"store"}],m=[{label:"Select Item",value:null,disable:!0},...p],c=(0,D.iH)([]),v=(0,D.iH)(null),g=(0,D.iH)({});function f(){n.value=`?from_date=${r.value}&to_date=${u.value}`,h(),i.value=null}function b(e){return"kitchen"==e?(0,k.getKitchenReports)("/stock"+n.value):"bar"==e?(0,k.getBarReports)("/stock"+n.value):"restaurant"==e?(0,k.getRestaurantReports)("/stock"+n.value):"store"==e?(0,k.getStoreReports)("/stock"+n.value):new Promise(((e,l)=>{l()}))}function h(){v.value.validate().then((l=>{l&&(e.value=!0,c.value=[],b(d.value).then((e=>{c.value=e.data})).finally((()=>{e.value=!1})),v.value.resetValidation())}))}function y(){return(0,k.getGeneralSettings)("?name=PRINTERS").then((e=>{g.value=e.data.details["items"].find((e=>"rooms receipts"==e.item))||e.data.details["items"].find((e=>"receipts"==e.item))}))}return(0,t.bv)((()=>{y()})),{loadingData:e,toDateDialog:l,fromDateDialog:a,fromDate:r,toDate:u,tabs:o,selectedFilter:i,filterOptions:s,selectedStockOption:d,stockOptions:m,stockValidOptions:p,tableRows:c,stockItemForm:v,printingSettings:g,tableColumns:[{label:"Name",field:"name",align:"left",name:"name"},{label:"Units Available",align:"left",name:"units"},{label:"Total",align:"left",field:"units_available",name:"total"}],fromDateChanged(e,l,t){null!=r.value&&null!=u.value&&f(),a.value.hide()},toDateChanged(e,a,t){null!=r.value&&null!=u.value&&f(),l.value.hide()},filterOptionChanged(e){e&&(r.value=null,u.value=null,n.value=`?filter=${e}`,h())},stockOptionChanged(){null===n.value&&""==n.value||h()}}}});var y=a(1639),_=a(9885),q=a(8326),W=a(4581),V=a(8149),C=a(8879),S=a(2765),Z=a(4351),P=a(926),x=a(7355),H=a(7220),O=a(854),Q=a(8359),R=a(2146),T=a(9984),U=a.n(T);const Y=(0,y.Z)(h,[["render",b]]),F=Y;U()(h,"components",{QPage:_.Z,QForm:q.Z,QSelect:W.Z,QField:V.Z,QBtn:C.Z,QPopupProxy:S.Z,QDate:Z.Z,QSeparator:P.Z,QTable:x.Z,QTd:H.Z,QInnerLoading:O.Z,QSpinnerIos:Q.Z}),U()(h,"directives",{ClosePopup:R.Z})}}]);