"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[1084],{1084:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Ge});var a=t(9835),i=t(6970),s=t(1957);const u={class:"row justify-end q-gutter-x-lg"},n={class:"q-ma-lg q-column q-col-gutter-y-lg q-mb-xl"},o=(0,a._)("div",{class:"row justify-center text-h4"},"Purchase Order",-1),r={class:"text-italic"},d={class:"row"},p={class:"col-md-4"},m=(0,a._)("div",{class:"text-h5 q-mb-md"},"Supplier",-1),c={key:0},_=(0,a._)("th",{class:"text-left"},"#",-1),g=(0,a._)("th",{class:"text-left"},"Name",-1),w=(0,a._)("th",{class:"text-left"},"Specifications",-1),v=(0,a._)("th",{class:"text-left"},"Quantity",-1),h=(0,a._)("th",{class:"text-left"},"Units",-1),y=(0,a._)("th",{class:"text-left"},"Payment Terms",-1),f=(0,a._)("th",{class:"text-left"},"Rate",-1),q=(0,a._)("th",{class:"text-left"},"Total (Ugx)",-1),D=(0,a._)("th",{class:"text-left"},"Status",-1),k={key:0,style:{paddingRight:"0px !important"}},b={class:"row"},x={class:"text-capitalize"},W={class:"text-weight-bold"},R=["colspan"],I={class:"q-pt-xl"},S={class:"row q-gutter-x-xl justify-between"},P={class:"col-md-4 column q-gutter-y-lg"},V=(0,a._)("div",{class:"text-weight-bold"},"Requested By:",-1),z={class:"q-pb-xs text-center",style:{borderBottom:"2px dotted black"}},C={class:"col-md-4 column q-gutter-y-lg"},U=(0,a._)("div",{class:"text-weight-bold"},"Approved By:",-1),E={class:"q-pb-xs text-center",style:{borderBottom:"2px dotted black"}},N={key:0},H={key:1},Q={class:"q-pt-lg"},Z=(0,a._)("div",{class:"text-weight-bold q-mb-md"},"Comments:",-1),A={class:"row q-gutter-x-lg"},O={class:"col"},T={class:"col-auto self-end"},F={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg q-mt-sm"},L={class:"row q-gutter-x-lg"},j=(0,a._)("th",null,null,-1),B={colspan:"2"},G={class:"column"},Y={class:"text-weight-regular"},K={class:"text-weight-regular"},M={colspan:"2"},$={class:"column"},J={key:0,class:"text-weight-regular"},X=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th"),(0,a._)("th",{class:"text-left"},"#"),(0,a._)("th",{class:"text-left"},"Name"),(0,a._)("th",{class:"text-left"},"Quantity"),(0,a._)("th",{class:"text-left"},"Rate"),(0,a._)("th",{class:"text-left"},"Total (Ugx)")])],-1),ee={style:{width:"50px !important"}},le={class:"text-weight-bold"},te=(0,a._)("td",{colspan:"4",class:"text-right"},"Total",-1),ae=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"#"),(0,a._)("th",null,"Name"),(0,a._)("th",null,"Specifications"),(0,a._)("th",null,"Quantity"),(0,a._)("th",null,"Units"),(0,a._)("th",null,"Payment Terms"),(0,a._)("th",null,"Rate"),(0,a._)("th",null,"Total (Ugx)")])],-1),ie={class:"row items-center"},se={class:"text-weight-bold"},ue=(0,a._)("td",{colspan:"7",class:"text-right"},"Total",-1),ne={class:"q-mx-lg q-mb-lg q-mt-sm"},oe={class:"row q-my-lg q-gutter-x-lg items-center"},re={class:"q-column q-col-gutter-y-md q-mx-lg q-mb-lg"},de=(0,a._)("div",{class:"text-h5"},"Add Supplier",-1);function pe(e,l,t,pe,me,ce){const _e=(0,a.up)("q-btn"),ge=(0,a.up)("q-btn-group"),we=(0,a.up)("q-item-section"),ve=(0,a.up)("q-item"),he=(0,a.up)("q-list"),ye=(0,a.up)("q-toggle"),fe=(0,a.up)("q-markup-table"),qe=(0,a.up)("q-input"),De=(0,a.up)("q-spinner-ios"),ke=(0,a.up)("q-inner-loading"),be=(0,a.up)("q-page"),xe=(0,a.up)("q-toolbar-title"),We=(0,a.up)("q-toolbar"),Re=(0,a.up)("q-select"),Ie=(0,a.up)("q-form"),Se=(0,a.up)("q-card"),Pe=(0,a.up)("q-dialog"),Ve=(0,a.up)("q-separator"),ze=(0,a.up)("q-checkbox"),Ce=(0,a.up)("q-stepper-navigation"),Ue=(0,a.up)("q-step"),Ee=(0,a.up)("q-stepper"),Ne=(0,a.up)("q-card-section"),He=(0,a.up)("q-card-actions"),Qe=(0,a.up)("q-slide-transition"),Ze=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(be,{class:"q-pa-xl"},{default:(0,a.w5)((()=>[(0,a._)("div",u,[e.permissionRequired("procurement","change_purchaseorder")?((0,a.wg)(),(0,a.j4)(_e,{key:0,"no-caps":"",rounded:"",label:"Edit Supplier",color:"primary",onClick:e.showSupplierEditDialog,disable:"APPROVED"==e.pageData.status||"CLEARED"==e.pageData.status},null,8,["onClick","disable"])):(0,a.kq)("",!0),e.permissionRequired("procurement","add_purchaseitem")?((0,a.wg)(),(0,a.j4)(_e,{key:1,"no-caps":"",rounded:"",label:"Add Items",color:"primary",onClick:l[0]||(l[0]=l=>e.addRequisitionsDialog=!e.addRequisitionsDialog),disable:"APPROVED"==e.pageData.status||"CLEARED"==e.pageData.status},null,8,["disable"])):(0,a.kq)("",!0),e.permissionRequired("procurement","change_purchaseorder")?((0,a.wg)(),(0,a.j4)(ge,{key:2},{default:(0,a.w5)((()=>["PENDING"==e.pageData.status?((0,a.wg)(),(0,a.j4)(_e,{key:0,label:"Approve",color:"primary",onClick:e.approvePurchaseOrder},null,8,["onClick"])):(0,a.kq)("",!0),"PENDING"==e.pageData.status?((0,a.wg)(),(0,a.j4)(_e,{key:1,label:"Decline",color:"red",onClick:e.declinePurchaseOrder},null,8,["onClick"])):(0,a.kq)("",!0),(0,a.Wm)(_e,{label:"Clear",color:"grey-7",onClick:e.clearPurchaseOrder},null,8,["onClick"])])),_:1})):(0,a.kq)("",!0)]),(0,a._)("div",n,[o,(0,a._)("div",r,"No. "+(0,i.zw)(e.id),1),(0,a._)("div",null,[(0,a._)("div",d,[(0,a._)("div",p,[m,(0,a.Wm)(he,{dense:""},{default:(0,a.w5)((()=>[(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Code:")])),_:1}),e.requisitionSupplierData.id?((0,a.wg)(),(0,a.j4)(we,{key:0},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.requisitionSupplierData.id),1)])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Name:")])),_:1}),(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.requisitionSupplierData.name),1)])),_:1})])),_:1}),(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Contact:")])),_:1}),(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.requisitionSupplierData.contact),1)])),_:1})])),_:1}),(0,a.Wm)(ve,null,{default:(0,a.w5)((()=>[(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Address:")])),_:1}),(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.requisitionSupplierData.address),1)])),_:1})])),_:1})])),_:1})])])]),(0,a._)("div",null,[(0,a.Wm)(fe,{bordered:"",flat:"",square:"",separator:"cell"},{default:(0,a.w5)((()=>[(0,a._)("thead",null,[(0,a._)("tr",null,["PENDING"==e.pageData.status?((0,a.wg)(),(0,a.iD)("th",c)):(0,a.kq)("",!0),_,g,w,v,h,y,f,q,D])]),(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.itemsList,((l,t)=>((0,a.wg)(),(0,a.iD)("tr",{key:t},["PENDING"==e.pageData.status?((0,a.wg)(),(0,a.iD)("td",k,[(0,a._)("div",b,[e.permissionRequired("procurement","change_purchaseitem")?((0,a.wg)(),(0,a.j4)(_e,{key:0,flat:"",round:"",dense:"",size:"sm",icon:"edit",color:"primary",onClick:l=>e.showEditPurchaseItemDialog(t)},null,8,["onClick"])):(0,a.kq)("",!0),e.permissionRequired("procurement","delete_purchaseitem")?((0,a.wg)(),(0,a.j4)(_e,{key:1,flat:"",round:"",dense:"",size:"sm",icon:"delete",color:"red",onClick:t=>e.showDeletePurchaseItemDialog(l.id)},null,8,["onClick"])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),(0,a._)("td",null,(0,i.zw)(l.code),1),(0,a._)("td",null,(0,i.zw)(l.name),1),(0,a._)("td",null,(0,i.zw)(l.specifications),1),(0,a._)("td",null,(0,i.zw)(l.quantity),1),(0,a._)("td",null,(0,i.zw)(l.unit),1),(0,a._)("td",null,(0,i.zw)(l.payment_terms),1),(0,a._)("td",null,(0,i.zw)(e.formatPrice(l.unit_price)),1),(0,a._)("td",null,(0,i.zw)(e.formatPrice(l.unit_price*l.quantity)),1),(0,a._)("td",null,[e.permissionRequired("procurement","change_purchaseitem")?(0,a.wy)(((0,a.wg)(),(0,a.j4)(ye,{key:0,"model-value":l.status,size:"md","true-value":"CLEARED","false-value":"PENDING","checked-icon":"check","unchecked-icon":"remove",color:"CLEARED"==l.status?"green":"red",onClick:t=>e.showUpdateItemDialog(l.id,"CLEARED"==l.status?"PENDING":"CLEARED")},null,8,["model-value","color","onClick"])),[[s.F8,"APPROVED"==e.pageData.status]]):(0,a.kq)("",!0),(0,a._)("span",x,(0,i.zw)(l.status),1)])])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",W,[(0,a._)("td",{colspan:"PENDING"==e.pageData.status?8:7,class:"text-right"}," Total ",8,R),(0,a._)("td",null,(0,i.zw)(e.formatPrice(e.total)),1)])])])),_:1}),(0,a._)("div",I,[(0,a._)("div",S,[(0,a._)("div",P,[V,(0,a._)("div",z,(0,i.zw)(e.pageData.requester),1)]),(0,a._)("div",C,[U,(0,a._)("div",E,[e.pageData.approver?((0,a.wg)(),(0,a.iD)("span",N,(0,i.zw)(e.pageData.approver),1)):((0,a.wg)(),(0,a.iD)("span",H,"-"))])])])]),(0,a._)("div",Q,[Z,(0,a._)("div",A,[(0,a._)("div",O,[(0,a.Wm)(qe,{outlined:"",type:"textarea",rows:"5"})]),(0,a._)("div",T,[(0,a.Wm)(_e,{rounded:"",label:"Submit",color:"primary"})])])])])]),(0,a.Wm)(ke,{showing:e.loadingData},{default:(0,a.w5)((()=>[(0,a.Wm)(De,{size:"50px",color:"primary"})])),_:1},8,["showing"])])),_:1}),(0,a.Wm)(Pe,{modelValue:e.newItemDialog,"onUpdate:modelValue":l[6]||(l[6]=l=>e.newItemDialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(Se,{style:{width:"650px",maxWidth:"650px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Ie,{ref:"newItemForm",onSubmit:e.submitEditPurchaseItem},{default:(0,a.w5)((()=>[(0,a.Wm)(We,{class:"bg-primary text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(xe,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Update Item")])),_:1}),(0,a.wy)((0,a.Wm)(_e,{flat:"",round:"",size:"md",icon:"close",onClick:e.clearForm},null,8,["onClick"]),[[Ze]])])),_:1}),(0,a._)("div",F,[(0,a.Wm)(Re,{dense:"",outlined:"",options:e.paymentTermsDataList,style:{minWidth:"80px"},modelValue:e.purchaseItemData.payment_terms,"onUpdate:modelValue":l[1]||(l[1]=l=>e.purchaseItemData.payment_terms=l),"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.paymentTermsDataList),class:"q-pb-none"},null,8,["options","modelValue","rules"]),(0,a.Wm)(qe,{label:"Specifications",modelValue:e.purchaseItemData.specifications,"onUpdate:modelValue":l[2]||(l[2]=l=>e.purchaseItemData.specifications=l),type:"textarea",rows:"3","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,a._)("div",L,[(0,a.Wm)(qe,{label:"Quantity",type:"number",modelValue:e.purchaseItemData.quantity,"onUpdate:modelValue":l[3]||(l[3]=l=>e.purchaseItemData.quantity=l),"lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,a.Wm)(qe,{label:"Price",type:"number",modelValue:e.purchaseItemData.unit_price,"onUpdate:modelValue":l[4]||(l[4]=l=>e.purchaseItemData.unit_price=l),"lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,a.Wm)(qe,{label:"Unit",modelValue:e.purchaseItemData.unit,"onUpdate:modelValue":l[5]||(l[5]=l=>e.purchaseItemData.unit=l),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"])]),(0,a._)("div",null,[(0,a.Wm)(_e,{rounded:"","no-caps":"",type:"submit",class:"full-width",label:"Update",color:"primary",loading:e.loadingData},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(Pe,{modelValue:e.addRequisitionsDialog,"onUpdate:modelValue":l[11]||(l[11]=l=>e.addRequisitionsDialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(Se,{style:{minWidth:"850px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Ie,{ref:"requisitionItemsForm",onSubmit:e.submitRequisitionItems},{default:(0,a.w5)((()=>[(0,a.Wm)(We,{class:"bg-primary text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(xe,null,{default:(0,a.w5)((()=>[(0,a.Uk)("New Items")])),_:1}),(0,a.wy)((0,a.Wm)(_e,{flat:"",round:"",size:"md",icon:"close",onClick:e.clearForm},null,8,["onClick"]),[[Ze]])])),_:1}),(0,a.Wm)(Ne,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ee,{modelValue:e.step,"onUpdate:modelValue":l[10]||(l[10]=l=>e.step=l),animated:"",color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(Ue,{name:1,title:"Requisition Items",icon:"edit",done:e.step>1},{default:(0,a.w5)((()=>[(0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.approvedRequisitions,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"q-mb-lg",key:t.id},[(0,a.Wm)(fe,{"wrap-cells":"",dense:"",bordered:"",flat:"",square:"",separator:"cell"},{default:(0,a.w5)((()=>[(0,a._)("thead",null,[(0,a._)("tr",null,[j,(0,a._)("th",null,"Requisition # "+(0,i.zw)(t.id),1),(0,a._)("th",B,[(0,a._)("div",G,[(0,a._)("div",null,[(0,a.Uk)(" Requested By: "),(0,a._)("span",Y,(0,i.zw)(t.requester),1)]),(0,a.Wm)(Ve),(0,a._)("div",null,[(0,a.Uk)(" Approved By: "),(0,a._)("span",K,(0,i.zw)(t.approver),1)])])]),(0,a._)("th",M,[(0,a._)("div",$,[(0,a._)("div",null,[(0,a.Uk)(" Supplier: "),t.supplier.id?((0,a.wg)(),(0,a.iD)("span",J," # "+(0,i.zw)(t.supplier.id)+" "+(0,i.zw)(t.supplier.name),1)):(0,a.kq)("",!0)])])])])]),X,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.items,(s=>((0,a.wg)(),(0,a.iD)("tr",{key:s.id},[(0,a._)("td",ee,[(0,a.Wm)(ze,{dense:"",modelValue:e.selectedRequisitions,"onUpdate:modelValue":l[7]||(l[7]=l=>e.selectedRequisitions=l),val:t.id+"-"+s.id},null,8,["modelValue","val"])]),(0,a._)("td",null,(0,i.zw)(s.code),1),(0,a._)("td",null,(0,i.zw)(s.name),1),(0,a._)("td",null,(0,i.zw)(s.quantity),1),(0,a._)("td",null,(0,i.zw)(e.formatPrice(s.unit_price)),1),(0,a._)("td",null,(0,i.zw)(e.formatPrice(s.quantity*s.unit_price)),1)])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",le,[te,(0,a._)("td",null,(0,i.zw)(e.formatPrice(e.itemsProductSum(t.items,"quantity","unit_price"))),1)])])])),_:2},1024)])))),128))]),(0,a.Wm)(Ce,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_e,{onClick:l[8]||(l[8]=l=>e.step=2),color:"primary",label:"continue",class:"q-px-xl",disable:0==e.selectedRequisitionsDetails.length},null,8,["disable"])])),_:1})])),_:1},8,["done"]),(0,a.Wm)(Ue,{name:2,title:"Items Selected",icon:"assignment"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(fe,{"wrap-cells":"",bordered:"",flat:"",square:"",separator:"cell"},{default:(0,a.w5)((()=>[ae,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.selectedRequisitionsDetails,((l,t)=>((0,a.wg)(),(0,a.iD)("tr",{key:t},[(0,a._)("td",null,(0,i.zw)(l.code),1),(0,a._)("td",null,(0,i.zw)(l.name),1),(0,a._)("td",null,(0,i.zw)(l.specifications),1),(0,a._)("td",null,(0,i.zw)(l.quantity),1),(0,a._)("td",null,(0,i.zw)(l.unit),1),(0,a._)("td",null,[(0,a._)("div",ie,[(0,a.Wm)(Re,{dense:"",outlined:"",options:e.paymentTermsDataList,style:{minWidth:"80px"},modelValue:l.payment_terms,"onUpdate:modelValue":e=>l.payment_terms=e,"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.paymentTermsDataList),class:"q-pb-none"},null,8,["options","modelValue","onUpdate:modelValue","rules"])])]),(0,a._)("td",null,(0,i.zw)(e.formatPrice(l.unit_price)),1),(0,a._)("td",null,(0,i.zw)(e.formatPrice(l.unit_price*l.quantity)),1)])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",se,[ue,(0,a._)("td",null,(0,i.zw)(e.formatPrice(e.itemsProductSum(e.selectedRequisitionsDetails,"unit_price","quantity"))),1)])])])),_:1})]),(0,a.Wm)(Ce,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_e,{onClick:l[9]||(l[9]=l=>e.step=1),color:"primary",label:"Back",class:"q-px-xl q-ml-md"})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(He,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_e,{rounded:"",color:"primary",label:"Add",class:"full-width",disable:2!=e.step,type:"submit",loading:e.loadingData},null,8,["disable","loading"])])),_:1})])),_:1},8,["onSubmit"]),(0,a.Wm)(ke,{showing:e.loadingRequisitions},{default:(0,a.w5)((()=>[(0,a.Wm)(De,{size:"50px",color:"primary"})])),_:1},8,["showing"])])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(Pe,{modelValue:e.addSupplierDialog,"onUpdate:modelValue":l[17]||(l[17]=l=>e.addSupplierDialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(Se,{style:{width:"650px",maxWidth:"650px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(We,{class:"bg-primary text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(xe,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Suppliers")])),_:1}),(0,a.wy)((0,a.Wm)(_e,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Ze]])])),_:1}),(0,a._)("div",ne,[(0,a._)("div",oe,[(0,a._)("div",null,[(0,a.Wm)(Re,{clearable:"",label:"Suppliers","option-label":"name",options:e.suppliersDataList,style:{minWidth:"250px"},modelValue:e.selectedSupplier,"onUpdate:modelValue":l[12]||(l[12]=l=>e.selectedSupplier=l),"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.suppliersDataList),loading:e.loadingSuppliersData,ref:"supplierSelected"},{option:(0,a.w5)((e=>[(0,a.Wm)(ve,(0,i.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(we,{side:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.opt.id),1)])),_:2},1024),(0,a.Wm)(we,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.opt.name),1)])),_:2},1024)])),_:2},1040)])),_:1},8,["options","modelValue","rules","loading"])]),(0,a._)("div",null,[(0,a.Wm)(_e,{round:"",color:e.showSupplierForm?"red":"primary",icon:"add",class:(0,i.C_)([e.showSupplierForm?"rotate-45":""]),onClick:l[13]||(l[13]=l=>e.showSupplierForm=!e.showSupplierForm)},null,8,["color","class"])])]),(0,a.Wm)(Qe,null,{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",null,[(0,a._)("div",re,[de,(0,a.Wm)(qe,{modelValue:e.supplierData.name,"onUpdate:modelValue":l[14]||(l[14]=l=>e.supplierData.name=l),label:"Name","lazy-rules":!0,rules:e.textInputRequiredRules(),ref:"supplierName"},null,8,["modelValue","rules"]),(0,a.Wm)(qe,{modelValue:e.supplierData.contact,"onUpdate:modelValue":l[15]||(l[15]=l=>e.supplierData.contact=l),label:"Contact","lazy-rules":!0,rules:e.textInputRequiredRules(),ref:"supplierContact",mask:"phone","unmasked-value":""},null,8,["modelValue","rules"]),(0,a.Wm)(qe,{modelValue:e.supplierData.address,"onUpdate:modelValue":l[16]||(l[16]=l=>e.supplierData.address=l),label:"Address","lazy-rules":!0,rules:e.textInputRequiredRules(),ref:"supplierAddress"},null,8,["modelValue","rules"])])],512),[[s.F8,e.showSupplierForm]])])),_:1}),(0,a._)("div",null,[(0,a.Wm)(_e,{rounded:"","no-caps":"",type:"submit",class:"full-width",label:"Update",color:"primary",onClick:e.setSupplier,loading:e.loadingData},null,8,["onClick","loading"])])])])),_:1})])),_:1},8,["modelValue"])],64)}t(9665);var me=t(4019),ce=t(8221),_e=t(9302),ge=t(499);const we=(0,a.aZ)({name:"RequisitionDetails",props:["id"],setup(e){const l=(0,_e.Z)(),t=(0,ge.iH)({}),i=(0,ge.iH)(!1),s=(0,ge.iH)(!1),u=(0,ge.iH)(null),n=(0,ge.iH)({}),o=(0,ge.iH)({}),r=(0,ge.iH)([]),d=(0,a.Fl)((()=>r.value.reduce(((e,l)=>e+l.quantity*l.unit_price),0))),p=(0,ge.iH)(!1),m=(0,ge.iH)({name:"",contact:"",address:""}),c=(0,ge.iH)(null),_=(0,ge.iH)(null),g=(0,ge.iH)(!1),w=(0,ge.iH)(!1),v=(0,ge.iH)([]),h=(0,ge.iH)(null),y=(0,ge.iH)(null),f=(0,ge.iH)(null),q=(0,ge.iH)(null),D=(0,ge.iH)(null),k=(0,ge.iH)({}),b=(0,ge.iH)(!1),x=(0,ge.iH)([]),W=(0,ge.iH)(!1),R=(0,ge.iH)([]),I=(0,ge.iH)([]),S=(0,ge.iH)(1),P=(0,ge.iH)(null);function V(){n.value={}}function z(){I.value=[],R.value.length>0&&R.value.forEach((e=>{let l=e.split("-"),t=x.value.find((e=>e.id==parseInt(l[0]))),a={...t.items.find((e=>e.id==parseInt(l[1])))},i=a.id;delete a.id,I.value.push({...a,requisition_id:t.id,payment_terms:"",item_id:i})}))}function C(){return i.value=!0,(0,me.getPurchaseOrder)(`/${e.id}`).then((e=>{t.value=e.data,o.value=t.value.supplier&&""!==t.value.supplier?t.value.supplier:{},r.value=t.value.items})).finally((()=>{i.value=!1}))}function U(){return w.value=!0,(0,me.getSuppliers)().then((e=>{v.value=e.data})).finally((()=>{w.value=!1}))}function E(){l.dialog({title:"Confirm",message:"Please confirm?",cancel:!0}).onOk((()=>{i.value=!0,(0,me.editPurchaseOrder)(e.id,k.value).then((e=>{k.value={},l.notify({type:"positive",message:e.data}),C()})).catch((e=>{l.notify({type:"negative",message:e.response.data.length<1e3?e.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1}))}))}function N(){return W.value=!0,(0,me.getRequisition)("?status=APPROVED").then((e=>{x.value=e.data,x.value=x.value.map((e=>({...e,items:e.requisition_items.map((e=>({...e,selected:!1})))})))})).finally((()=>{W.value=!1}))}return(0,a.bv)((()=>{C().then((()=>{U().then((()=>{N()}))}))})),(0,a.m0)((()=>{z()})),{pageData:t,loadingData:i,newItemDialog:s,newItemForm:u,purchaseItemData:n,requisitionSupplierData:o,itemsList:r,total:d,showSupplierForm:p,supplierData:m,selectedSupplier:c,clearForm:V,addSupplierDialog:g,addSupplierForm:_,loadingSuppliersData:w,suppliersDataList:v,supplierName:h,supplierContact:y,supplierAddress:f,supplierSelected:q,requisitionForm:D,addRequisitionsDialog:b,approvedRequisitions:x,loadingRequisitions:W,selectedRequisitions:R,selectedRequisitionsDetails:I,step:S,paymentTermsDataList:["Cash","Credit"],requisitionItemsForm:P,setSupplier(){p.value&&h.value.validate()&&y.value.validate()&&f.value.validate()?(i.value=!0,(0,me.updatePurchaseOrderSupplier)(e.id,{...m.value}).then((e=>{l.notify({type:"positive",message:e.data}),m.value={name:"",contact:"",address:""},h.value.resetValidation(),y.value.resetValidation(),f.value.resetValidation(),g.value=!1,C()})).catch((e=>{l.notify({type:"negative",message:e.response.data.length<1e3?e.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1}))):q.value.validate()&&(i.value=!0,updateRequisitionSupplier(e.id,{...c.value}).then((e=>{l.notify({type:"positive",message:e.data}),q.value.resetValidation(),g.value=!1,C()})).catch((e=>{l.notify({type:"negative",message:e.response.data.length<1e3?e.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1})))},submitEditPurchaseItem(){u.value.validate()&&l.dialog({title:"Confirm",message:"Please confirm?",cancel:!0}).onOk((()=>{i.value=!0;let e={...n.value},l=e.id;delete e.id,(0,me.editPurchaseItem)(l,e).then((e=>{n.value={},u.value.resetValidation(),s.value=!1,(0,ce.displayNotification)(e.data,"positive"),C()})).catch((e=>{(0,ce.displayNotification)(e.response.data,"negative")})).finally((()=>{i.value=!1}))}))},showEditPurchaseItemDialog(e){n.value={...r.value[e]},delete n.value.code,delete n.value.name,s.value=!0},showDeletePurchaseItemDialog(e){l.dialog({title:"Confirm",message:"Please confirm?",cancel:!0}).onOk((()=>{i.value=!0,(0,me.deletePurchaseItem)(e).then((e=>{l.notify({type:"positive",message:e.data}),C()})).catch((e=>{l.notify({type:"negative",message:e.response.data.length<1e3?e.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1}))}))},showSupplierEditDialog(){t.value.supplier&&t.value.supplier.id&&(c.value=t.value.supplier),g.value=!0},approvePurchaseOrder(){k.value={status:"APPROVED"},E()},clearPurchaseOrder(){k.value={status:"PENDING"},E()},declinePurchaseOrder(){l.dialog({title:"Reason",prompt:{type:"textarea",rows:"3",isValid:(0,ce.minimumRequiredRules)(20)[0]},cancel:!0}).onOk((e=>{k.value={status:"DECLINED",declined_reason:e},E()}))},showUpdateItemDialog(e,t){l.dialog({title:"Confirm",message:"Please confirm",cancel:!0}).onOk((()=>{(0,me.updatePurchaseItemStatus)(e,{status:t}).then((e=>{(0,ce.displayNotification)(e.data,"green"),C()})).catch((e=>{(0,ce.displayNotification)(e.response.data,"red")}))}))},submitRequisitionItems(){l.dialog({title:"Confirm",message:"Please confirm",cancel:!0}).onOk((()=>{P.value.validate()&&(i.value=!0,(0,me.createPurchaseItem)(e.id,I.value).then((e=>{R.value=[],(0,ce.displayNotification)(e.data,"positive"),P.value.resetValidation(),b.value=!1,C()})).catch((e=>{(0,ce.displayNotification)(e.response.data,"negative")})).finally((()=>{i.value=!1})))}))}}}});var ve=t(1639),he=t(9885),ye=t(8879),fe=t(7236),qe=t(3246),De=t(490),ke=t(1233),be=t(6933),xe=t(3175),We=t(6611),Re=t(854),Ie=t(8359),Se=t(2074),Pe=t(4458),Ve=t(8326),ze=t(1663),Ce=t(1973),Ue=t(4581),Ee=t(3190),Ne=t(8225),He=t(6017),Qe=t(926),Ze=t(1221),Ae=t(1992),Oe=t(1821),Te=t(9003),Fe=t(2146),Le=t(9984),je=t.n(Le);const Be=(0,ve.Z)(we,[["render",pe]]),Ge=Be;je()(we,"components",{QPage:he.Z,QBtn:ye.Z,QBtnGroup:fe.Z,QList:qe.Z,QItem:De.Z,QItemSection:ke.Z,QMarkupTable:be.Z,QToggle:xe.Z,QInput:We.Z,QInnerLoading:Re.Z,QSpinnerIos:Ie.Z,QDialog:Se.Z,QCard:Pe.Z,QForm:Ve.Z,QToolbar:ze.Z,QToolbarTitle:Ce.Z,QSelect:Ue.Z,QCardSection:Ee.Z,QStepper:Ne.Z,QStep:He.Z,QSeparator:Qe.Z,QCheckbox:Ze.Z,QStepperNavigation:Ae.Z,QCardActions:Oe.Z,QSlideTransition:Te.Z}),je()(we,"directives",{ClosePopup:Fe.Z})}}]);