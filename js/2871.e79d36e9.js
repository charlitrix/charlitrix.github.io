"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[2871],{2871:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Zt});var l=a(9835),u=a(6970);const s={class:"row justify-around text-weight-bold q-mt-md items-center"},o={class:"row no-wrap"},n={key:1,class:"q-ml-sm"},i={class:"row no-wrap"},d={class:"col-md-4 column"},m={class:"row items-center q-col-gutter-x-xl"},r=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Customer Details",-1),c={key:0},p={class:"col-md-7"},_=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Services",-1),w=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Name"),(0,l._)("th",null,"Amount"),(0,l._)("th",null,"Quantity"),(0,l._)("th",null,"Total")])],-1),g={class:"row q-mt-md"},v={class:"col-7"},y=(0,l._)("div",{class:"text-weight-bold q-mb-md"},"Payments",-1),D=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Amount"),(0,l._)("th",null,"Mode of payment"),(0,l._)("th",null,"Details"),(0,l._)("th",null,"Date")])],-1),f={key:0},b=(0,l._)("span",null," - ",-1),h={key:0},q=(0,l._)("td",{colspan:"100%",class:"text-grey-10"}," No payments available ... ",-1),W=[q],x={key:0,class:"col-3 q-px-xl"},k=(0,l._)("div",{class:"text-weight-bold"},"Invoice",-1),V={class:"q-mt-md"},S={class:"print-only"},z={id:"orderReceiptPrintOut"},P={class:"q-px-lg q-pt-xl q-mb-lg"},U={class:"row q-mb-sm"},Z=(0,l._)("div",{class:"col-3"},"Name:",-1),O={class:"col"},F={class:"row"},C=(0,l._)("div",{class:"col-3"},"Transaction:",-1),Q={class:"col"},I=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Days"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Amount")])],-1),R={class:"text-weight-bold"},H=(0,l._)("td",{colspan:"3",class:"text-right"},"Total",-1),Y={key:0,class:"text-center"},N={class:"text-weight-bold"},M=(0,l._)("td",{colspan:"3",class:"text-right"},"Paid",-1),E={class:"text-center"},T={class:"text-weight-bold"},A=(0,l._)("td",{colspan:"3",class:"text-right"},"Balance",-1),j={class:"text-center"},B=(0,l._)("div",{class:"q-py-md"},null,-1),L={class:"column q-col-gutter-y-sm q-mt-sm q-mx-lg q-mb-xl"},K={class:"q-mb-md"},G={class:"row justify-end"},$={class:"q-px-lg q-pt-lg"},J={class:"column"},X={key:0,class:"q-px-lg"},ee={class:"q-pt-md"},te={style:{minWidth:"100%",width:"100%"}},ae={class:"q-px-lg q-pt-xl q-mb-lg"},le={class:"row q-mb-sm"},ue=(0,l._)("div",{class:"col-3"},"Name:",-1),se={class:"col"},oe={class:"row"},ne=(0,l._)("div",{class:"col-3"},"Transaction:",-1),ie={class:"col"},de=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Item"),(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Amount"),(0,l._)("th",null,"Total")])],-1),me={class:"text-weight-bold"},re=(0,l._)("td",{colspan:"3",class:"text-right"},"Total",-1),ce={key:0,class:"text-center"},pe={class:"text-weight-bold"},_e=(0,l._)("td",{colspan:"3",class:"text-right"},"Paid",-1),we={class:"text-center"},ge={class:"text-weight-bold"},ve=(0,l._)("td",{colspan:"3",class:"text-right"},"Balance",-1),ye={class:"text-center"},De={class:"q-px-md"},fe=(0,l._)("div",{class:"q-py-md"},null,-1),be={class:"row items-center q-col-gutter-x-lg"},he=(0,l._)("div",{class:"col-3 text-right"},"Name:",-1),qe={class:"col-8"},We={class:"row items-center q-col-gutter-x-lg"},xe=(0,l._)("div",{class:"col-3 text-right"},"Contact:",-1),ke={class:"col-8"},Ve={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Se=(0,l._)("div",{class:"col-3 text-right"},"Address:",-1),ze={class:"col-8"},Pe={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ue=(0,l._)("div",{class:"col-3 text-right"},"ID:",-1),Ze={class:"col-8"},Oe={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Fe=(0,l._)("div",{class:"col-3 text-right"},"Nationality:",-1),Ce={class:"col-8"},Qe={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ie=(0,l._)("div",{class:"col-3 text-right"},"District:",-1),Re={class:"col-8"},He={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ye=(0,l._)("div",{class:"col-3 text-right"},"Occupation:",-1),Ne={class:"col-8"},Me={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ee=(0,l._)("div",{class:"col-3 text-right"},"Organisation:",-1),Te={class:"col-8"},Ae={class:"q-pt-lg"};function je(e,t,a,q,je,Be){const Le=(0,l.up)("q-breadcrumbs-el"),Ke=(0,l.up)("q-breadcrumbs"),Ge=(0,l.up)("q-btn"),$e=(0,l.up)("q-separator"),Je=(0,l.up)("q-item-label"),Xe=(0,l.up)("q-item-section"),et=(0,l.up)("q-item"),tt=(0,l.up)("q-list"),at=(0,l.up)("q-markup-table"),lt=(0,l.up)("q-card-section"),ut=(0,l.up)("q-card"),st=(0,l.up)("q-spinner-ios"),ot=(0,l.up)("q-inner-loading"),nt=(0,l.up)("q-page"),it=(0,l.up)("q-toolbar-title"),dt=(0,l.up)("q-toolbar"),mt=(0,l.up)("balance-calculator-component"),rt=(0,l.up)("q-expansion-item"),ct=(0,l.up)("q-date"),pt=(0,l.up)("q-popup-proxy"),_t=(0,l.up)("q-field"),wt=(0,l.up)("money-input-component"),gt=(0,l.up)("q-select"),vt=(0,l.up)("q-input"),yt=(0,l.up)("q-form"),Dt=(0,l.up)("q-dialog"),ft=(0,l.up)("q-radio"),bt=(0,l.up)("q-slide-transition"),ht=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(nt,{class:"q-mx-xl q-mb-lg q-mt-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(Ke,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Le,{to:{name:"RestaurantAndBarSales"}},{default:(0,l.w5)((()=>[(0,l.Uk)("Sales")])),_:1}),(0,l.Wm)(Le,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.Id),1)])),_:1})])),_:1}),(0,l._)("div",s,[(0,l._)("div",null,"Date: "+(0,u.zw)(e.pageData.date),1),(0,l._)("div",null,"Bill: "+(0,u.zw)(e.formatPrice(e.pageData.bill)),1),(0,l._)("div",null,"Paid: "+(0,u.zw)(e.formatPrice(e.pageData.paid)),1),(0,l._)("div",null,"Balance: "+(0,u.zw)(e.formatPrice(e.pageData.bill-e.pageData.paid)),1),(0,l._)("div",o,[e.pageData.bill===e.pageData.paid||"OPEN"!==e.pageData.status||e.pageData.invoice_id?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(Ge,{key:0,dense:"","no-caps":"",rounded:"",color:"primary",label:"Add Payment",class:"full-width q-px-md",onClick:t[0]||(t[0]=t=>e.addPaymentDialog=!e.addPaymentDialog)})),"CLOSED"!==e.pageData.status?((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(Ge,{dense:"","no-caps":"",rounded:"","no-wrap":"",color:"primary",label:"Update Status",class:"full-width q-px-md",onClick:t[1]||(t[1]=t=>e.updateStatusDialog=!e.updateStatusDialog)})])):(0,l.kq)("",!0)])]),(0,l.Wm)($e,{class:"q-my-sm bg-grey"}),(0,l.Wm)(Ge,{unelevated:"",dense:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:t[2]||(t[2]=t=>e.orderReceipt=!e.orderReceipt)}),(0,l._)("div",i,[(0,l._)("div",d,[(0,l._)("div",m,[r,"OPEN"===e.pageData.status?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(Ge,{round:"",size:"sm",color:"primary",icon:"edit",onClick:t[3]||(t[3]=t=>e.customerFormDialog=!e.customerFormDialog)})])):(0,l.kq)("",!0)]),(0,l.Wm)(tt,{dense:""},{default:(0,l.w5)((()=>[(0,l.Wm)(et,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Name :")])),_:1})])),_:1}),(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.name),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(et,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Contact :")])),_:1})])),_:1}),(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.contact),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(et,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)("ID :")])),_:1})])),_:1}),(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.identification_number),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(et,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Nationality :")])),_:1})])),_:1}),(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.nationality),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(et,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)("District :")])),_:1})])),_:1}),(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.district),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(et,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Occupation :")])),_:1})])),_:1}),(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.occupation),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(et,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Organisation :")])),_:1})])),_:1}),(0,l.Wm)(Xe,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Je,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.organisation),1)])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l.Wm)($e,{class:"q-mx-md",inset:"",vertical:""}),(0,l._)("div",p,[_,(0,l.Wm)(at,{flat:"",bordered:"","wrap-cells":"",separator:"vertical"},{default:(0,l.w5)((()=>[w,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.itemsData,((t,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:a},[(0,l._)("td",null,(0,u.zw)(t.service_name),1),(0,l._)("td",null,(0,u.zw)(e.formatPrice(t.amount))+"("+(0,u.zw)(t.specification)+")",1),(0,l._)("td",null,(0,u.zw)(t.quantity),1),(0,l._)("td",null,(0,u.zw)(e.formatPrice(t.quantity*t.amount)),1)])))),128))])])),_:1})])]),(0,l._)("div",g,[(0,l._)("div",v,[y,(0,l.Wm)(at,{flat:"",bordered:"",separator:"vertical"},{default:(0,l.w5)((()=>[D,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.paymentsData,((t,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:a},[(0,l._)("td",null,(0,u.zw)(e.formatPrice(t.amount)),1),(0,l._)("td",null,(0,u.zw)(t.method),1),(0,l._)("td",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(t?.other_details),(e=>((0,l.wg)(),(0,l.iD)("div",{key:e},[e.startsWith("_")?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("span",f,[(0,l.Uk)((0,u.zw)(e),1),b,(0,l.Uk)((0,u.zw)(t?.other_details[e]),1)]))])))),128))]),(0,l._)("td",null,(0,u.zw)(t.date),1)])))),128)),e.paymentsData.length<1?((0,l.wg)(),(0,l.iD)("tr",h,W)):(0,l.kq)("",!0)])])),_:1})]),e.pageData.invoice_id?((0,l.wg)(),(0,l.iD)("div",x,[k,(0,l.Wm)($e,{class:"q-mt-sm"}),(0,l._)("div",V,[(0,l.Wm)(Ge,{outline:"",label:"invoice # "+e.pageData.invoice_id,"icon-right":"keyboard_arrow_right",color:"primary",to:{name:"InvoiceDetails",params:{id:e.pageData.invoice_id}}},null,8,["label","to"])])])):(0,l.kq)("",!0)]),(0,l._)("div",S,[(0,l._)("div",z,[(0,l.Wm)(ut,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l.Wm)(lt,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l._)("div",P,[(0,l._)("div",U,[Z,(0,l._)("div",O,(0,u.zw)(e.pageData.customer.name),1)]),(0,l._)("div",F,[C,(0,l._)("div",Q,(0,u.zw)(e.pageData.id),1)])]),(0,l.Wm)(at,{"wrap-cells":"",bordered:"",flat:"",cell:"horizontal",class:"overflow-hidden"},{default:(0,l.w5)((()=>[I,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.pageData.sales,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id,class:"text-center"},[(0,l._)("td",null,(0,u.zw)(t.quantity),1),(0,l._)("td",null,(0,u.zw)(t.days),1),(0,l._)("td",null,(0,u.zw)(t.service_name),1),(0,l._)("td",null,(0,u.zw)(e.formatPrice(t.amount*t.quantity)),1)])))),128)),(0,l._)("tr",R,[H,e.pageData.sales?((0,l.wg)(),(0,l.iD)("td",Y,(0,u.zw)(e.formatPrice(e.itemsProductSum(e.pageData.sales,e.attribute1="amount",e.attribute2="quantity"))),1)):(0,l.kq)("",!0)]),(0,l._)("tr",N,[M,(0,l._)("td",E,(0,u.zw)(e.formatPrice(e.itemsSum(e.pageData.payments))),1)]),(0,l._)("tr",T,[A,(0,l._)("td",j,(0,u.zw)(e.formatPrice(e.itemsProductSum(e.pageData.sales,e.attribute1="amount",e.attribute2="quantity")-e.itemsSum(e.pageData.payments))),1)])])])),_:1}),B])])),_:1})])),_:1})])]),(0,l.Wm)(ot,{showing:e.loadingData},{default:(0,l.w5)((()=>[(0,l.Wm)(st,{size:"50px",color:"primary"})])),_:1},8,["showing"])])),_:1}),(0,l.Wm)(Dt,{modelValue:e.addPaymentDialog,"onUpdate:modelValue":t[8]||(t[8]=t=>e.addPaymentDialog=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(ut,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(yt,{ref:"paymentForm",onSubmit:e.savePayment},{default:(0,l.w5)((()=>[(0,l.Wm)(dt,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(it,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Payment")])),_:1}),(0,l.wy)((0,l.Wm)(Ge,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ht]])])),_:1}),(0,l.Wm)($e),(0,l._)("div",L,[(0,l._)("div",K,[(0,l.Wm)(rt,{dense:"","dense-toggle":"",label:"Balance Calculator","header-class":"text-primary",class:"rounded-borders",style:(0,u.j5)({border:"1px solid var(--q-primary)"})},{default:(0,l.w5)((()=>[(0,l.Wm)(mt,{defaultAmount:e.pageData.bill-e.pageData.paid},null,8,["defaultAmount"])])),_:1},8,["style"])]),(0,l.Wm)(_t,{outlined:"",label:"Date",modelValue:e.paymentData.date,"onUpdate:modelValue":t[5]||(t[5]=t=>e.paymentData.date=t),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},{control:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.paymentData.date),1)])),append:(0,l.w5)((()=>[(0,l.Wm)(Ge,{size:"sm",round:"",color:"primary",icon:"event"},{default:(0,l.w5)((()=>[(0,l.Wm)(pt,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ct,{modelValue:e.paymentData.date,"onUpdate:modelValue":t[4]||(t[4]=t=>e.paymentData.date=t),mask:"DD/MM/YYYY"},{default:(0,l.w5)((()=>[(0,l._)("div",G,[(0,l.wy)((0,l.Wm)(Ge,{"no-caps":"",label:"Close"},null,512),[[ht]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,l.Wm)(wt,{modelValue:e.paymentData.amount,"onUpdate:modelValue":t[6]||(t[6]=t=>e.paymentData.amount=t),"input-class":"text-h6",label:"Amount"},null,8,["modelValue"]),(0,l.Wm)(gt,{outlined:"",modelValue:e.paymentData.method,"onUpdate:modelValue":t[7]||(t[7]=t=>e.paymentData.method=t),label:"Mode of payment",options:e.paymentMethodOptions,"option-label":"name","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.paymentMethodOptions)},null,8,["modelValue","options","rules"]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(e.fields),((t,a)=>((0,l.wg)(),(0,l.j4)(vt,{outlined:"",key:a,"model-value":e.fields[t],"onUpdate:modelValue":a=>e.fields[t]=a,label:t},null,8,["model-value","onUpdate:modelValue","label"])))),128)),(0,l._)("div",$,[(0,l.Wm)(Ge,{rounded:"","no-caps":"",color:"primary",label:"Add Payment",class:"full-width",type:"submit",loading:e.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(Dt,{modelValue:e.updateStatusDialog,"onUpdate:modelValue":t[14]||(t[14]=t=>e.updateStatusDialog=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(ut,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(dt,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(it,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Status")])),_:1}),(0,l.wy)((0,l.Wm)(Ge,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ht]])])),_:1}),(0,l.Wm)($e),(0,l.Wm)(lt,null,{default:(0,l.w5)((()=>[(0,l.Wm)(yt,{ref:"updateStatusForm",onSubmit:e.submitStatusData},{default:(0,l.w5)((()=>[(0,l.Wm)(_t,{outlined:"",modelValue:e.newStatus,"onUpdate:modelValue":t[13]||(t[13]=t=>e.newStatus=t),"lazy-rules":"ondemand",rules:e.textInputRequiredRules("Please select an option")},{control:(0,l.w5)((()=>[(0,l._)("div",J,["CANCELLED"==e.pageData.status?((0,l.wg)(),(0,l.j4)(ft,{key:0,modelValue:e.newStatus,"onUpdate:modelValue":t[9]||(t[9]=t=>e.newStatus=t),val:e.statusOptions.open.value,label:e.statusOptions.open.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==e.pageData.status?((0,l.wg)(),(0,l.j4)(ft,{key:1,modelValue:e.newStatus,"onUpdate:modelValue":t[10]||(t[10]=t=>e.newStatus=t),val:e.statusOptions.close.value,label:e.statusOptions.close.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==e.pageData.status?((0,l.wg)(),(0,l.j4)(ft,{key:2,modelValue:e.newStatus,"onUpdate:modelValue":t[11]||(t[11]=t=>e.newStatus=t),val:e.statusOptions.cancel.value,label:e.statusOptions.cancel.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),(0,l.Wm)(bt,null,{default:(0,l.w5)((()=>["cancel"==e.newStatus?((0,l.wg)(),(0,l.iD)("div",X,[(0,l.Wm)(vt,{outlined:"",label:"Reason",type:"textarea",rows:"5","lazy-rules":"ondemand",rules:[...e.textInputRequiredRules(),...e.minimumRequiredRules(10)],modelValue:e.statusOptions.cancel.data.reason,"onUpdate:modelValue":t[12]||(t[12]=t=>e.statusOptions.cancel.data.reason=t)},null,8,["rules","modelValue"])])):(0,l.kq)("",!0)])),_:1})])])),_:1},8,["modelValue","rules"]),(0,l._)("div",ee,[(0,l.Wm)(Ge,{rounded:"",type:"submit",color:"primary",label:"submit",class:"full-width",loading:e.submitting},null,8,["loading"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(Dt,{modelValue:e.orderReceipt,"onUpdate:modelValue":t[16]||(t[16]=t=>e.orderReceipt=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(ut,{style:{minWidth:"500px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(lt,null,{default:(0,l.w5)((()=>[(0,l._)("div",te,[(0,l._)("div",ae,[(0,l._)("div",le,[ue,(0,l._)("div",se,(0,u.zw)(e.pageData.customer.name),1)]),(0,l._)("div",oe,[ne,(0,l._)("div",ie,(0,u.zw)(e.pageData.id),1)])]),(0,l.Wm)(at,{bordered:"",flat:"",cell:"horizontal"},{default:(0,l.w5)((()=>[de,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.pageData.sales,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id,class:"text-center"},[(0,l._)("td",null,(0,u.zw)(t.service_name),1),(0,l._)("td",null,(0,u.zw)(t.quantity),1),(0,l._)("td",null,(0,u.zw)(t.amount),1),(0,l._)("td",null,(0,u.zw)(e.formatPrice(t.amount*t.quantity)),1)])))),128)),(0,l._)("tr",me,[re,e.pageData.sales?((0,l.wg)(),(0,l.iD)("td",ce,(0,u.zw)(e.formatPrice(e.itemsProductSum2(e.pageData.sales,e.attributes=["amount","quantity"]))),1)):(0,l.kq)("",!0)]),(0,l._)("tr",pe,[_e,(0,l._)("td",we,(0,u.zw)(e.formatPrice(e.itemsSum(e.pageData.payments))),1)]),(0,l._)("tr",ge,[ve,(0,l._)("td",ye,(0,u.zw)(e.formatPrice(e.itemsProductSum(e.pageData.sales,e.attribute1="amount",e.attribute2="quantity")-e.itemsSum(e.pageData.payments))),1)])])])),_:1}),(0,l._)("div",De,[(0,l.Wm)(Ge,{rounded:"",label:"print",icon:"print",color:"primary",class:"full-width",onClick:t[15]||(t[15]=t=>e.printDocument("orderReceiptPrintOut",e.printingSettings))})]),fe])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(Dt,{modelValue:e.customerFormDialog,"onUpdate:modelValue":t[25]||(t[25]=t=>e.customerFormDialog=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(ut,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(yt,{ref:"customerForm",onSubmit:e.submitCustomerData},{default:(0,l.w5)((()=>[(0,l.Wm)(dt,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(it,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Customer Details")])),_:1}),(0,l.wy)((0,l.Wm)(Ge,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ht]])])),_:1}),(0,l.Wm)(lt,{class:"column q-col-gutter-y-md q-mx-md q-mt-sm"},{default:(0,l.w5)((()=>[(0,l._)("div",be,[he,(0,l._)("div",qe,[(0,l.Wm)(vt,{dense:"",outlined:"",modelValue:e.customerFormData.name,"onUpdate:modelValue":t[17]||(t[17]=t=>e.customerFormData.name=t),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",We,[xe,(0,l._)("div",ke,[(0,l.Wm)(vt,{dense:"",outlined:"",mask:"### ### ######","unmasked-value":"",modelValue:e.customerFormData.contact,"onUpdate:modelValue":t[18]||(t[18]=t=>e.customerFormData.contact=t),"lazy-rules":"ondemand",rules:e.contactRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",Ve,[Se,(0,l._)("div",ze,[(0,l.Wm)(vt,{dense:"",outlined:"",modelValue:e.customerFormData.address,"onUpdate:modelValue":t[19]||(t[19]=t=>e.customerFormData.address=t)},null,8,["modelValue"])])]),(0,l._)("div",Pe,[Ue,(0,l._)("div",Ze,[(0,l.Wm)(vt,{dense:"",outlined:"",modelValue:e.customerFormData.identification_number,"onUpdate:modelValue":t[20]||(t[20]=t=>e.customerFormData.identification_number=t)},null,8,["modelValue"])])]),(0,l._)("div",Oe,[Fe,(0,l._)("div",Ce,[(0,l.Wm)(vt,{dense:"",outlined:"",modelValue:e.customerFormData.nationality,"onUpdate:modelValue":t[21]||(t[21]=t=>e.customerFormData.nationality=t)},null,8,["modelValue"])])]),(0,l._)("div",Qe,[Ie,(0,l._)("div",Re,[(0,l.Wm)(vt,{dense:"",outlined:"",modelValue:e.customerFormData.district,"onUpdate:modelValue":t[22]||(t[22]=t=>e.customerFormData.district=t)},null,8,["modelValue"])])]),(0,l._)("div",He,[Ye,(0,l._)("div",Ne,[(0,l.Wm)(vt,{dense:"",outlined:"",modelValue:e.customerFormData.occupation,"onUpdate:modelValue":t[23]||(t[23]=t=>e.customerFormData.occupation=t)},null,8,["modelValue"])])]),(0,l._)("div",Me,[Ee,(0,l._)("div",Te,[(0,l.Wm)(vt,{dense:"",outlined:"",modelValue:e.customerFormData.organisation,"onUpdate:modelValue":t[24]||(t[24]=t=>e.customerFormData.organisation=t)},null,8,["modelValue"])])]),(0,l._)("div",Ae,[(0,l.Wm)(Ge,{rounded:"",class:"full-width",label:"submit",color:"primary",type:"submit",loading:e.submitting},null,8,["loading"])])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var Be=a(9302),Le=a(4170),Ke=a(499),Ge=a(2580),$e=a(9258),Je=a(4019),Xe=(a(4906),a(8221));const et=(0,l.aZ)({name:"OtherServicesOrderDetails",props:{Id:{required:!0}},components:{MoneyInputComponent:Ge.Z,BalanceCalculatorComponent:$e.Z},setup(e){(0,Be.Z)();const t={customer:{},payments:[],sales:[],bill:0,paid:0},a=(0,Ke.iH)({}),u=(0,Ke.iH)({...t}),s=(0,l.Fl)((()=>u.value.customer?u.value.customer:{})),o=(0,l.Fl)((()=>u.value.payments?u.value.payments:[])),n=(0,l.Fl)((()=>u.value.sales?u.value.sales:[])),i=(0,Ke.iH)(!1),d=(0,Ke.iH)(!1),m=(0,Ke.iH)({}),r=(0,Ke.iH)([]),c=(0,Ke.iH)(null),p=(0,Ke.iH)(!1),_=(0,Ke.iH)({}),w=(0,Ke.iH)(null),g={open:{label:"Open",value:"open",data:{status:"OPEN"}},close:{label:"Close",value:"close",data:{status:"CLOSED"}},cancel:{label:"Cancel",value:"cancel",data:{status:"CANCELLED",reason:""}}},v=(0,Ke.iH)(),y=(0,Ke.iH)(!1),D=(0,Ke.iH)(!1),f=(0,Ke.iH)(!1),b=(0,Ke.iH)(null),h=(0,Ke.iH)({});function q(){return i.value=!0,u.value={...t},(0,Je.getOtherServicesSales)(`/${e.Id}`).then((e=>{u.value=e.data})).then((()=>{h.value={...s.value}})).finally((()=>{i.value=!1}))}function W(){return(0,Je.getGeneralSettings)("?name=PRINTERS").then((e=>{a.value=e.data.details["items"].find((e=>"services receipts"==e.item))||e.data.details["items"].find((e=>"receipts"==e.item))}))}return(0,l.m0)((()=>{m.value&&m.value.method&&m.value.method.other_details&&m.value.method.other_details.fields?_.value=m.value.method.other_details.fields.reduce(((e,t)=>({...e,[t]:null})),{}):_.value={}})),(0,l.m0)((()=>{n.value.forEach((e=>{let t=0;"hour"==e.period?t=24:"day"==e.period?t=1:"week"==e.period?t=1/7:"month"==e.period&&(t=1/28),e.from_date&&e.to_date?(e.days=parseInt((Le.ZP.getDateDiff(Le.ZP.extractDate(e.to_date,"DD/MM/YYYY"),Le.ZP.extractDate(e.from_date,"DD/MM/YYYY"))+1)*t),e.total_price=e.days*e.amount*e.quantity):e.total_price=0}))})),(0,l.bv)((()=>{m.value.date=Le.ZP.formatDate(new Date,"DD/MM/YYYY"),q().then((()=>{(0,Je.getPaymentMethods)().then((e=>{r.value=e.data,W()}))}))})),{pageData:u,loadingData:i,customerData:s,paymentsData:o,itemsData:n,addPaymentDialog:d,paymentData:m,paymentMethodOptions:r,paymentForm:c,submitting:p,fields:_,newStatus:w,statusOptions:g,updateStatusForm:v,updateStatusDialog:y,orderReceipt:D,printingSettings:a,customerForm:b,customerFormDialog:f,customerFormData:h,submitCustomerData(){b.value.validate()&&(p.value=!0,(0,Je.updateOtherServicesSaleCustomer)(e.Id,h.value).then((e=>{(0,Xe.displayNotification)(e.data,"positive"),h.value={},b.value.resetValidation(),f.value=!1,q()})).catch((e=>{(0,Xe.displayNotification)(e,"negative",{error:!0})})).finally((()=>{p.value=!1})))},savePayment(){c.value.validate()&&(p.value=!0,(0,Je.addOtherServicesSalesPayment)(e.Id,{...m.value,method:m.value.method.id,other_details:_.value}).then((e=>{(0,Xe.displayNotification)(e.data,"positive"),m.value={},q(),d.value=!1})).catch((e=>{(0,Xe.displayNotification)(e,"negative",{error:!0})})).finally((()=>{p.value=!1})))},submitStatusData(){v.value.validate()&&(p.value=!0,(0,Je.updateOtherServicesSalesStatus)(e.Id,g[w.value].data).then((e=>{(0,Xe.displayNotification)(e.data,"positive"),w.value=null,y.value=!1,q()})).catch((e=>{(0,Xe.displayNotification)(e.response.data,"negative")})).finally((()=>{p.value=!1})))}}}});var tt=a(1639),at=a(9885),lt=a(2605),ut=a(8052),st=a(8879),ot=a(926),nt=a(3246),it=a(490),dt=a(1233),mt=a(3115),rt=a(6933),ct=a(4458),pt=a(3190),_t=a(854),wt=a(8359),gt=a(2074),vt=a(8326),yt=a(1663),Dt=a(1973),ft=a(651),bt=a(8149),ht=a(2765),qt=a(4351),Wt=a(4581),xt=a(6611),kt=a(1480),Vt=a(9003),St=a(2146),zt=a(9984),Pt=a.n(zt);const Ut=(0,tt.Z)(et,[["render",je]]),Zt=Ut;Pt()(et,"components",{QPage:at.Z,QBreadcrumbs:lt.Z,QBreadcrumbsEl:ut.Z,QBtn:st.Z,QSeparator:ot.Z,QList:nt.Z,QItem:it.Z,QItemSection:dt.Z,QItemLabel:mt.Z,QMarkupTable:rt.Z,QCard:ct.Z,QCardSection:pt.Z,QInnerLoading:_t.Z,QSpinnerIos:wt.Z,QDialog:gt.Z,QForm:vt.Z,QToolbar:yt.Z,QToolbarTitle:Dt.Z,QExpansionItem:ft.Z,QField:bt.Z,QPopupProxy:ht.Z,QDate:qt.Z,QSelect:Wt.Z,QInput:xt.Z,QRadio:kt.Z,QSlideTransition:Vt.Z}),Pt()(et,"directives",{ClosePopup:St.Z})}}]);