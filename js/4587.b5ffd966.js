"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[4587],{4587:(e,l,a)=>{a.r(l),a.d(l,{default:()=>I});var t=a(9835),o=a(6970);const n={class:"row q-mb-lg justify-between"},s={class:"row q-gutter-x-xl"},i={class:"row items-center q-gutter-x-md"},r={key:0,class:"text-grey-9 q-ml-sm"},u={key:1,class:"text-grey-9 q-ml-sm"},d={class:"row justify-end"},m={key:0,class:"text-grey-9 q-ml-sm"},p={key:1,class:"text-grey-9 q-ml-sm"},c={class:"row justify-end"},v={key:0,class:"row items-center"},f={id:"reportToPrint"};function g(e,l,a,g,b,w){const h=(0,t.up)("q-select"),D=(0,t.up)("q-form"),y=(0,t.up)("q-btn"),_=(0,t.up)("q-date"),k=(0,t.up)("q-popup-proxy"),q=(0,t.up)("q-field"),W=(0,t.up)("q-separator"),C=(0,t.up)("q-td"),R=(0,t.up)("q-tr"),P=(0,t.up)("q-table"),V=(0,t.up)("q-spinner-ios"),S=(0,t.up)("q-inner-loading"),Z=(0,t.up)("q-page"),x=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(Z,{class:"q-pa-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",s,[(0,t._)("div",null,[(0,t.Wm)(D,{ref:"stockItemForm"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedSalesOption,"onUpdate:modelValue":[l[0]||(l[0]=l=>e.selectedSalesOption=l),e.salesOptionChanged],options:e.salesOptions,"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.salesValidOptions.map((e=>e.value))),style:{minWidth:"180px"}},null,8,["modelValue","onUpdate:modelValue","options","rules"])])),_:1},512)]),(0,t._)("div",null,[(0,t.Wm)(h,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedFilter,"onUpdate:modelValue":[l[1]||(l[1]=l=>e.selectedFilter=l),e.filterOptionChanged],options:e.filterOptions},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,t._)("div",null,[(0,t._)("div",i,[(0,t.Wm)(q,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)(" From: "),e.fromDate?((0,t.wg)(),(0,t.iD)("span",r,(0,o.zw)(e.fromDate),1)):((0,t.wg)(),(0,t.iD)("span",u,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(y,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{ref:"fromDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:e.fromDate,"onUpdate:modelValue":[l[2]||(l[2]=l=>e.fromDate=l),e.fromDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t.wy)((0,t.Wm)(y,{flat:"",label:"Close",color:"primary"},null,512),[[x]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1}),(0,t.Wm)(q,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)("To: "),e.toDate?((0,t.wg)(),(0,t.iD)("span",m,(0,o.zw)(e.toDate),1)):((0,t.wg)(),(0,t.iD)("span",p,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(y,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{ref:"toDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:e.toDate,"onUpdate:modelValue":[l[3]||(l[3]=l=>e.toDate=l),e.toDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",c,[(0,t.wy)((0,t.Wm)(y,{flat:"",label:"Close",color:"primary"},null,512),[[x]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1})])])]),e.$q.platform.is.electron?((0,t.wg)(),(0,t.iD)("div",v,[(0,t.Wm)(y,{unelevated:"",flat:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:l[4]||(l[4]=l=>e.printDocument("reportToPrint",e.printingSettings))}),(0,t.Wm)(W,{vertical:""}),(0,t.Wm)(y,{unelevated:"",flat:"","no-caps":"",icon:"file_download",color:"grey-9",label:"Download",onClick:l[5]||(l[5]=l=>e.printDocumentPDF("reportToPrint"))})])):(0,t.kq)("",!0)]),(0,t._)("div",null,[(0,t._)("div",f,[(0,t.Wm)(P,{flat:"",bordered:"",square:"","hide-pagination":"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No stock available","loading-label":"Loading stock..."},{"bottom-row":(0,t.w5)((()=>[e.tableRows.length>0?((0,t.wg)(),(0,t.j4)(R,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{class:"text-weight-bold text-right",colspan:"5"},{default:(0,t.w5)((()=>[(0,t.Uk)("Total Sales:")])),_:1}),(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.formatPrice(e.itemsSum(e.tableRows,"total"))),1)])),_:1})])),_:1})):(0,t.kq)("",!0)])),_:1},8,["loading","columns","rows"])]),(0,t.Wm)(S,{label:"Please wait",showing:e.loadingData},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{size:"50px",color:"primary"})])),_:1},8,["showing"])])])),_:1})}var b=a(9302),w=a(499),h=a(4019),D=a(8221);const y=(0,t.aZ)({name:"ReportsIndex",setup(){(0,b.Z)();const e=(0,w.iH)(!1),l=(0,w.iH)(),a=(0,w.iH)(),o=(0,w.iH)("1"),n=(0,w.iH)("?month"),s=(0,w.iH)("month"),i=[{label:"Select Period",value:null,disable:!0},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}],r=(0,w.iH)(""),u=(0,w.iH)(""),d=(0,w.iH)(null),m=[{label:"Rooms",value:"rooms"},{label:"Bar",value:"bar"},{label:"Restaurant",value:"restaurant"},{label:"Restaurant and Bar",value:"restaurantandbar"},{label:"Services",value:"otherservices"}],p=[{label:"Select Item",value:null,disable:!0},...m],c=(0,w.iH)([]),v=(0,w.iH)(null),f=(0,w.iH)({});function g(){n.value=`?from_date=${r.value}&to_date=${u.value}`,_(),s.value=null}function y(e){return"rooms"==e?(0,h.getRoomReports)("/sales"+n.value):"bar"==e?(0,h.getRestaurantNBarReports)("/bar-sales"+n.value):"restaurant"==e?(0,h.getRestaurantNBarReports)("/restaurant-sales"+n.value):"restaurantandbar"==e?(0,h.getRestaurantNBarReports)("/sales"+n.value):"otherservices"==e?(0,h.getOtherServicesReports)("/sales"+n.value):new Promise(((e,l)=>{l()}))}function _(){v.value.validate().then((l=>{l&&(e.value=!0,c.value=[],y(d.value).then((e=>{c.value=e.data})).finally((()=>{e.value=!1})),v.value.resetValidation())}))}function k(){return(0,h.getGeneralSettings)("?name=PRINTERS").then((e=>{f.value=e.data.details["items"].find((e=>"rooms receipts"==e.item))||e.data.details["items"].find((e=>"receipts"==e.item))}))}return(0,t.bv)((()=>{k()})),{loadingData:e,toDateDialog:l,fromDateDialog:a,fromDate:r,toDate:u,tabs:o,selectedFilter:s,filterOptions:i,selectedSalesOption:d,salesOptions:p,salesValidOptions:m,tableRows:c,stockItemForm:v,printingSettings:f,tableColumns:[{label:"Date",field:"date",align:"left",name:"date"},{label:"Customer",field:"client",align:"left",name:"customer"},{label:"Created By",field:"creator",align:"left",name:"creator"},{label:"Cash",align:"left",name:"cash",field:e=>(0,D.formatPrice)(e.cash)},{label:"Credit",align:"left",name:"credit",field:e=>(0,D.formatPrice)(e.total-e.cash)},{label:"Total",align:"left",field:e=>(0,D.formatPrice)(e.total),name:"total"}],fromDateChanged(e,l,t){null!=r.value&&null!=u.value&&g(),a.value.hide()},toDateChanged(e,a,t){null!=r.value&&null!=u.value&&g(),l.value.hide()},filterOptionChanged(e){e&&(r.value=null,u.value=null,n.value=`?filter=${e}`,_())},salesOptionChanged(){null===n.value&&""==n.value||_()}}}});var _=a(1639),k=a(9885),q=a(8326),W=a(4581),C=a(8149),R=a(8879),P=a(2765),V=a(4351),S=a(926),Z=a(7355),x=a(3532),T=a(7220),O=a(854),Q=a(8359),H=a(2146),U=a(9984),F=a.n(U);const Y=(0,_.Z)(y,[["render",g]]),I=Y;F()(y,"components",{QPage:k.Z,QForm:q.Z,QSelect:W.Z,QField:C.Z,QBtn:R.Z,QPopupProxy:P.Z,QDate:V.Z,QSeparator:S.Z,QTable:Z.Z,QTr:x.Z,QTd:T.Z,QInnerLoading:O.Z,QSpinnerIos:Q.Z}),F()(y,"directives",{ClosePopup:H.Z})}}]);