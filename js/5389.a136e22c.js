"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[5389],{5389:(e,a,l)=>{l.r(a),l.d(a,{default:()=>N});var t=l(9835),i=l(6970);const o={class:"row justify-end"},n={class:"column"},s={class:"row no-wrap q-gutter-x-md"},u={class:"column q-mx-lg q-mb-lg"},d={class:"row justify-end q-mt-md"},r={class:"q-mt-md"},m={class:"column q-mx-lg q-mb-lg"},c={class:"q-mt-md"};function p(e,a,l,p,g,v){const f=(0,t.up)("q-btn"),w=(0,t.up)("q-separator"),b=(0,t.up)("q-td"),y=(0,t.up)("q-table"),_=(0,t.up)("q-page"),h=(0,t.up)("q-toolbar-title"),q=(0,t.up)("q-toolbar"),D=(0,t.up)("q-select"),I=(0,t.up)("q-item-label"),W=(0,t.up)("q-item"),C=(0,t.up)("q-input"),k=(0,t.up)("q-item-section"),H=(0,t.up)("q-list"),V=(0,t.up)("q-form"),Z=(0,t.up)("q-card"),S=(0,t.up)("q-dialog"),U=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(_,{class:"q-ma-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",o,[e.permissionRequired("store","add_item")?((0,t.wg)(),(0,t.j4)(f,{key:0,"no-caps":"",rounded:"",color:"primary",label:"Create",onClick:a[0]||(a[0]=a=>e.createDialog=!e.createDialog)})):(0,t.kq)("",!0)]),(0,t.Wm)(y,{flat:"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"Items","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No items available","loading-label":"Loading items..."},{"body-cell-units_details":(0,t.w5)((e=>[(0,t.Wm)(b,{props:e},{default:(0,t.w5)((()=>[(0,t._)("div",n,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.units_available_details,((a,l)=>((0,t.wg)(),(0,t.iD)("div",{key:l},[(0,t._)("div",null,(0,i.zw)(a.quantity)+" "+(0,i.zw)(a.unit),1),l!=e.row.units_available_details.length-1?((0,t.wg)(),(0,t.j4)(w,{key:0,class:"q-my-xs"})):(0,t.kq)("",!0)])))),128))])])),_:2},1032,["props"])])),"body-cell-actions":(0,t.w5)((a=>[(0,t.Wm)(b,{props:a},{default:(0,t.w5)((()=>[(0,t._)("div",s,[e.permissionRequired("store","change_item")?((0,t.wg)(),(0,t.j4)(f,{key:0,round:"",unelevated:"",size:"sm",icon:"edit",color:"primary",onClick:l=>e.showEditDialog(a.rowIndex)},null,8,["onClick"])):(0,t.kq)("",!0),e.permissionRequired("store","delete_item")?((0,t.wg)(),(0,t.j4)(f,{key:1,round:"",unelevated:"",size:"sm",icon:"delete",color:"red",onClick:l=>e.showDeleteDialog(a.row.id)},null,8,["onClick"])):(0,t.kq)("",!0)])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])])),_:1}),(0,t.Wm)(S,{modelValue:e.createDialog,"onUpdate:modelValue":a[2]||(a[2]=a=>e.createDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{ref:"createDialogForm",onSubmit:e.submitItemData},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Create New Items")])),_:1}),(0,t.wy)((0,t.Wm)(f,{flat:"",round:"",size:"md",icon:"close"},null,512),[[U]])])),_:1}),(0,t.Wm)(w),(0,t._)("div",u,[(0,t.Wm)(D,{"emit-value":"","map-options":"",modelValue:e.categorySelected,"onUpdate:modelValue":a[1]||(a[1]=a=>e.categorySelected=a),label:"Category",loading:e.loadingCategories,options:e.categoriesOptions,"option-label":"name","option-value":"id","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.categoriesOptions.map((e=>e.id)))},null,8,["modelValue","loading","options","rules"]),(0,t._)("div",d,[(0,t.Wm)(f,{label:"Add",color:"primary",onClick:e.addItem},null,8,["onClick"])]),(0,t.Wm)(H,null,{default:(0,t.w5)((()=>[(0,t.Wm)(W,null,{default:(0,t.w5)((()=>[(0,t.Wm)(I,{header:""},{default:(0,t.w5)((()=>[(0,t.Uk)("Items")])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.itemData,((a,l)=>((0,t.wg)(),(0,t.j4)(W,{key:l},{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Wm)(C,{outlined:"",modelValue:a.name,"onUpdate:modelValue":e=>a.name=e,"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","onUpdate:modelValue","rules"])])),_:2},1024),(0,t.Wm)(k,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{round:"",size:"md",icon:"delete",color:"red",onClick:a=>e.removeItem(l)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,t._)("div",r,[(0,t.Wm)(f,{rounded:"",loading:e.submittingData,color:"primary",label:"Create",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(S,{modelValue:e.updateDialog,"onUpdate:modelValue":a[5]||(a[5]=a=>e.updateDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{ref:"updateDialogForm",onSubmit:e.updateItemData},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Update Item")])),_:1}),(0,t.wy)((0,t.Wm)(f,{flat:"",round:"",size:"md",icon:"close"},null,512),[[U]])])),_:1}),(0,t.Wm)(w),(0,t._)("div",m,[(0,t.Wm)(D,{"emit-value":"","map-options":"",modelValue:e.editItem.category_id,"onUpdate:modelValue":a[3]||(a[3]=a=>e.editItem.category_id=a),label:"Category",loading:e.loadingCategories,options:e.categoriesOptions,"option-label":"name","option-value":"id","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.categoriesOptions.map((e=>e.id)))},null,8,["modelValue","loading","options","rules"]),(0,t.Wm)(C,{label:"Name",modelValue:e.editItem.name,"onUpdate:modelValue":a[4]||(a[4]=a=>e.editItem.name=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t._)("div",c,[(0,t.Wm)(f,{rounded:"",loading:e.submittingData,color:"primary",label:"Update",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}l(9665);var g=l(9302),v=l(499),f=l(4019),w=l(8221);const b=[{name:"id",label:"#",field:"id",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"units_available",label:"Units",field:"units_available",sortable:!0,align:"left"},{name:"units_details",label:"Units Details",sortable:!0,align:"left"},{name:"actions",label:"Actions",align:"left"}],y=(0,t.aZ)({name:"StoreItems",setup(){const e=(0,g.Z)(),a=(0,v.iH)([]),l=(0,v.iH)(!1),i=(0,v.iH)(!1),o=(0,v.iH)(null),n=(0,v.iH)(!1),s=(0,v.iH)([]),u=(0,v.iH)(null),d=(0,v.iH)(!1),r=(0,v.iH)([]),m=(0,v.iH)([]),c=(0,v.iH)([]),p=(0,v.iH)(!1),y=(0,v.iH)([]),_=(0,v.iH)(!1),h=(0,v.iH)([]),q=(0,v.iH)(!1),D=(0,v.iH)(null),I=(0,v.iH)({});function W(){return l.value=!0,(0,f.getStoreItems)().then((e=>{a.value=e.data})).catch((e=>{})).finally((()=>{l.value=!1}))}function C(){return _.value=!0,(0,f.getUnits)().then((e=>{y.value=e.data,h.value=e.data})).finally((()=>{_.value=!1}))}function k(){p.value=!0,(0,f.getStoreItems)("?available=True").then((e=>{c.value=e.data,m.value=e.data})).finally((()=>{p.value=!1}))}function H(){return d.value=!0,(0,f.getStoreCategories)().then((e=>{r.value=e.data})).catch((e=>{})).finally((()=>{d.value=!1}))}return(0,t.bv)((()=>{W().then((()=>{H().then((()=>{C().then((()=>{k()}))}))}))})),{loadingData:l,tableRows:a,tableColumns:b,itemData:s,createDialog:i,createDialogForm:o,submittingData:n,categorySelected:u,loadingCategories:d,categoriesOptions:r,filteredItemOptions:m,filteredUnitOptions:h,loadingUnits:_,loadingItems:p,updateDialog:q,updateDialogForm:D,editItem:I,showEditDialog(e){let l={...a.value[e]};I.value={category_id:l.category.id,id:l.id,name:l.name},q.value=!0},addItem(){s.value.push({})},removeItem(a){e.dialog({title:"Confirm",message:"Are you sure ?",cancel:!0}).onOk((()=>{s.value.splice(a,1)}))},filterItemOptions(e,a){a((()=>{m.value=c.value.filter((a=>a.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1))}))},filterUnitsOptions(e,a){a((()=>{h.value=y.value.filter((a=>a.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1))}))},submitItemData(){o.value.validate()&&(n.value=!0,(0,f.createStoreItems)(u.value,{items:s.value}).then((a=>{e.notify({type:"positive",message:a.data}),s.value=[],W(),i.value=!1,o.value.resetValidation()})).catch((a=>{e.notify({type:"negative",message:a.response.data.length<1e3?a.response.data:"Server error please contact system administrator"})})).finally((()=>{n.value=!1})))},updateItemData(){if(D.value.validate()){n.value=!0;let a=I.value.id;delete I.value.id,(0,f.editStoreItems)(a,{...I.value}).then((a=>{e.notify({type:"positive",message:a.data}),I.value={},W(),q.value=!1,D.value.resetValidation()})).catch((a=>{e.notify({type:"negative",message:a.response.data.length<1e3?a.response.data:"Server error please contact system administrator"})})).finally((()=>{n.value=!1}))}},showDeleteDialog(a){e.dialog({title:"Confirm",message:"Please confirm?",cancel:!0}).onOk((()=>{n.value=!0,(0,f.deleteStoreItems)(a).then((e=>{(0,w.displayNotification)(e.data,"positive"),W()})).catch((e=>{(0,w.displayNotification)(e.response.data,"negative")})).finally((()=>{n.value=!1}))}))}}}});var _=l(1639),h=l(9885),q=l(8879),D=l(7355),I=l(7220),W=l(926),C=l(2074),k=l(4458),H=l(8326),V=l(1663),Z=l(1973),S=l(4581),U=l(3246),Q=l(490),x=l(3115),O=l(1233),R=l(6611),z=l(2146),L=l(9984),T=l.n(L);const j=(0,_.Z)(y,[["render",p]]),N=j;T()(y,"components",{QPage:h.Z,QBtn:q.Z,QTable:D.Z,QTd:I.Z,QSeparator:W.Z,QDialog:C.Z,QCard:k.Z,QForm:H.Z,QToolbar:V.Z,QToolbarTitle:Z.Z,QSelect:S.Z,QList:U.Z,QItem:Q.Z,QItemLabel:x.Z,QItemSection:O.Z,QInput:R.Z}),T()(y,"directives",{ClosePopup:z.Z})}}]);