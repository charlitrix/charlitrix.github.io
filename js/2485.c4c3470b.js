"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[2485],{2485:(e,a,l)=>{l.r(a),l.d(a,{default:()=>T});var t=l(9835),i=l(6970);const o={class:"row justify-end"},n={class:"row q-col-gutter-md"},r={class:"column justify-center"},d=(0,t._)("div",null,null,-1),u={class:"row no-wrap q-gutter-x-md"},s={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg"};function m(e,a,l,m,p,c){const g=(0,t.up)("q-btn"),b=(0,t.up)("q-td"),v=(0,t.up)("q-table"),w=(0,t.up)("q-page"),D=(0,t.up)("q-toolbar-title"),f=(0,t.up)("q-toolbar"),q=(0,t.up)("q-separator"),y=(0,t.up)("q-input"),_=(0,t.up)("q-checkbox"),h=(0,t.up)("q-form"),k=(0,t.up)("q-card"),C=(0,t.up)("q-dialog"),Z=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(w,{class:"q-ma-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",o,[e.permissionRequired("core","add_department")?((0,t.wg)(),(0,t.j4)(g,{key:0,rounded:"",color:"primary",label:"Create",onClick:a[0]||(a[0]=a=>e.createDialog=!e.createDialog)})):(0,t.kq)("",!0)]),(0,t.Wm)(v,{flat:"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"Departments","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No departments available","loading-label":"Loading items..."},{"body-cell-units_available":(0,t.w5)((e=>[(0,t.Wm)(b,{props:e},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",r,[(0,t._)("div",null,(0,i.zw)(e.value),1)]),d])])),_:2},1032,["props"])])),"body-cell-actions":(0,t.w5)((a=>[(0,t.Wm)(b,{props:a},{default:(0,t.w5)((()=>[(0,t._)("div",u,[e.permissionRequired("core","change_department")?((0,t.wg)(),(0,t.j4)(g,{key:0,round:"",unelevated:"",size:"sm",icon:"edit",color:"primary",onClick:l=>e.showEditDialog(a.rowIndex)},null,8,["onClick"])):(0,t.kq)("",!0),e.permissionRequired("core","delete_department")?((0,t.wg)(),(0,t.j4)(g,{key:1,round:"",unelevated:"",size:"sm",icon:"delete",color:"red",onClick:l=>e.deleteItem(a.row.id)},null,8,["onClick"])):(0,t.kq)("",!0)])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])])),_:1}),(0,t.Wm)(C,{modelValue:e.createDialog,"onUpdate:modelValue":a[4]||(a[4]=a=>e.createDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{ref:"createDialogForm",onSubmit:e.submitData},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{textContent:(0,i.zw)(e.departmentData.id?"Update Department":"New Department")},null,8,["textContent"]),(0,t.wy)((0,t.Wm)(g,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Z]])])),_:1}),(0,t.Wm)(q),(0,t._)("div",s,[(0,t.Wm)(y,{modelValue:e.departmentData.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.departmentData.name=a),label:"Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(y,{modelValue:e.departmentData.description,"onUpdate:modelValue":a[2]||(a[2]=a=>e.departmentData.description=a),label:"Description","lazy-rules":"ondemand",type:"textarea",rows:"5",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(_,{modelValue:e.departmentData.is_administrator,"onUpdate:modelValue":a[3]||(a[3]=a=>e.departmentData.is_administrator=a),label:"Administration Roles"},null,8,["modelValue"]),(0,t._)("div",null,[(0,t.Wm)(g,{rounded:"",loading:e.submitting,color:"primary",label:e.departmentData.id?"Update":"Create",class:"full-width",type:"submit"},null,8,["loading","label"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var p=l(9302),c=l(499),g=l(4019),b=l(8221);const v=[{name:"id",label:"#",field:"id",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"description",label:"Description",field:"description",sortable:!0,align:"left"},{name:"actions",label:"Actions",align:"left"}],w=(0,t.aZ)({name:"DepartmentsIndex",setup(){const e=(0,p.Z)(),a=(0,c.iH)([]),l=(0,c.iH)(!1),i=(0,c.iH)(!1),o=(0,c.iH)(null),n=(0,c.iH)({is_administrator:!1}),r=(0,c.iH)(!1),d=(0,c.iH)({}),u=(0,c.iH)(!1),s=(0,c.iH)(null);function m(){l.value=!0,(0,g.getDepartments)().then((e=>{a.value=e.data})).catch((e=>{})).finally((()=>{l.value=!1}))}function w(){if(n.value.id){let e=n.value.id;return delete n.value.id,(0,g.editDepartment)(e,n.value)}return(0,g.createDepartment)(n.value)}return(0,t.bv)((()=>{m()})),{loadingData:l,tableRows:a,tableColumns:v,departmentData:n,submitting:r,createDialog:i,createDialogForm:o,editData:d,updateDialog:u,updateDialogForm:s,showEditDialog(e){n.value={...a.value[e]},i.value=!0},submitData(){o.value.validate()&&(r.value=!0,w().then((e=>{(0,b.displayNotification)(e.data,"positive"),n.value={is_administrator:!1},m(),i.value=!1,o.value.resetValidation()})).catch((e=>{(0,b.displayNotification)(e.response.data,"negative")})).finally((()=>{r.value=!1})))},deleteItem(a){e.dialog({message:"Please confirm?",cancel:!0}).onOk((()=>{}))}}}});var D=l(1639),f=l(9885),q=l(8879),y=l(7355),_=l(7220),h=l(2074),k=l(4458),C=l(8326),Z=l(1663),x=l(1973),W=l(926),Q=l(6611),V=l(1221),H=l(2146),R=l(9984),z=l.n(R);const I=(0,D.Z)(w,[["render",m]]),T=I;z()(w,"components",{QPage:f.Z,QBtn:q.Z,QTable:y.Z,QTd:_.Z,QDialog:h.Z,QCard:k.Z,QForm:C.Z,QToolbar:Z.Z,QToolbarTitle:x.Z,QSeparator:W.Z,QInput:Q.Z,QCheckbox:V.Z}),z()(w,"directives",{ClosePopup:H.Z})}}]);