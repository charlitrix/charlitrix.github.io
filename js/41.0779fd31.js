"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[41],{41:(e,a,l)=>{l.r(a),l.d(a,{default:()=>Za});var t=l(9835),i=l(6970),s=l(1957);const n=(0,t._)("div",{class:"text-h6"},"Restaurant & Bar Sales",-1),o={class:"relative-position q-mb-xl"},d={class:"shadow-21 q-ma-sm q-mb-xl"},r={style:{border:"1px solid grey"}},u={class:"column q-mx-sm q-mt-md"},m={class:"q-ml-md column q-gutter-y-md q-mb-md"},c={class:"row items-center q-col-gutter-x-md"},p=(0,t._)("div",{class:"col-3 text-subtitle1"},"Name:",-1),_={class:"col"},w={class:"row items-center q-col-gutter-x-md"},g=(0,t._)("div",{class:"col-3 text-subtitle1"},"Contact:",-1),f={class:"col"},v={class:"row items-center q-col-gutter-x-md"},y=(0,t._)("div",{class:"col-3 text-subtitle1"},"Address:",-1),b={class:"col"},h={class:"full-width"},q=(0,t._)("thead",{class:"bg-blue-7 text-white"},[(0,t._)("tr",null,[(0,t._)("th",{class:"text-left text-subtitle2"}," Item "),(0,t._)("th",{class:"text-left text-subtitle2"}," Qty "),(0,t._)("th")])],-1),x={class:"ellipsis",style:{fontSize:"12px",maxWidth:"110px"}},D={class:"text-weight-bold",style:{fontSize:"12px"}},W={class:"text-center full-width ellipsis",style:{maxWidth:"45px"}},k={class:"bg-blue-1"},z={key:0,class:"text-h6"},V=(0,t._)("td",null,"Total",-1),P={colspan:"2"},C={class:"row justify-between q-mt-sm q-mx-md"},H=(0,t._)("div",{class:"text-subtitle1"},"Payments",-1),S={class:"text-subtitle2"},Z={class:"text-subtitle2"},Q={class:"q-px-md q-mt-sm q-mb-xl"},I={class:"q-px-lg q-py-sm"},R={class:"row q-col-gutter-md bg-grey-3 q-pb-xl"},U={class:"text-h6"},T={class:"block q-py-sm"},K={key:0,class:"col-12 q-pa-xl flex flex-center"},Y=(0,t._)("div",{class:"text-h3 text-grey-7"}," No Items available ",-1),O=[Y],j={class:"row q-col-gutter-md bg-grey-3 q-pb-xl"},$={class:"text-h6"},A={class:"block q-py-sm"},L={key:0,class:"col-12 q-pa-xl flex flex-center"},B=(0,t._)("div",{class:"text-h3 text-grey-7"}," No Items available ",-1),F=[B],N={class:"row q-col-gutter-md bg-grey-3 q-pb-xl"},E={class:"text-h6"},M={class:"block q-py-sm"},G={key:0,class:"col-12 q-pa-xl flex flex-center"},J=(0,t._)("div",{class:"text-h3 text-grey-7"}," No results available ",-1),X=[J],ee={class:"print-only"},ae={id:"orderReceiptPrintOut"},le={class:"q-px-lg q-pt-xl q-mb-lg"},te={class:"row q-mb-sm"},ie=(0,t._)("div",{class:"col-3"},"Name:",-1),se={class:"col"},ne={class:"row"},oe=(0,t._)("div",{class:"col-3"},"Transaction:",-1),de={class:"col"},re=(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th",null,"Qty"),(0,t._)("th",null,"Item"),(0,t._)("th",null,"Amount")])],-1),ue={class:"text-weight-bold"},me=(0,t._)("td",{colspan:"2",class:"text-right"},"Total",-1),ce={class:"text-center"},pe={class:"text-weight-bold"},_e=(0,t._)("td",{colspan:"2",class:"text-right"},"Paid",-1),we={class:"text-center"},ge={class:"text-weight-bold"},fe=(0,t._)("td",{colspan:"2",class:"text-right"},"Balance",-1),ve={class:"text-center"},ye=(0,t._)("div",{class:"q-py-md"},null,-1),be={class:"column q-col-gutter-y-sm q-mt-sm q-mx-lg q-mb-xl"},he={class:"q-mb-md"},qe={class:"q-px-lg q-pt-lg"},xe={style:{minWidth:"100%",width:"100%"}},De={class:"q-px-lg q-pt-xl q-mb-lg"},We={class:"row q-mb-sm"},ke=(0,t._)("div",{class:"col-3"},"Name:",-1),ze={class:"col"},Ve={class:"row"},Pe=(0,t._)("div",{class:"col-3"},"Transaction:",-1),Ce={class:"col"},He=(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th",null,"Qty"),(0,t._)("th",null,"Item"),(0,t._)("th",null,"Amount")])],-1),Se={class:"text-weight-bold"},Ze=(0,t._)("td",{colspan:"2",class:"text-right"},"Total",-1),Qe={class:"text-center"},Ie={class:"text-weight-bold"},Re=(0,t._)("td",{colspan:"2",class:"text-right"},"Paid",-1),Ue={class:"text-center"},Te={class:"text-weight-bold"},Ke=(0,t._)("td",{colspan:"2",class:"text-right"},"Balance",-1),Ye={class:"text-center"},Oe={class:"q-px-md column q-gutter-y-md"},je=(0,t._)("div",{class:"q-py-md"},null,-1);function $e(e,a,l,Y,B,J){const $e=(0,t.up)("q-separator"),Ae=(0,t.up)("q-input"),Le=(0,t.up)("q-popup-edit"),Be=(0,t.up)("q-btn"),Fe=(0,t.up)("q-field"),Ne=(0,t.up)("q-markup-table"),Ee=(0,t.up)("q-form"),Me=(0,t.up)("q-scroll-area"),Ge=(0,t.up)("q-icon"),Je=(0,t.up)("q-card-section"),Xe=(0,t.up)("q-tooltip"),ea=(0,t.up)("q-card-actions"),aa=(0,t.up)("q-card"),la=(0,t.up)("q-tab-panel"),ta=(0,t.up)("q-tab-panels"),ia=(0,t.up)("q-splitter"),sa=(0,t.up)("q-item-section"),na=(0,t.up)("q-item-label"),oa=(0,t.up)("q-item"),da=(0,t.up)("q-tab"),ra=(0,t.up)("q-tabs"),ua=(0,t.up)("q-list"),ma=(0,t.up)("q-spinner-ios"),ca=(0,t.up)("q-inner-loading"),pa=(0,t.up)("q-page"),_a=(0,t.up)("q-toolbar-title"),wa=(0,t.up)("q-toolbar"),ga=(0,t.up)("balance-calculator-component"),fa=(0,t.up)("q-expansion-item"),va=(0,t.up)("money-input-component"),ya=(0,t.up)("q-select"),ba=(0,t.up)("q-dialog"),ha=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(pa,{class:"q-mx-lg q-mt-md",style:{minHeight:"400px !important"}},{default:(0,t.w5)((()=>[n,(0,t.Wm)($e,{class:"q-my-sm bg-dark"}),(0,t._)("div",o,[(0,t.Wm)(ia,{modelValue:e.layoutSplitter,"onUpdate:modelValue":a[10]||(a[10]=a=>e.layoutSplitter=a),style:{height:"75vh"},class:"overflow-hidden"},{before:(0,t.w5)((()=>[(0,t.Wm)(ia,{modelValue:e.innerLayoutSplitter,"onUpdate:modelValue":a[7]||(a[7]=a=>e.innerLayoutSplitter=a),class:"overflow-hidden full-height"},{before:(0,t.w5)((()=>[(0,t.Wm)(Me,{class:"full-height",style:{maxWidth:"33vw"}},{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t._)("div",r,[(0,t.Wm)(Ee,{ref:"saleForm",onSubmit:e.submitOrder},{default:(0,t.w5)((()=>[(0,t._)("div",u,[(0,t._)("div",m,[(0,t._)("div",c,[p,(0,t._)("div",_,[(0,t.Wm)(Ae,{dense:"",outlined:"",modelValue:e.saleData.customer.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.saleData.customer.name=a)},null,8,["modelValue"])])]),(0,t._)("div",w,[g,(0,t._)("div",f,[(0,t.Wm)(Ae,{dense:"",outlined:"",mask:"### ### ######","unmasked-value":"",modelValue:e.saleData.customer.contact,"onUpdate:modelValue":a[1]||(a[1]=a=>e.saleData.customer.contact=a)},null,8,["modelValue"])])]),(0,t._)("div",v,[y,(0,t._)("div",b,[(0,t.Wm)(Ae,{dense:"",outlined:"",type:"textarea",rows:"1",modelValue:e.saleData.customer.address,"onUpdate:modelValue":a[2]||(a[2]=a=>e.saleData.customer.address=a)},null,8,["modelValue"])])])]),(0,t.Wm)(Fe,{ref:"saleItemsTable",outlined:e.$refs.saleItemsTable&&e.$refs.saleItemsTable.hasError,borderless:e.$refs.saleItemsTable&&!e.$refs.saleItemsTable.hasError,"no-error-icon":"",modelValue:e.saleData.items,"onUpdate:modelValue":a[3]||(a[3]=a=>e.saleData.items=a),"lazy-rules":"ondemand",rules:e.nonEmptyRequiredRules()},{control:(0,t.w5)((()=>[(0,t._)("div",h,[(0,t.Wm)(Ne,{flat:"",square:"",dense:"",bordered:"","wrap-cells":""},{default:(0,t.w5)((()=>[q,(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.saleData.items,((a,l)=>((0,t.wg)(),(0,t.iD)("tr",{key:a.key},[(0,t._)("td",null,[(0,t._)("div",x,(0,i.zw)(a.item.name)+" ("+(0,i.zw)(a.sale_rate.unit)+") ",1),(0,t._)("div",D," @ "+(0,i.zw)(e.formatPrice(a.sale_rate.final_amount)),1)]),(0,t._)("td",null,[(0,t.Wm)(Fe,{outlined:"",dense:""},{control:(0,t.w5)((()=>[(0,t._)("div",W,(0,i.zw)(a.quantity),1),(0,t.Wm)(Le,{modelValue:a.quantity,"onUpdate:modelValue":e=>a.quantity=e,"auto-save":""},{default:(0,t.w5)((e=>[(0,t.Wm)(Ae,{type:"number",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,dense:"",autofocus:"",onKeyup:(0,s.D2)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),prepend:(0,t.w5)((()=>[(0,t.Wm)(Be,{outline:"",round:"",dense:"",size:"sm",color:"primary",icon:"remove",onClick:e=>1!=a.quantity?a.quantity=a.quantity-1:a.quantity=a.quantity},null,8,["onClick"])])),append:(0,t.w5)((()=>[(0,t.Wm)(Be,{outline:"",round:"",dense:"",size:"sm",color:"primary",icon:"add",onClick:e=>a.quantity=a.quantity+1},null,8,["onClick"])])),_:2},1024)]),(0,t._)("td",null,[(0,t.Wm)(Be,{round:"",dense:"",size:"sm",color:"red",icon:"delete",onClick:a=>e.removeItem(l)},null,8,["onClick"])])])))),128))]),(0,t._)("tfoot",k,[e.saleData.items.length>0?((0,t.wg)(),(0,t.iD)("tr",z,[V,(0,t._)("td",P,(0,i.zw)(e.formatPrice(e.saleTotal)),1)])):(0,t.kq)("",!0)])])),_:1})])])),_:1},8,["outlined","borderless","modelValue","rules"]),(0,t._)("div",C,[H,(0,t.Wm)(Be,{unelevated:"","no-caps":"",rounded:"",label:"Add Payment",color:"primary","icon-right":"add",onClick:a[4]||(a[4]=a=>e.addPaymentDialog=!e.addPaymentDialog)})]),(0,t.Wm)(Ne,{flat:"",dense:""},{default:(0,t.w5)((()=>[(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.saleData.payments,((a,l)=>((0,t.wg)(),(0,t.iD)("tr",{key:l},[(0,t._)("td",S,(0,i.zw)(a.method.name),1),(0,t._)("td",Z,(0,i.zw)(e.formatPrice(a.amount)),1),(0,t._)("td",null,[(0,t.Wm)(Be,{round:"",size:"sm",color:"red",icon:"delete",onClick:a=>e.removePayment(l)},null,8,["onClick"])])])))),128))])])),_:1})]),(0,t._)("div",Q,[(0,t.Wm)(Be,{rounded:"",color:"primary",label:"Save Order",type:"submit",loading:e.submitting,class:"full-width"},null,8,["loading"])])])),_:1},8,["onSubmit"])])])])),_:1})])),after:(0,t.w5)((()=>[(0,t.Wm)(Me,{class:"fit"},{default:(0,t.w5)((()=>[(0,t._)("div",I,[(0,t.Wm)(Ae,{dense:"",clearable:"",rounded:"",standout:"bg-blue-8",type:"search",placeholder:"Search here ...",modelValue:e.searchFilter,"onUpdate:modelValue":a[5]||(a[5]=a=>e.searchFilter=a)},{prepend:(0,t.w5)((()=>[(0,t.Wm)(Ge,{name:"search"})])),_:1},8,["modelValue"])]),(0,t.Wm)(ta,{animated:"",swipeable:"",vertical:"","transition-prev":"slide-down","transition-next":"slide-up",modelValue:e.tab,"onUpdate:modelValue":a[6]||(a[6]=a=>e.tab=a)},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.pageData1,(a=>((0,t.wg)(),(0,t.j4)(la,{key:"bar-tab-panel-"+a.id,name:"bar-category-"+a.name},{default:(0,t.w5)((()=>[(0,t._)("div",R,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.brands,((a,l)=>((0,t.wg)(),(0,t.iD)("div",{key:"bar-item-"+a.id,class:(0,i.C_)([0==l?"q-pl-sm":""])},[(0,t.Wm)(aa,{flat:"",class:"fit"},{default:(0,t.w5)((()=>[(0,t.Wm)(Je,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t._)("div",U,(0,i.zw)(a.name),1)])),_:2},1024),(0,t.Wm)(ea,null,{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.units_available_details,(l=>((0,t.wg)(),(0,t.iD)("div",{class:"column",key:"details-"+l.id},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.sale_rates,(l=>((0,t.wg)(),(0,t.j4)(Be,{key:"sale_rate"+l.id,size:"0.89rem",flat:"","no-caps":"",onClick:t=>e.addItem({tag:a.tag,item:{id:a.id,name:a.name},sale_rate:{...l},key:`${a.tag}-${a.id}${l.id}`})},{default:(0,t.w5)((()=>[(0,t._)("span",T,[(0,t.Uk)((0,i.zw)(l.unit)+" @ "+(0,i.zw)(e.formatPrice(l.final_amount))+" ",1),l.discount>0?((0,t.wg)(),(0,t.j4)(Ge,{key:0,color:"green",name:"sell"},{default:(0,t.w5)((()=>[(0,t.Wm)(Xe,{anchor:"center right",self:"center left"},{default:(0,t.w5)((()=>[(0,t._)("div",null," Original Price: "+(0,i.zw)(e.formatPrice(l.amount)),1),(0,t._)("div",null," Discount: "+(0,i.zw)(l.discount)+"% ",1),(0,t._)("div",null," Current Price: "+(0,i.zw)(e.formatPrice(l.final_amount)),1)])),_:2},1024)])),_:2},1024)):(0,t.kq)("",!0)])])),_:2},1032,["onClick"])))),128))])))),128))])),_:2},1024)])),_:2},1024)],2)))),128)),0==a.brands.length?((0,t.wg)(),(0,t.iD)("div",K,O)):(0,t.kq)("",!0)])])),_:2},1032,["name"])))),128)),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.pageData2,(a=>((0,t.wg)(),(0,t.j4)(la,{key:"restaurant-tab-panel-"+a.id,name:"restaurant-category-"+a.name},{default:(0,t.w5)((()=>[(0,t._)("div",j,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.items,((a,l)=>((0,t.wg)(),(0,t.iD)("div",{key:"restaurant-item-"+a.id,class:(0,i.C_)([0==l?"q-pl-sm":""])},[(0,t.Wm)(aa,{class:"fit"},{default:(0,t.w5)((()=>[(0,t.Wm)(Je,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t._)("div",$,(0,i.zw)(a.name),1)])),_:2},1024),(0,t.Wm)(ea,null,{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.units_available_details,(l=>((0,t.wg)(),(0,t.iD)("div",{class:"column",key:"details-"+l.id},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.sale_rates,(l=>((0,t.wg)(),(0,t.j4)(Be,{key:"sale_rate"+l.id,size:"0.89rem",flat:"","no-caps":"",onClick:t=>e.addItem({tag:a.tag,item:{id:a.id,name:a.name},sale_rate:{...l},key:`${a.tag}-${a.id}${l.id}`})},{default:(0,t.w5)((()=>[(0,t._)("span",A,[(0,t.Uk)((0,i.zw)(l.unit)+" @ "+(0,i.zw)(e.formatPrice(l.final_amount))+" ",1),l.discount>0?((0,t.wg)(),(0,t.j4)(Ge,{key:0,color:"green",name:"sell"},{default:(0,t.w5)((()=>[(0,t.Wm)(Xe,{anchor:"center right",self:"center left"},{default:(0,t.w5)((()=>[(0,t._)("div",null," Original Price: "+(0,i.zw)(e.formatPrice(l.amount)),1),(0,t._)("div",null," Discount: "+(0,i.zw)(l.discount)+"% ",1),(0,t._)("div",null," Current Price: "+(0,i.zw)(e.formatPrice(l.final_amount)),1)])),_:2},1024)])),_:2},1024)):(0,t.kq)("",!0)])])),_:2},1032,["onClick"])))),128))])))),128))])),_:2},1024)])),_:2},1024)],2)))),128)),0==a.items.length?((0,t.wg)(),(0,t.iD)("div",L,F)):(0,t.kq)("",!0)])])),_:2},1032,["name"])))),128)),(0,t.Wm)(la,{name:"search-results"},{default:(0,t.w5)((()=>[(0,t._)("div",N,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.searchResults,((a,l)=>((0,t.wg)(),(0,t.iD)("div",{key:a.tag+"-search-result-item-"+a.id,class:(0,i.C_)([0==l?"q-pl-sm":""])},[(0,t.Wm)(aa,{class:"fit"},{default:(0,t.w5)((()=>[(0,t.Wm)(Je,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t._)("div",E,(0,i.zw)(a.name),1)])),_:2},1024),(0,t.Wm)(ea,null,{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.units_available_details,(l=>((0,t.wg)(),(0,t.iD)("div",{class:"column",key:a.tag+"-details-"+l.id},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.sale_rates,(l=>((0,t.wg)(),(0,t.j4)(Be,{key:a.tag+"-sale_rate"+l.id,size:"0.89rem",flat:"","no-caps":"",onClick:t=>e.addItem({tag:a.tag,item:{id:a.id,name:a.name},sale_rate:{...l},key:`${a.tag}-${a.id}${l.id}`})},{default:(0,t.w5)((()=>[(0,t._)("span",M,[(0,t.Uk)((0,i.zw)(l.unit)+" @ "+(0,i.zw)(e.formatPrice(l.final_amount))+" ",1),l.discount>0?((0,t.wg)(),(0,t.j4)(Ge,{key:0,color:"green",name:"sell"},{default:(0,t.w5)((()=>[(0,t.Wm)(Xe,{anchor:"center right",self:"center left"},{default:(0,t.w5)((()=>[(0,t._)("div",null," Original Price: "+(0,i.zw)(e.formatPrice(l.amount)),1),(0,t._)("div",null," Discount: "+(0,i.zw)(l.discount)+"% ",1),(0,t._)("div",null," Current Price: "+(0,i.zw)(e.formatPrice(l.final_amount)),1)])),_:2},1024)])),_:2},1024)):(0,t.kq)("",!0)])])),_:2},1032,["onClick"])))),128))])))),128))])),_:2},1024)])),_:2},1024)],2)))),128)),0==e.searchResults.length?((0,t.wg)(),(0,t.iD)("div",G,X)):(0,t.kq)("",!0)])])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])])),after:(0,t.w5)((()=>[(0,t.Wm)(Me,{class:"fit inset-shadow"},{default:(0,t.w5)((()=>[(0,t.Wm)(ua,{class:"q-pb-xl"},{default:(0,t.w5)((()=>[(0,t.Wm)(oa,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(sa,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Ge,{color:"white",name:"local_bar"})])),_:1}),(0,t.Wm)(sa,null,{default:(0,t.w5)((()=>[(0,t.Wm)(na,{class:"text-weight-bold"},{default:(0,t.w5)((()=>[(0,t.Uk)("Bar")])),_:1})])),_:1})])),_:1}),(0,t.Wm)(oa,null,{default:(0,t.w5)((()=>[(0,t.Wm)(ra,{vertical:"",modelValue:e.tab,"onUpdate:modelValue":a[8]||(a[8]=a=>e.tab=a),"active-color":"orange-10",class:"full-width"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.pageData1,(e=>((0,t.wg)(),(0,t.j4)(da,{key:"bar-tab-"+e.id,name:"bar-category-"+e.name,label:e.name},null,8,["name","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(oa,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(sa,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Ge,{color:"white",name:"emoji_food_beverage"})])),_:1}),(0,t.Wm)(sa,null,{default:(0,t.w5)((()=>[(0,t.Wm)(na,{class:"text-weight-bold"},{default:(0,t.w5)((()=>[(0,t.Uk)("Restaurant")])),_:1})])),_:1})])),_:1}),(0,t.Wm)(oa,null,{default:(0,t.w5)((()=>[(0,t.Wm)(ra,{vertical:"",modelValue:e.tab,"onUpdate:modelValue":a[9]||(a[9]=a=>e.tab=a),"active-color":"orange-10",class:"full-width"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.pageData2,(e=>((0,t.wg)(),(0,t.j4)(da,{key:"restaurant-tab-"+e.id,name:"restaurant-category-"+e.name,label:e.name},null,8,["name","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(ca,{showing:e.loadingData,class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(ma,{color:"primary",size:"5rem"})])),_:1},8,["showing"])]),(0,t._)("div",ee,[(0,t._)("div",ae,[(0,t.Wm)(aa,{class:"window-width"},{default:(0,t.w5)((()=>[(0,t.Wm)(Je,{class:"window-width"},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t._)("div",le,[(0,t._)("div",te,[ie,(0,t._)("div",se,(0,i.zw)(e.receiptData.customer.name),1)]),(0,t._)("div",ne,[oe,(0,t._)("div",de,(0,i.zw)(e.receiptData.id),1)])]),(0,t.Wm)(Ne,{"wrap-cells":"",bordered:"",flat:"",cell:"horizontal",class:"overflow-hidden"},{default:(0,t.w5)((()=>[re,(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.receiptData.sales,(a=>((0,t.wg)(),(0,t.iD)("tr",{key:a.id,class:"text-center"},[(0,t._)("td",null,(0,i.zw)(a.quantity),1),(0,t._)("td",null,(0,i.zw)(a.item_name),1),(0,t._)("td",null,(0,i.zw)(e.formatPrice(a.unit_price*a.quantity)),1)])))),128)),(0,t._)("tr",ue,[me,(0,t._)("td",ce,(0,i.zw)(e.formatPrice(e.receiptData.bill)),1)]),(0,t._)("tr",pe,[_e,(0,t._)("td",we,(0,i.zw)(e.formatPrice(e.receiptData.paid)),1)]),(0,t._)("tr",ge,[fe,(0,t._)("td",ve,(0,i.zw)(e.formatPrice(e.receiptData.bill-e.receiptData.paid)),1)])])])),_:1}),ye])])),_:1})])),_:1})])])])),_:1}),(0,t.Wm)(ba,{modelValue:e.addPaymentDialog,"onUpdate:modelValue":a[13]||(a[13]=a=>e.addPaymentDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(aa,{style:{width:"400px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(Ee,{ref:"paymentForm",onSubmit:e.addPayment},{default:(0,t.w5)((()=>[(0,t.Wm)(wa,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(_a,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Payment")])),_:1}),(0,t.wy)((0,t.Wm)(Be,{flat:"",round:"",size:"md",icon:"close"},null,512),[[ha]])])),_:1}),(0,t.Wm)($e),(0,t._)("div",be,[(0,t._)("div",he,[(0,t.Wm)(fa,{dense:"","dense-toggle":"",label:"Balance Calculator","header-class":"text-primary",class:"rounded-borders",style:(0,i.j5)({border:"1px solid var(--q-primary)"})},{default:(0,t.w5)((()=>[(0,t.Wm)(ga,{defaultAmount:e.saleTotal-e.itemsSum(e.saleData.payments)},null,8,["defaultAmount"])])),_:1},8,["style"])]),(0,t.Wm)(va,{modelValue:e.paymentData.amount,"onUpdate:modelValue":a[11]||(a[11]=a=>e.paymentData.amount=a),"input-class":"text-h6",label:"Amount"},null,8,["modelValue"]),(0,t.Wm)(ya,{outlined:"",modelValue:e.paymentData.method,"onUpdate:modelValue":a[12]||(a[12]=a=>e.paymentData.method=a),label:"Mode of payment",options:e.paymentMethodOptions,"option-label":"name","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.paymentMethodOptions)},null,8,["modelValue","options","rules"]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Object.keys(e.fields),((a,l)=>((0,t.wg)(),(0,t.j4)(Ae,{outlined:"",key:l,"model-value":e.fields[a],"onUpdate:modelValue":l=>e.fields[a]=l,label:a},null,8,["model-value","onUpdate:modelValue","label"])))),128)),(0,t._)("div",qe,[(0,t.Wm)(Be,{rounded:"","no-caps":"",color:"primary",label:"Add Payment",class:"full-width",type:"submit"})])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(ba,{modelValue:e.orderReceipt,"onUpdate:modelValue":a[15]||(a[15]=a=>e.orderReceipt=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(aa,{style:{minWidth:"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(wa,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(_a,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Receipt # "+(0,i.zw)(e.receiptData.id),1)])),_:1}),(0,t.wy)((0,t.Wm)(Be,{flat:"",round:"",size:"md",icon:"close",onClick:e.clearReceiptData},null,8,["onClick"]),[[ha]])])),_:1}),(0,t.Wm)(Je,null,{default:(0,t.w5)((()=>[(0,t._)("div",xe,[(0,t._)("div",De,[(0,t._)("div",We,[ke,(0,t._)("div",ze,(0,i.zw)(e.receiptData.customer.name),1)]),(0,t._)("div",Ve,[Pe,(0,t._)("div",Ce,(0,i.zw)(e.receiptData.id),1)])]),(0,t.Wm)(Ne,{"wrap-cells":"",bordered:"",flat:"",cell:"horizontal",class:"overflow-hidden"},{default:(0,t.w5)((()=>[He,(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.receiptData.sales,(a=>((0,t.wg)(),(0,t.iD)("tr",{key:a.id,class:"text-center"},[(0,t._)("td",null,(0,i.zw)(a.quantity),1),(0,t._)("td",null,(0,i.zw)(a.item_name),1),(0,t._)("td",null,(0,i.zw)(e.formatPrice(a.unit_price*a.quantity)),1)])))),128)),(0,t._)("tr",Se,[Ze,(0,t._)("td",Qe,(0,i.zw)(e.formatPrice(e.receiptData.bill)),1)]),(0,t._)("tr",Ie,[Re,(0,t._)("td",Ue,(0,i.zw)(e.formatPrice(e.receiptData.paid)),1)]),(0,t._)("tr",Te,[Ke,(0,t._)("td",Ye,(0,i.zw)(e.formatPrice(e.receiptData.bill-e.receiptData.paid)),1)])])])),_:1}),(0,t._)("div",Oe,[e.$q.platform.is.electron?((0,t.wg)(),(0,t.j4)(Be,{key:0,rounded:"",label:"print",icon:"print",color:"primary",class:"full-width",onClick:a[14]||(a[14]=a=>e.printDocument("orderReceiptPrintOut",e.printingSettings)),disable:e.printingSettings.automatic_printing||!e.$q.platform.is.electron},null,8,["disable"])):(0,t.kq)("",!0),(0,t.Wm)(Be,{rounded:"",label:"View Sale",color:"primary",class:"full-width",to:{name:"RestaurantAndBarSalesDetails",params:{Id:parseInt(e.receiptData.id)}}},null,8,["to"]),(0,t.Wm)(Be,{rounded:"",label:"Goto Sales",color:"primary",class:"full-width",to:{name:"RestaurantAndBarSales"}})]),je])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}l(9665);var Ae=l(9302),Le=(l(4170),l(499)),Be=l(8339),Fe=l(2580),Ne=l(9258),Ee=l(8221),Me=l(4019);const Ge=(0,t.aZ)({name:"CreateRestaurantAndBarSales",components:{MoneyInputComponent:Fe.Z,BalanceCalculatorComponent:Ne.Z},setup(){const e=(0,Ae.Z)(),a=((0,Be.tv)(),(0,Le.iH)(null)),l=(0,Le.iH)(!1),i=(0,Le.iH)([]),s=(0,Le.iH)([]),n=(0,Le.iH)(86),o=(0,Le.iH)(33),d=(0,Le.iH)(!1),r=(0,Le.iH)({}),u=(0,Le.iH)([]),m=(0,Le.iH)(null),c=(0,Le.iH)({}),p=(0,Le.iH)(null),_=(0,Le.iH)({customer:{},items:[],payments:[]}),w=(0,t.Fl)((()=>_.value.items.length>0?_.value.items.reduce(((e,a)=>e+a.quantity*a.sale_rate.final_amount),0):0)),g=(0,Le.iH)(!1),f={customer:{},sales:[],payments:[]},v=(0,Le.iH)({...f}),y=(0,Le.iH)(!1),b=(0,Le.iH)(null),h=(0,Le.iH)(""),q=(0,Le.iH)([]),x=(0,Le.iH)({});function D(){return(0,Ee.permissionRequired)("restaurant","add_itemsale")?(0,Me.getRestaurantCategoriesWithItems)().then((e=>{s.value=e.data.map((e=>(e.items=e.items.filter((e=>(0,Ee.parseFractionString)(e.units_available)>0||e.prepared_on_order)),e.items=e.items.map((e=>({...e,tag:"restaurant"}))),e)));let l=s.value.find((e=>e.items.length>0));a.value=l?"restaurant-category-"+l.name:null})):new Promise(((e,a)=>e()))}function W(){return i.value=[],(0,Ee.permissionRequired)("bar","add_brandsale")?(0,Me.getBarCategoriesWithBrands)().then((e=>{i.value=e.data.map((e=>(e.brands=e.brands.filter((e=>(0,Ee.parseFractionString)(e.units_available)>0)),e.brands=e.brands.map((e=>({...e,tag:"bar"}))),e)))})):new Promise(((e,a)=>e()))}function k(){return(0,Me.getPaymentMethods)().then((e=>{u.value=e.data}))}function z(){return(0,Me.getGeneralSettings)("?name=PRINTERS").then((e=>{x.value=e.data.details["items"].find((e=>"bar and restaurant receipts"==e.item))||e.data.details["items"].find((e=>"receipts"==e.item))}))}return(0,t.m0)((()=>{null!=b.value&&""!=b.value&&b.value.length>0?(q.value=[],"search-results"!=a.value&&(h.value=a.value),i.value.forEach((e=>{q.value.push(...e.brands.filter((e=>e.name.toLocaleLowerCase().indexOf(b.value.toLocaleLowerCase())>-1)))})),s.value.forEach((e=>{q.value.push(...e.items.filter((e=>e.name.toLocaleLowerCase().indexOf(b.value.toLocaleLowerCase())>-1)))})),a.value="search-results"):a.value=h.value})),(0,t.m0)((()=>{r.value&&r.value.method&&r.value.method.other_details&&r.value.method.other_details.fields?c.value=r.value.method.other_details.fields.reduce(((e,a)=>({...e,[a]:null})),{}):c.value={}})),(0,t.bv)((()=>{l.value=!0,W().finally((()=>{D().finally((()=>{k().finally((()=>{l.value=!1,z()}))}))}))})),{loadingData:l,layoutSplitter:n,innerLayoutSplitter:o,pageData1:i,pageData2:s,tab:a,receiptData:v,orderReceipt:y,saleForm:p,saleData:_,addPaymentDialog:d,paymentData:r,paymentMethodOptions:u,fields:c,saleTotal:w,submitting:g,printingSettings:x,paymentForm:m,searchFilter:b,searchResults:q,clearReceiptData(){v.value={...f}},addPayment(){m.value.validate()&&(_.value.payments.push({...r.value,other_details:{...c.value}}),r.value={},d.value=!1,m.value.resetValidation())},addItem(e){let a=_.value.items.find((a=>a.key==e.key));null!=a?a.quantity=a.quantity+1:(e.quantity=1,_.value.items.push(e)),p.value.resetValidation()},removeItem(a){e.dialog({message:"Confirm?",cancel:!0}).onOk((()=>{_.value.items.splice(a,1)}))},removePayment(a){e.dialog({message:"Confirm?",cancel:!0}).onOk((()=>{_.value.payments.splice(a,1)}))},submitOrder(){e.dialog({message:"Please confirm order?",cancel:!0}).onOk((()=>{if(p.value.validate()){g.value=!0;let a=_.value.payments.map((e=>({id:e.method.id,amount:e.amount,other_details:e.other_details}))),l=_.value.items.map((e=>({item:e.tag,sale_rate:e.sale_rate.id,quantity:e.quantity})));(0,Me.createRestaurantAndBarSale)({..._.value,payments:a,items:l}).then((a=>{_.value={customer:{},items:[],payments:[]},(0,Ee.displayNotification)(a.data.message,"positive"),v.value=a.data.sale,y.value=!0,p.value.resetValidation(),e.platform.is.electron&&x.value.automatic_printing&&(0,Ee.printDocument)("orderReceiptPrintOut",x.value)})).catch((e=>{console.log(e),(0,Ee.displayNotification)(e,"negative",{error:!0})})).finally((()=>{g.value=!1}))}}))}}}});var Je=l(1639),Xe=l(9885),ea=l(926),aa=l(7498),la=l(6663),ta=l(8326),ia=l(6611),sa=l(8149),na=l(6933),oa=l(5863),da=l(8879),ra=l(2857),ua=l(9800),ma=l(4106),ca=l(4458),pa=l(3190),_a=l(1821),wa=l(6858),ga=l(3246),fa=l(490),va=l(1233),ya=l(3115),ba=l(7817),ha=l(900),qa=l(854),xa=l(8359),Da=l(2074),Wa=l(1663),ka=l(1973),za=l(651),Va=l(4581),Pa=l(2146),Ca=l(9984),Ha=l.n(Ca);const Sa=(0,Je.Z)(Ge,[["render",$e]]),Za=Sa;Ha()(Ge,"components",{QPage:Xe.Z,QSeparator:ea.Z,QSplitter:aa.Z,QScrollArea:la.Z,QForm:ta.Z,QInput:ia.Z,QField:sa.Z,QMarkupTable:na.Z,QPopupEdit:oa.Z,QBtn:da.Z,QIcon:ra.Z,QTabPanels:ua.Z,QTabPanel:ma.Z,QCard:ca.Z,QCardSection:pa.Z,QCardActions:_a.Z,QTooltip:wa.Z,QList:ga.Z,QItem:fa.Z,QItemSection:va.Z,QItemLabel:ya.Z,QTabs:ba.Z,QTab:ha.Z,QInnerLoading:qa.Z,QSpinnerIos:xa.Z,QDialog:Da.Z,QToolbar:Wa.Z,QToolbarTitle:ka.Z,QExpansionItem:za.Z,QSelect:Va.Z}),Ha()(Ge,"directives",{ClosePopup:Pa.Z})}}]);