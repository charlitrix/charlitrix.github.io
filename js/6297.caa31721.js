"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[6297],{6297:(e,l,t)=>{t.r(l),t.d(l,{default:()=>N});var a=t(9835),u=t(6970);const i={class:"q-px-xl q-pb-xl q-pt-lg column q-gutter-y-lg"},o=(0,a._)("div",{class:"text-h5"},"Budget Item Details",-1),n={class:"column q-gutter-y-md q-mb-sm"},m={class:"row justify-between"},d=(0,a._)("div",{class:"q-mx-md"},"Actions",-1),s={class:"row no-wrap"};function r(e,l,t,r,c,p){const g=(0,a.up)("q-input"),w=(0,a.up)("q-item-label"),f=(0,a.up)("q-item-section"),b=(0,a.up)("q-item"),v=(0,a.up)("q-separator"),W=(0,a.up)("q-btn"),_=(0,a.up)("q-list"),y=(0,a.up)("q-card"),q=(0,a.up)("q-spinner-ios"),I=(0,a.up)("q-inner-loading"),Z=(0,a.up)("q-page"),Q=(0,a.up)("q-toolbar-title"),S=(0,a.up)("q-toolbar"),h=(0,a.up)("q-card-section"),k=(0,a.up)("q-card-actions"),D=(0,a.up)("q-form"),x=(0,a.up)("q-dialog"),C=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(Z,{class:"q-pa-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{flat:"",class:"q-mb-xl"},{default:(0,a.w5)((()=>[(0,a._)("div",i,[o,(0,a._)("div",n,[(0,a.Wm)(g,{readonly:"",label:"Code","model-value":e.categoryData.code},null,8,["model-value"]),(0,a.Wm)(g,{readonly:"",label:"Name","model-value":e.categoryData.name},null,8,["model-value"]),(0,a.Wm)(g,{readonly:"",label:"Amount","model-value":e.formatPrice(e.itemsSum(e.categoryData.items))},null,8,["model-value"])]),(0,a._)("div",m,[(0,a._)("div",{class:"text-grey-9",style:(0,u.j5)({fontSize:"1.2rem"})}," Budget Items ",4)]),(0,a._)("div",null,[(0,a.Wm)(_,{separator:""},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"text-weight-medium"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Code")])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Name")])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Amount")])),_:1})])),_:1}),(0,a.Wm)(f,{side:""},{default:(0,a.w5)((()=>[d])),_:1})])),_:1}),(0,a.Wm)(v,{class:"bg-grey-7"}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.categoryData.items,((l,t)=>((0,a.wg)(),(0,a.j4)(b,{key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(l.code),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(l.name),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(e.formatPrice(l.amount)),1)])),_:2},1024),(0,a.Wm)(f,{side:""},{default:(0,a.w5)((()=>[(0,a._)("div",s,[(0,a.Wm)(W,{flat:"",round:"",color:"primary",icon:"edit",onClick:l=>e.selectEditItem(t),loading:e.submitting},null,8,["onClick","loading"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])])),_:1}),(0,a.Wm)(I,{dark:"",showing:e.loadingData},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{size:"50px",color:"white"})])),_:1},8,["showing"])])),_:1}),(0,a.Wm)(x,{persistent:"",modelValue:e.editSubItemDialog,"onUpdate:modelValue":l[1]||(l[1]=l=>e.editSubItemDialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{style:{width:"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{ref:"editSubItemForm",onSubmit:e.updateSubItem},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"bg-primary text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(Q,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Update Amount")])),_:1}),(0,a.wy)((0,a.Wm)(W,{flat:"",round:"",size:"md",icon:"close"},null,512),[[C]])])),_:1}),(0,a.Wm)(v),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:e.editSubItem.amount,"onUpdate:modelValue":l[0]||(l[0]=l=>e.editSubItem.amount=l),modelModifiers:{number:!0},type:"number",label:"Amount","lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,a.Wm)(g,{type:"textarea",rows:"4",label:"Reason"})])),_:1}),(0,a.Wm)(k,{align:"evenly",class:"q-mb-lg q-mx-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{rounded:"",label:"Update",class:"full-width",color:"primary",loading:e.submitting},null,8,["loading"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var c=t(499),p=t(9302),g=t(8221),w=t(4019);const f=(0,a.aZ)({name:"BudgetDetails",props:["id"],setup(e){const l=(0,p.Z)(),t=(0,c.iH)({items:[]}),u=((0,c.iH)({}),(0,c.iH)([]),(0,c.iH)(!1),(0,c.iH)(!1),(0,c.iH)(!0)),i=(0,c.iH)(!1),o=(0,c.iH)({}),n=(0,c.iH)(!1),m=(0,c.iH)(null);function d(){u.value=!0,(0,w.getBudget)(`/${e.id}?category_only=True`).then((e=>{t.value=e.data})).finally((()=>{u.value=!1}))}return(0,a.bv)((()=>{d()})),{categoryData:t,loadingData:u,editSubItemDialog:i,editSubItem:o,submitting:n,editSubItemForm:m,selectEditItem(e){o.value={...t.value.items[e]},i.value=!0},updateSubItem(){m.value.validate()&&l.dialog({title:"Confirmation",message:"Confirm update",cancel:!0}).onOk((()=>{n.value=!0,(0,w.editBudgetItem)(o.value.id,{amount:o.value.amount}).then((e=>{(0,g.displayNotification)(e.data,"positive"),i.value=!1,m.value.resetValidation(),d()})).catch((e=>{(0,g.displayNotification)(e.response.data,"negative")})).finally((()=>{n.value=!1}))}))}}}});var b=t(1639),v=t(9885),W=t(4458),_=t(6611),y=t(3246),q=t(490),I=t(1233),Z=t(3115),Q=t(926),S=t(8879),h=t(854),k=t(8359),D=t(2074),x=t(8326),C=t(1663),H=t(1973),U=t(3190),z=t(1821),V=t(2146),A=t(9984),B=t.n(A);const T=(0,b.Z)(f,[["render",r]]),N=T;B()(f,"components",{QPage:v.Z,QCard:W.Z,QInput:_.Z,QList:y.Z,QItem:q.Z,QItemSection:I.Z,QItemLabel:Z.Z,QSeparator:Q.Z,QBtn:S.Z,QInnerLoading:h.Z,QSpinnerIos:k.Z,QDialog:D.Z,QForm:x.Z,QToolbar:C.Z,QToolbarTitle:H.Z,QCardSection:U.Z,QCardActions:z.Z}),B()(f,"directives",{ClosePopup:V.Z})}}]);