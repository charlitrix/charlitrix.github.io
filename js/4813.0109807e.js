"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[4813],{4813:(e,a,l)=>{l.r(a),l.d(a,{default:()=>I});var t=l(9835),o=l(6970);const n={class:"row q-mb-lg justify-between"},s={class:"row q-gutter-x-xl"},i={class:"row items-center q-gutter-x-md"},r={key:0,class:"text-grey-9 q-ml-sm"},u={key:1,class:"text-grey-9 q-ml-sm"},d={class:"row justify-end"},m={key:0,class:"text-grey-9 q-ml-sm"},p={key:1,class:"text-grey-9 q-ml-sm"},c={class:"row justify-end"},v={class:"row items-center"},f={id:"reportToPrint"};function g(e,a,l,g,b,w){const h=(0,t.up)("q-select"),D=(0,t.up)("q-form"),_=(0,t.up)("q-btn"),y=(0,t.up)("q-date"),k=(0,t.up)("q-popup-proxy"),q=(0,t.up)("q-field"),W=(0,t.up)("q-separator"),C=(0,t.up)("q-td"),R=(0,t.up)("q-tr"),P=(0,t.up)("q-table"),V=(0,t.up)("q-spinner-ios"),S=(0,t.up)("q-inner-loading"),Z=(0,t.up)("q-page"),x=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(Z,{class:"q-pa-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",s,[(0,t._)("div",null,[(0,t.Wm)(D,{ref:"stockItemForm"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedSalesOption,"onUpdate:modelValue":[a[0]||(a[0]=a=>e.selectedSalesOption=a),e.salesOptionChanged],options:e.salesOptions,"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.salesValidOptions.map((e=>e.value))),style:{minWidth:"180px"}},null,8,["modelValue","onUpdate:modelValue","options","rules"])])),_:1},512)]),(0,t._)("div",null,[(0,t.Wm)(h,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedFilter,"onUpdate:modelValue":[a[1]||(a[1]=a=>e.selectedFilter=a),e.filterOptionChanged],options:e.filterOptions},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,t._)("div",null,[(0,t._)("div",i,[(0,t.Wm)(q,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)(" From: "),e.fromDate?((0,t.wg)(),(0,t.iD)("span",r,(0,o.zw)(e.fromDate),1)):((0,t.wg)(),(0,t.iD)("span",u,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(_,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{ref:"fromDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:e.fromDate,"onUpdate:modelValue":[a[2]||(a[2]=a=>e.fromDate=a),e.fromDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t.wy)((0,t.Wm)(_,{flat:"",label:"Close",color:"primary"},null,512),[[x]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1}),(0,t.Wm)(q,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)("To: "),e.toDate?((0,t.wg)(),(0,t.iD)("span",m,(0,o.zw)(e.toDate),1)):((0,t.wg)(),(0,t.iD)("span",p,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(_,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{ref:"toDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:e.toDate,"onUpdate:modelValue":[a[3]||(a[3]=a=>e.toDate=a),e.toDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",c,[(0,t.wy)((0,t.Wm)(_,{flat:"",label:"Close",color:"primary"},null,512),[[x]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1})])])]),(0,t._)("div",v,[(0,t.Wm)(_,{unelevated:"",flat:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:a[4]||(a[4]=a=>e.printDocument("reportToPrint",e.printingSettings))}),(0,t.Wm)(W,{vertical:""}),(0,t.Wm)(_,{unelevated:"",flat:"","no-caps":"",icon:"file_download",color:"grey-9",label:"Download",onClick:a[5]||(a[5]=a=>e.printDocumentPDF("reportToPrint"))})])]),(0,t._)("div",null,[(0,t._)("div",f,[(0,t.Wm)(P,{flat:"",bordered:"",square:"","hide-pagination":"",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No stock available","loading-label":"Loading stock..."},{"bottom-row":(0,t.w5)((()=>[e.tableRows.length>0?((0,t.wg)(),(0,t.j4)(R,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{class:"text-weight-bold text-right",colspan:"5"},{default:(0,t.w5)((()=>[(0,t.Uk)("Total Sales:")])),_:1}),(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.formatPrice(e.itemsSum(e.tableRows,"total"))),1)])),_:1})])),_:1})):(0,t.kq)("",!0)])),_:1},8,["loading","columns","rows"])]),(0,t.Wm)(S,{label:"Please wait",showing:e.loadingData},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{size:"50px",color:"primary"})])),_:1},8,["showing"])])])),_:1})}var b=l(9302),w=l(499),h=l(4019),D=l(8221);const _=(0,t.aZ)({name:"ReportsIndex",setup(){(0,b.Z)();const e=(0,w.iH)(!1),a=(0,w.iH)(),l=(0,w.iH)(),o=(0,w.iH)("1"),n=(0,w.iH)("?month"),s=(0,w.iH)("month"),i=[{label:"Select Period",value:null,disable:!0},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}],r=(0,w.iH)(""),u=(0,w.iH)(""),d=(0,w.iH)(null),m=[{label:"Rooms",value:"rooms"},{label:"Bar",value:"bar"},{label:"Restaurant",value:"restaurant"},{label:"Restaurant and Bar",value:"restaurantandbar"},{label:"Services",value:"otherservices"}],p=[{label:"Select Item",value:null,disable:!0},...m],c=(0,w.iH)([]),v=(0,w.iH)(null),f=(0,w.iH)({});function g(){n.value=`?from_date=${r.value}&to_date=${u.value}`,y(),s.value=null}function _(e){return"rooms"==e?(0,h.getRoomReports)("/sales"+n.value):"bar"==e?(0,h.getRestaurantNBarReports)("/bar-sales"+n.value):"restaurant"==e?(0,h.getRestaurantNBarReports)("/restaurant-sales"+n.value):"restaurantandbar"==e?(0,h.getRestaurantNBarReports)("/sales"+n.value):"otherservices"==e?(0,h.getOtherServicesReports)("/sales"+n.value):new Promise(((e,a)=>{a()}))}function y(){v.value.validate().then((a=>{a&&(e.value=!0,c.value=[],_(d.value).then((e=>{c.value=e.data})).finally((()=>{e.value=!1})),v.value.resetValidation())}))}function k(){return(0,h.getGeneralSettings)("?name=PRINTERS").then((e=>{f.value=e.data.details["items"].find((e=>"rooms receipts"==e.item))||e.data.details["items"].find((e=>"receipts"==e.item))}))}return(0,t.bv)((()=>{k()})),{loadingData:e,toDateDialog:a,fromDateDialog:l,fromDate:r,toDate:u,tabs:o,selectedFilter:s,filterOptions:i,selectedSalesOption:d,salesOptions:p,salesValidOptions:m,tableRows:c,stockItemForm:v,printingSettings:f,tableColumns:[{label:"Date",field:"date",align:"left",name:"date"},{label:"Customer",field:"client",align:"left",name:"customer"},{label:"Created By",field:"creator",align:"left",name:"creator"},{label:"Cash",align:"left",name:"cash",field:e=>(0,D.formatPrice)(e.cash)},{label:"Credit",align:"left",name:"credit",field:e=>(0,D.formatPrice)(e.total-e.cash)},{label:"Total",align:"left",field:e=>(0,D.formatPrice)(e.total),name:"total"}],fromDateChanged(e,a,t){null!=r.value&&null!=u.value&&g(),l.value.hide()},toDateChanged(e,l,t){null!=r.value&&null!=u.value&&g(),a.value.hide()},filterOptionChanged(e){e&&(r.value=null,u.value=null,n.value=`?filter=${e}`,y())},salesOptionChanged(){null===n.value&&""==n.value||y()}}}});var y=l(1639),k=l(9885),q=l(8326),W=l(4581),C=l(8149),R=l(8879),P=l(2765),V=l(4351),S=l(926),Z=l(7355),x=l(3532),T=l(7220),O=l(854),Q=l(8359),H=l(2146),U=l(9984),F=l.n(U);const Y=(0,y.Z)(_,[["render",g]]),I=Y;F()(_,"components",{QPage:k.Z,QForm:q.Z,QSelect:W.Z,QField:C.Z,QBtn:R.Z,QPopupProxy:P.Z,QDate:V.Z,QSeparator:S.Z,QTable:Z.Z,QTr:x.Z,QTd:T.Z,QInnerLoading:O.Z,QSpinnerIos:Q.Z}),F()(_,"directives",{ClosePopup:H.Z})}}]);