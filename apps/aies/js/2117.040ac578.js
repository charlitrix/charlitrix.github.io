"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[2117],{2117:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Fa});var l=t(9835),u=t(6970);const o={class:"row justify-around text-weight-bold q-mt-md items-center"},s={class:"row no-wrap"},d={key:1,class:"q-ml-sm"},n={class:"row no-wrap"},i={class:"col-md-4 column"},m={class:"row items-center q-col-gutter-x-xl"},r=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Customer Details",-1),c={key:0},p={class:"col-md-7 column"},_=(0,l._)("div",{class:"text-weight-bold q-my-md"},"Rooms",-1),w=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Room"),(0,l._)("th",null,"Arrival"),(0,l._)("th",null,"Departure"),(0,l._)("th",null,"Price"),(0,l._)("th",null,"Quantity"),(0,l._)("th",null,"Amount")])],-1),g={class:"text-nowrap"},v={key:1,class:"row q-mt-xl"},y={class:"col-7"},D=(0,l._)("div",{class:"text-weight-bold"},"Payments",-1),f={class:"q-mt-md"},b=(0,l._)("thead",{class:"bg-primary text-white"},[(0,l._)("tr",null,[(0,l._)("th",null,"Amount"),(0,l._)("th",null,"Mode of payment"),(0,l._)("th",null,"Details"),(0,l._)("th",null,"Date")])],-1),q={key:0},h=(0,l._)("span",null," - ",-1),W={key:0},x=(0,l._)("td",{colspan:"100%",class:"text-grey-10"}," No payments available ... ",-1),k=[x],V={key:0,class:"col-3 q-px-xl"},z=(0,l._)("div",{class:"text-weight-bold"},"Invoice",-1),S={class:"q-mt-md"},P={class:"print-only"},U={id:"orderReceiptPrintOut"},R={class:"q-px-lg q-pt-xl q-mb-lg"},Z={class:"row q-mb-sm"},F=(0,l._)("div",{class:"col-3"},"Name:",-1),C={class:"col"},Q={class:"row"},O=(0,l._)("div",{class:"col-3"},"Transaction:",-1),I={class:"col"},H=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Days"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Amount")])],-1),Y={class:"text-weight-bold"},N=(0,l._)("td",{colspan:"3",class:"text-right"},"Total",-1),M={key:0,class:"text-center"},E={class:"text-weight-bold"},A=(0,l._)("td",{colspan:"3",class:"text-right"},"Paid",-1),j={class:"text-center"},T={class:"text-weight-bold"},B=(0,l._)("td",{colspan:"3",class:"text-right"},"Balance",-1),L={class:"text-center"},K=(0,l._)("div",{class:"q-py-md"},null,-1),$={class:"column q-col-gutter-y-sm q-mt-sm q-mx-lg q-mb-xl"},G={class:"q-mb-md"},J={class:"row justify-end"},X={class:"q-px-lg q-pt-lg"},ee={class:"column"},ae={key:0,class:"q-px-lg"},te={class:"q-pt-md"},le={style:{minWidth:"100%",width:"100%"}},ue={class:"q-px-lg q-pt-xl q-mb-lg"},oe={class:"row q-mb-sm"},se=(0,l._)("div",{class:"col-3"},"Name:",-1),de={class:"col"},ne={class:"row"},ie=(0,l._)("div",{class:"col-3"},"Transaction:",-1),me={class:"col"},re=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Qty"),(0,l._)("th",null,"Days"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Amount")])],-1),ce={class:"text-weight-bold"},pe=(0,l._)("td",{colspan:"3",class:"text-right"},"Total",-1),_e={key:0,class:"text-center"},we={class:"text-weight-bold"},ge=(0,l._)("td",{colspan:"3",class:"text-right"},"Paid",-1),ve={class:"text-center"},ye={class:"text-weight-bold"},De=(0,l._)("td",{colspan:"3",class:"text-right"},"Balance",-1),fe={class:"text-center"},be={class:"q-px-md"},qe=(0,l._)("div",{class:"q-py-md"},null,-1),he={class:"row items-center q-col-gutter-x-lg"},We=(0,l._)("div",{class:"col-3 text-right"},"Name:",-1),xe={class:"col-8"},ke={class:"row items-center q-col-gutter-x-lg"},Ve=(0,l._)("div",{class:"col-3 text-right"},"Contact:",-1),ze={class:"col-8"},Se={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Pe=(0,l._)("div",{class:"col-3 text-right"},"Address:",-1),Ue={class:"col-8"},Re={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Ze=(0,l._)("div",{class:"col-3 text-right"},"ID:",-1),Fe={class:"col-8"},Ce={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Qe=(0,l._)("div",{class:"col-3 text-right"},"Nationality:",-1),Oe={class:"col-8"},Ie={class:"row items-center q-col-gutter-x-lg q-mb-sm"},He=(0,l._)("div",{class:"col-3 text-right"},"District:",-1),Ye={class:"col-8"},Ne={class:"row items-center q-col-gutter-x-lg q-mb-sm"},Me=(0,l._)("div",{class:"col-3 text-right"},"Occupation:",-1),Ee={class:"col-8"},Ae={class:"row items-center q-col-gutter-x-lg q-mb-sm"},je=(0,l._)("div",{class:"col-3 text-right"},"Organisation:",-1),Te={class:"col-8"},Be={class:"q-pt-lg"};function Le(e,a,t,x,Le,Ke){const $e=(0,l.up)("q-breadcrumbs-el"),Ge=(0,l.up)("q-breadcrumbs"),Je=(0,l.up)("q-btn"),Xe=(0,l.up)("q-separator"),ea=(0,l.up)("q-item-label"),aa=(0,l.up)("q-item-section"),ta=(0,l.up)("q-item"),la=(0,l.up)("q-list"),ua=(0,l.up)("q-markup-table"),oa=(0,l.up)("q-card-section"),sa=(0,l.up)("q-card"),da=(0,l.up)("q-page"),na=(0,l.up)("q-spinner-ios"),ia=(0,l.up)("q-inner-loading"),ma=(0,l.up)("q-toolbar-title"),ra=(0,l.up)("q-toolbar"),ca=(0,l.up)("balance-calculator-component"),pa=(0,l.up)("q-expansion-item"),_a=(0,l.up)("q-date"),wa=(0,l.up)("q-popup-proxy"),ga=(0,l.up)("q-field"),va=(0,l.up)("money-input-component"),ya=(0,l.up)("q-select"),Da=(0,l.up)("q-input"),fa=(0,l.up)("q-form"),ba=(0,l.up)("q-dialog"),qa=(0,l.up)("q-radio"),ha=(0,l.up)("q-slide-transition"),Wa=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(da,{class:"q-mx-xl q-mb-lg q-mt-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(Ge,null,{default:(0,l.w5)((()=>[(0,l.Wm)($e,{to:{name:"RoomsSales"}},{default:(0,l.w5)((()=>[(0,l.Uk)("Sales")])),_:1}),(0,l.Wm)($e,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.Id),1)])),_:1})])),_:1}),(0,l._)("div",o,[(0,l._)("div",null,"Date: "+(0,u.zw)(e.pageData.date),1),(0,l._)("div",null,"Bill: "+(0,u.zw)(e.formatPrice(e.pageData.bill)),1),(0,l._)("div",null,"Paid: "+(0,u.zw)(e.formatPrice(e.pageData.paid)),1),(0,l._)("div",null,"Balance: "+(0,u.zw)(e.formatPrice(e.pageData.bill-e.pageData.paid)),1),(0,l._)("div",s,[e.pageData.bill!==e.pageData.paid&&"OPEN"==e.pageData.status&&e.permissionRequired("rooms","add_payment")&&!e.pageData.invoice_id?((0,l.wg)(),(0,l.j4)(Je,{key:0,dense:"","no-caps":"",rounded:"",color:"primary",label:"Add Payment",class:"full-width q-px-md",onClick:a[0]||(a[0]=a=>e.addPaymentDialog=!e.addPaymentDialog)})):(0,l.kq)("",!0),"CLOSED"!==e.pageData.status?((0,l.wg)(),(0,l.iD)("div",d,[e.permissionRequired("rooms","change_sale")?((0,l.wg)(),(0,l.j4)(Je,{key:0,dense:"","no-caps":"",rounded:"","no-wrap":"",color:"primary",label:"Update Status",class:"full-width q-px-md",onClick:a[1]||(a[1]=a=>e.updateStatusDialog=!e.updateStatusDialog)})):(0,l.kq)("",!0)])):(0,l.kq)("",!0)])]),(0,l.Wm)(Xe,{class:"q-my-sm bg-grey"}),e.permissionRequired("rooms","change_sale")?((0,l.wg)(),(0,l.j4)(Je,{key:0,unelevated:"",dense:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:a[2]||(a[2]=a=>e.orderReceipt=!e.orderReceipt)})):(0,l.kq)("",!0),(0,l._)("div",n,[(0,l._)("div",i,[(0,l._)("div",m,[r,"OPEN"===e.pageData.status?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(Je,{round:"",size:"sm",color:"primary",icon:"edit",onClick:a[3]||(a[3]=a=>e.customerFormDialog=!e.customerFormDialog)})])):(0,l.kq)("",!0)]),(0,l.Wm)(la,{dense:""},{default:(0,l.w5)((()=>[(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Name :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.name),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Contact :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.contact),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Address :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.address),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("ID :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.identification_number),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Nationality :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.nationality),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("District :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.district),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Occupation :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.occupation),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(ta,null,{default:(0,l.w5)((()=>[(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Organisation :")])),_:1})])),_:1}),(0,l.Wm)(aa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(ea,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.customerData.organisation),1)])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l.Wm)(Xe,{class:"q-mx-md",inset:"",vertical:""}),(0,l._)("div",p,[_,(0,l.Wm)(ua,{flat:"",bordered:"",separator:"vertical"},{default:(0,l.w5)((()=>[w,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.roomsData,((a,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,(0,u.zw)(a.room_name),1),(0,l._)("td",null,(0,u.zw)(a.arrival),1),(0,l._)("td",null,(0,u.zw)(a.departure),1),(0,l._)("td",null,(0,u.zw)(e.formatPrice(a.amount))+" @ "+(0,u.zw)(a.unit),1),(0,l._)("td",null,(0,u.zw)(a.quantity),1),(0,l._)("td",g,(0,u.zw)(e.formatPrice(a.total_price)),1)])))),128))])])),_:1})])]),e.permissionRequired("rooms","view_payment")?((0,l.wg)(),(0,l.iD)("div",v,[(0,l._)("div",y,[D,(0,l.Wm)(Xe,{class:"q-mt-sm"}),(0,l._)("div",f,[(0,l.Wm)(ua,{flat:"",bordered:"",separator:"vertical"},{default:(0,l.w5)((()=>[b,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.paymentsData,((a,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,(0,u.zw)(e.formatPrice(a.amount)),1),(0,l._)("td",null,(0,u.zw)(a.method),1),(0,l._)("td",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(a?.other_details),(e=>((0,l.wg)(),(0,l.iD)("div",{key:e},[e.startsWith("_")?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("span",q,[(0,l.Uk)((0,u.zw)(e),1),h,(0,l.Uk)((0,u.zw)(a?.other_details[e]),1)]))])))),128))]),(0,l._)("td",null,(0,u.zw)(a.date),1)])))),128)),e.paymentsData.length<1?((0,l.wg)(),(0,l.iD)("tr",W,k)):(0,l.kq)("",!0)])])),_:1})])]),e.pageData.invoice_id?((0,l.wg)(),(0,l.iD)("div",V,[z,(0,l.Wm)(Xe,{class:"q-mt-sm"}),(0,l._)("div",S,[(0,l.Wm)(Je,{outline:"",label:"invoice # "+e.pageData.invoice_id,"icon-right":"keyboard_arrow_right",color:"primary",to:{name:"InvoiceDetails",params:{id:e.pageData.invoice_id}}},null,8,["label","to"])])])):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l._)("div",P,[(0,l._)("div",U,[(0,l.Wm)(sa,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l.Wm)(oa,{class:"window-width"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l._)("div",R,[(0,l._)("div",Z,[F,(0,l._)("div",C,(0,u.zw)(e.pageData.customer.name),1)]),(0,l._)("div",Q,[O,(0,l._)("div",I,(0,u.zw)(e.pageData.id),1)])]),(0,l.Wm)(ua,{"wrap-cells":"",bordered:"",flat:"",cell:"horizontal",class:"overflow-hidden"},{default:(0,l.w5)((()=>[H,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.pageData.details,(a=>((0,l.wg)(),(0,l.iD)("tr",{key:a.id,class:"text-center"},[(0,l._)("td",null,(0,u.zw)(a.quantity),1),(0,l._)("td",null,(0,u.zw)(a.days),1),(0,l._)("td",null,(0,u.zw)(a.room_name),1),(0,l._)("td",null,(0,u.zw)(e.formatPrice(a.amount*a.quantity*a.days)),1)])))),128)),(0,l._)("tr",Y,[N,e.pageData.details?((0,l.wg)(),(0,l.iD)("td",M,(0,u.zw)(e.formatPrice(e.itemsProductSum2(e.pageData.details,e.attrubutes=["amount","quantity","days"]))),1)):(0,l.kq)("",!0)]),(0,l._)("tr",E,[A,(0,l._)("td",j,(0,u.zw)(e.formatPrice(e.itemsSum(e.pageData.payments))),1)]),(0,l._)("tr",T,[B,(0,l._)("td",L,(0,u.zw)(e.formatPrice(e.itemsProductSum2(e.pageData.details,e.attrubutes=["amount","quantity","days"])-e.itemsSum(e.pageData.payments))),1)])])])),_:1}),K])])),_:1})])),_:1})])])])),_:1}),(0,l.Wm)(ia,{showing:e.loadingData},{default:(0,l.w5)((()=>[(0,l.Wm)(na,{size:"50px",color:"primary"})])),_:1},8,["showing"]),(0,l.Wm)(ba,{modelValue:e.addPaymentDialog,"onUpdate:modelValue":a[8]||(a[8]=a=>e.addPaymentDialog=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(sa,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(fa,{ref:"paymentForm",onSubmit:e.savePayment},{default:(0,l.w5)((()=>[(0,l.Wm)(ra,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(ma,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Payment")])),_:1}),(0,l.wy)((0,l.Wm)(Je,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Wa]])])),_:1}),(0,l.Wm)(Xe),(0,l._)("div",$,[(0,l._)("div",G,[(0,l.Wm)(pa,{dense:"","dense-toggle":"",label:"Balance Calculator","header-class":"text-primary",class:"rounded-borders",style:(0,u.j5)({border:"1px solid var(--q-primary)"})},{default:(0,l.w5)((()=>[(0,l.Wm)(ca,{defaultAmount:e.pageData.bill-e.pageData.paid},null,8,["defaultAmount"])])),_:1},8,["style"])]),(0,l.Wm)(ga,{outlined:"",label:"Date",modelValue:e.paymentData.date,"onUpdate:modelValue":a[5]||(a[5]=a=>e.paymentData.date=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},{control:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.paymentData.date),1)])),append:(0,l.w5)((()=>[(0,l.Wm)(Je,{size:"sm",round:"",color:"primary",icon:"event"},{default:(0,l.w5)((()=>[(0,l.Wm)(wa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_a,{modelValue:e.paymentData.date,"onUpdate:modelValue":a[4]||(a[4]=a=>e.paymentData.date=a),mask:"DD/MM/YYYY"},{default:(0,l.w5)((()=>[(0,l._)("div",J,[(0,l.wy)((0,l.Wm)(Je,{"no-caps":"",label:"Close"},null,512),[[Wa]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,l.Wm)(va,{modelValue:e.paymentData.amount,"onUpdate:modelValue":a[6]||(a[6]=a=>e.paymentData.amount=a),"input-class":"text-h6",label:"Amount"},null,8,["modelValue"]),(0,l.Wm)(ya,{outlined:"",modelValue:e.paymentData.method,"onUpdate:modelValue":a[7]||(a[7]=a=>e.paymentData.method=a),label:"Mode of payment",options:e.paymentMethodOptions,"option-label":"name","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.paymentMethodOptions)},null,8,["modelValue","options","rules"]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(e.fields),((a,t)=>((0,l.wg)(),(0,l.j4)(Da,{outlined:"",key:t,"model-value":e.fields[a],"onUpdate:modelValue":t=>e.fields[a]=t,label:a},null,8,["model-value","onUpdate:modelValue","label"])))),128)),(0,l._)("div",X,[(0,l.Wm)(Je,{rounded:"","no-caps":"",color:"primary",label:"Add Payment",class:"full-width",type:"submit",loading:e.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(ba,{modelValue:e.updateStatusDialog,"onUpdate:modelValue":a[14]||(a[14]=a=>e.updateStatusDialog=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(sa,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(ra,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(ma,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Status")])),_:1}),(0,l.wy)((0,l.Wm)(Je,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Wa]])])),_:1}),(0,l.Wm)(Xe),(0,l.Wm)(oa,null,{default:(0,l.w5)((()=>[(0,l.Wm)(fa,{ref:"updateStatusForm",onSubmit:e.submitStatusData},{default:(0,l.w5)((()=>[(0,l.Wm)(ga,{outlined:"",modelValue:e.newStatus,"onUpdate:modelValue":a[13]||(a[13]=a=>e.newStatus=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules("Please select an option")},{control:(0,l.w5)((()=>[(0,l._)("div",ee,["CANCELLED"==e.pageData.status?((0,l.wg)(),(0,l.j4)(qa,{key:0,modelValue:e.newStatus,"onUpdate:modelValue":a[9]||(a[9]=a=>e.newStatus=a),val:e.statusOptions.open.value,label:e.statusOptions.open.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==e.pageData.status?((0,l.wg)(),(0,l.j4)(qa,{key:1,modelValue:e.newStatus,"onUpdate:modelValue":a[10]||(a[10]=a=>e.newStatus=a),val:e.statusOptions.close.value,label:e.statusOptions.close.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),"OPEN"==e.pageData.status?((0,l.wg)(),(0,l.j4)(qa,{key:2,modelValue:e.newStatus,"onUpdate:modelValue":a[11]||(a[11]=a=>e.newStatus=a),val:e.statusOptions.cancel.value,label:e.statusOptions.cancel.label},null,8,["modelValue","val","label"])):(0,l.kq)("",!0),(0,l.Wm)(ha,null,{default:(0,l.w5)((()=>["cancel"==e.newStatus?((0,l.wg)(),(0,l.iD)("div",ae,[(0,l.Wm)(Da,{outlined:"",label:"Reason",type:"textarea",rows:"5","lazy-rules":"ondemand",rules:[...e.textInputRequiredRules(),...e.minimumRequiredRules(10)],modelValue:e.statusOptions.cancel.data.reason,"onUpdate:modelValue":a[12]||(a[12]=a=>e.statusOptions.cancel.data.reason=a)},null,8,["rules","modelValue"])])):(0,l.kq)("",!0)])),_:1})])])),_:1},8,["modelValue","rules"]),(0,l._)("div",te,[(0,l.Wm)(Je,{rounded:"",type:"submit",color:"primary",label:"submit",class:"full-width",loading:e.submitting},null,8,["loading"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(ba,{modelValue:e.orderReceipt,"onUpdate:modelValue":a[16]||(a[16]=a=>e.orderReceipt=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(sa,{style:{minWidth:"500px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(oa,null,{default:(0,l.w5)((()=>[(0,l._)("div",le,[(0,l._)("div",ue,[(0,l._)("div",oe,[se,(0,l._)("div",de,(0,u.zw)(e.pageData.customer.name),1)]),(0,l._)("div",ne,[ie,(0,l._)("div",me,(0,u.zw)(e.pageData.id),1)])]),(0,l.Wm)(ua,{bordered:"",flat:"",cell:"horizontal"},{default:(0,l.w5)((()=>[re,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.pageData.details,(a=>((0,l.wg)(),(0,l.iD)("tr",{key:a.id,class:"text-center"},[(0,l._)("td",null,(0,u.zw)(a.quantity),1),(0,l._)("td",null,(0,u.zw)(a.days),1),(0,l._)("td",null,(0,u.zw)(a.room_name),1),(0,l._)("td",null,(0,u.zw)(e.formatPrice(a.amount*a.quantity*a.days)),1)])))),128)),(0,l._)("tr",ce,[pe,e.pageData.details?((0,l.wg)(),(0,l.iD)("td",_e,(0,u.zw)(e.formatPrice(e.itemsProductSum2(e.pageData.details,e.attrubutes=["amount","quantity","days"]))),1)):(0,l.kq)("",!0)]),(0,l._)("tr",we,[ge,(0,l._)("td",ve,(0,u.zw)(e.formatPrice(e.itemsSum(e.pageData.payments))),1)]),(0,l._)("tr",ye,[De,(0,l._)("td",fe,(0,u.zw)(e.formatPrice(e.itemsProductSum2(e.pageData.details,e.attrubutes=["amount","quantity","days"])-e.itemsSum(e.pageData.payments))),1)])])])),_:1}),(0,l._)("div",be,[e.$q.platform.is.electron?((0,l.wg)(),(0,l.j4)(Je,{key:0,rounded:"",label:"print",icon:"print",color:"primary",class:"full-width",onClick:a[15]||(a[15]=a=>e.printDocument("orderReceiptPrintOut",e.printingSettings))})):(0,l.kq)("",!0)]),qe])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(ba,{modelValue:e.customerFormDialog,"onUpdate:modelValue":a[25]||(a[25]=a=>e.customerFormDialog=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(sa,{style:{width:"400px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(fa,{ref:"customerForm",onSubmit:e.submitCustomerData},{default:(0,l.w5)((()=>[(0,l.Wm)(ra,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(ma,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Customer Details")])),_:1}),(0,l.wy)((0,l.Wm)(Je,{flat:"",round:"",size:"md",icon:"close"},null,512),[[Wa]])])),_:1}),(0,l.Wm)(oa,{class:"column q-col-gutter-y-md q-mx-md q-mt-sm"},{default:(0,l.w5)((()=>[(0,l._)("div",he,[We,(0,l._)("div",xe,[(0,l.Wm)(Da,{dense:"",outlined:"",modelValue:e.customerFormData.name,"onUpdate:modelValue":a[17]||(a[17]=a=>e.customerFormData.name=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",ke,[Ve,(0,l._)("div",ze,[(0,l.Wm)(Da,{dense:"",outlined:"",mask:"### ### ######","unmasked-value":"",modelValue:e.customerFormData.contact,"onUpdate:modelValue":a[18]||(a[18]=a=>e.customerFormData.contact=a),"lazy-rules":"ondemand",rules:e.contactRequiredRules()},null,8,["modelValue","rules"])])]),(0,l._)("div",Se,[Pe,(0,l._)("div",Ue,[(0,l.Wm)(Da,{dense:"",outlined:"",modelValue:e.customerFormData.address,"onUpdate:modelValue":a[19]||(a[19]=a=>e.customerFormData.address=a)},null,8,["modelValue"])])]),(0,l._)("div",Re,[Ze,(0,l._)("div",Fe,[(0,l.Wm)(Da,{dense:"",outlined:"",modelValue:e.customerFormData.identification_number,"onUpdate:modelValue":a[20]||(a[20]=a=>e.customerFormData.identification_number=a)},null,8,["modelValue"])])]),(0,l._)("div",Ce,[Qe,(0,l._)("div",Oe,[(0,l.Wm)(Da,{dense:"",outlined:"",modelValue:e.customerFormData.nationality,"onUpdate:modelValue":a[21]||(a[21]=a=>e.customerFormData.nationality=a)},null,8,["modelValue"])])]),(0,l._)("div",Ie,[He,(0,l._)("div",Ye,[(0,l.Wm)(Da,{dense:"",outlined:"",modelValue:e.customerFormData.district,"onUpdate:modelValue":a[22]||(a[22]=a=>e.customerFormData.district=a)},null,8,["modelValue"])])]),(0,l._)("div",Ne,[Me,(0,l._)("div",Ee,[(0,l.Wm)(Da,{dense:"",outlined:"",modelValue:e.customerFormData.occupation,"onUpdate:modelValue":a[23]||(a[23]=a=>e.customerFormData.occupation=a)},null,8,["modelValue"])])]),(0,l._)("div",Ae,[je,(0,l._)("div",Te,[(0,l.Wm)(Da,{dense:"",outlined:"",modelValue:e.customerFormData.organisation,"onUpdate:modelValue":a[24]||(a[24]=a=>e.customerFormData.organisation=a)},null,8,["modelValue"])])]),(0,l._)("div",Be,[(0,l.Wm)(Je,{rounded:"",class:"full-width",label:"submit",color:"primary",type:"submit",loading:e.submitting},null,8,["loading"])])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var Ke=t(9302),$e=t(4170),Ge=t(499),Je=t(2580),Xe=t(9258),ea=t(4019),aa=t(8221);const ta=(0,l.aZ)({name:"RoomTypes",props:{Id:{required:!0}},components:{MoneyInputComponent:Je.Z,BalanceCalculatorComponent:Xe.Z},setup(e){(0,Ke.Z)();const a={customer:{},payments:[],details:[],bill:0,paid:0},t=(0,Ge.iH)({}),u=(0,Ge.iH)({...a}),o=(0,l.Fl)((()=>u.value.customer?u.value.customer:{})),s=(0,l.Fl)((()=>u.value.payments?u.value.payments:[])),d=(0,l.Fl)((()=>u.value.details?u.value.details:[])),n=(0,Ge.iH)(!1),i=(0,Ge.iH)(!1),m=(0,Ge.iH)({}),r=(0,Ge.iH)([]),c=(0,Ge.iH)(null),p={open:{label:"Open",value:"open",data:{status:"OPEN"}},close:{label:"Close",value:"close",data:{status:"CLOSED"}},cancel:{label:"Cancel",value:"cancel",data:{status:"CANCELLED",reason:""}}},_=(0,Ge.iH)(),w=(0,Ge.iH)(!1),g=(0,Ge.iH)(!1),v=(0,Ge.iH)(!1),y=(0,Ge.iH)({}),D=(0,Ge.iH)(null),f=(0,Ge.iH)(!1),b=(0,Ge.iH)(null),q=(0,Ge.iH)({});function h(){return n.value=!0,u.value={...a},(0,ea.getRoomsSales)(`/${e.Id}`).then((e=>{u.value=e.data})).then((()=>{q.value={...o.value}})).finally((()=>{n.value=!1}))}function W(){return(0,ea.getGeneralSettings)("?name=PRINTERS").then((e=>{t.value=e.data.details["items"].find((e=>"rooms receipts"==e.item))||e.data.details["items"].find((e=>"receipts"==e.item))}))}return(0,l.m0)((()=>{m.value&&m.value.method&&m.value.method.other_details&&m.value.method.other_details.fields?y.value=m.value.method.other_details.fields.reduce(((e,a)=>({...e,[a]:null})),{}):y.value={}})),(0,l.bv)((()=>{m.value.date=$e.ZP.formatDate(new Date,"DD/MM/YYYY"),h().then((()=>{(0,ea.getPaymentMethods)().then((e=>{r.value=e.data,W()}))}))})),(0,l.m0)((()=>{d.value.forEach((e=>{e.arrival&&e.departure?(e.days=parseInt($e.ZP.getDateDiff($e.ZP.extractDate(e.departure,"DD/MM/YYYY"),$e.ZP.extractDate(e.arrival,"DD/MM/YYYY"))+1),e.total_price=e.days*e.amount*e.quantity):e.total_price=0}))})),{pageData:u,customerData:o,paymentsData:s,roomsData:d,addPaymentDialog:i,paymentData:m,paymentMethodOptions:r,submitting:w,fields:y,updateStatusDialog:g,newStatus:c,statusOptions:p,loadingData:n,updateStatusForm:_,orderReceipt:v,printingSettings:t,paymentForm:D,customerForm:b,customerFormDialog:f,customerFormData:q,submitCustomerData(){b.value.validate()&&(w.value=!0,(0,ea.updateRoomSalesCustomer)(e.Id,q.value).then((e=>{(0,aa.displayNotification)(e.data,"positive"),q.value={},b.value.resetValidation(),f.value=!1,h()})).catch((e=>{(0,aa.displayNotification)(e,"negative",{error:!0})})).finally((()=>{w.value=!1})))},savePayment(){D.value.validate()&&(w.value=!0,(0,ea.addRoomSalePayments)(e.Id,{...m.value,method:m.value.method.id,other_details:y.value}).then((e=>{(0,aa.displayNotification)(e.data,"positive"),m.value={},h(),i.value=!1,D.value.resetValidation()})).catch((e=>{(0,aa.displayNotification)(e,"negative",{error:!0})})).finally((()=>{w.value=!1})))},submitStatusData(){_.value.validate()&&(w.value=!0,(0,ea.updateRoomSalesStatus)(e.Id,p[c.value].data).then((e=>{(0,aa.displayNotification)(e.data,"positive"),c.value=null,g.value=!1,h()})).catch((e=>{(0,aa.displayNotification)(e.response.data,"negative")})).finally((()=>{w.value=!1})))}}}});var la=t(1639),ua=t(9885),oa=t(2605),sa=t(8052),da=t(8879),na=t(926),ia=t(3246),ma=t(490),ra=t(1233),ca=t(3115),pa=t(6933),_a=t(4458),wa=t(3190),ga=t(854),va=t(8359),ya=t(2074),Da=t(8326),fa=t(1663),ba=t(1973),qa=t(651),ha=t(8149),Wa=t(2765),xa=t(4351),ka=t(4581),Va=t(6611),za=t(1480),Sa=t(9003),Pa=t(2146),Ua=t(9984),Ra=t.n(Ua);const Za=(0,la.Z)(ta,[["render",Le]]),Fa=Za;Ra()(ta,"components",{QPage:ua.Z,QBreadcrumbs:oa.Z,QBreadcrumbsEl:sa.Z,QBtn:da.Z,QSeparator:na.Z,QList:ia.Z,QItem:ma.Z,QItemSection:ra.Z,QItemLabel:ca.Z,QMarkupTable:pa.Z,QCard:_a.Z,QCardSection:wa.Z,QInnerLoading:ga.Z,QSpinnerIos:va.Z,QDialog:ya.Z,QForm:Da.Z,QToolbar:fa.Z,QToolbarTitle:ba.Z,QExpansionItem:qa.Z,QField:ha.Z,QPopupProxy:Wa.Z,QDate:xa.Z,QSelect:ka.Z,QInput:Va.Z,QRadio:za.Z,QSlideTransition:Sa.Z}),Ra()(ta,"directives",{ClosePopup:Pa.Z})}}]);