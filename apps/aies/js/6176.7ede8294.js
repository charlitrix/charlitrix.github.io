"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[6176],{6176:(e,a,l)=>{l.r(a),l.d(a,{default:()=>H});var t=l(9835),o=l(6970);const i={class:"row justify-end"},n={class:"column justify-center q-col-gutter-y-sm"},u={class:"row no-wrap"},s={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg"},d={class:"column q-col-gutter-y-lg q-mx-lg q-mb-lg"};function r(e,a,l,r,m,c){const p=(0,t.up)("q-btn"),g=(0,t.up)("q-td"),b=(0,t.up)("q-table"),v=(0,t.up)("q-page"),w=(0,t.up)("q-toolbar-title"),k=(0,t.up)("q-toolbar"),f=(0,t.up)("q-separator"),y=(0,t.up)("q-input"),_=(0,t.up)("q-form"),h=(0,t.up)("q-card"),q=(0,t.up)("q-dialog"),D=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(v,{class:"q-ma-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",i,[e.permissionRequired("kitchen","add_stock")?((0,t.wg)(),(0,t.j4)(p,{key:0,rounded:"",color:"primary",label:"Create",onClick:a[0]||(a[0]=a=>e.createDialog=!e.createDialog)})):(0,t.kq)("",!0)]),(0,t.Wm)(b,{flat:"","table-header-class":"bg-primary text-white",loading:e.loadingData,columns:e.tableColumns,rows:e.tableRows,pagination:{rowsPerPage:0},title:"Stock","row-key":"id","no-data-label":"No stock available","loading-label":"Loading items..."},{"body-cell-units_details":(0,t.w5)((e=>[(0,t.Wm)(g,{props:e},{default:(0,t.w5)((()=>[(0,t._)("div",n,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.units_available_details,(e=>((0,t.wg)(),(0,t.iD)("div",{key:e.id},(0,o.zw)(e.quantity)+" "+(0,o.zw)(e.unit),1)))),128))])])),_:2},1032,["props"])])),"body-cell-actions":(0,t.w5)((a=>[(0,t.Wm)(g,{props:a},{default:(0,t.w5)((()=>[(0,t._)("div",u,[e.permissionRequired("kitchen","change_stock")?((0,t.wg)(),(0,t.j4)(p,{key:0,round:"",unelevated:"",size:"sm",icon:"edit",color:"primary",onClick:l=>e.editStock(a.rowIndex)},null,8,["onClick"])):(0,t.kq)("",!0)])])),_:2},1032,["props"])])),_:1},8,["loading","columns","rows"])])),_:1}),(0,t.Wm)(q,{modelValue:e.createDialog,"onUpdate:modelValue":a[2]||(a[2]=a=>e.createDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{ref:"newStockForm",onSubmit:e.submitStockData},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Create New Stock Item")])),_:1}),(0,t.wy)((0,t.Wm)(p,{flat:"",round:"",size:"md",icon:"close"},null,512),[[D]])])),_:1}),(0,t.Wm)(f),(0,t._)("div",s,[(0,t.Wm)(y,{modelValue:e.stockData.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.stockData.name=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules(),label:"Name"},null,8,["modelValue","rules"]),(0,t._)("div",null,[(0,t.Wm)(p,{rounded:"",loading:e.submittedStockData,color:"primary",label:"Create",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(q,{modelValue:e.updateDialog,"onUpdate:modelValue":a[4]||(a[4]=a=>e.updateDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{ref:"updateStockForm",onSubmit:e.updateStockData},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Update Stock Item")])),_:1}),(0,t.wy)((0,t.Wm)(p,{flat:"",round:"",size:"md",icon:"close"},null,512),[[D]])])),_:1}),(0,t.Wm)(f),(0,t._)("div",d,[(0,t.Wm)(y,{modelValue:e.selectedItem.newName,"onUpdate:modelValue":a[3]||(a[3]=a=>e.selectedItem.newName=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules(),label:"Name"},null,8,["modelValue","rules"]),(0,t._)("div",null,[(0,t.Wm)(p,{rounded:"",loading:e.submittedStockData,color:"primary",label:"Update",class:"full-width",type:"submit"},null,8,["loading"])])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var m=l(9302),c=l(499),p=l(4019);const g=[{name:"id",label:"#",field:"id",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"units_available",label:"Units Available",field:"units_available",sortable:!0,align:"left"},{name:"units_details",label:"Units Available Details",align:"left"},{name:"actions",label:"Actions",align:"left"}],b=(0,t.aZ)({name:"KitchenIndex",setup(){const e=(0,m.Z)(),a=(0,c.iH)([]),l=(0,c.iH)(!1),o=(0,c.iH)(!1),i=(0,c.iH)(!1),n=(0,c.iH)({}),u=(0,c.iH)(!1),s=(0,c.iH)({}),d=(0,c.iH)(null),r=(0,c.iH)(null);function b(){l.value=!0,(0,p.getKitchenStockWithUnitsDetails)().then((e=>{a.value=e.data})).catch((e=>{})).finally((()=>{l.value=!1}))}return(0,t.bv)((()=>{b()})),{loadingData:l,tableRows:a,tableColumns:g,stockData:n,createDialog:o,submittedStockData:i,updateDialog:u,selectedItem:s,newStockForm:d,updateStockForm:r,editStock(e){s.value=a.value[e],s.value.newName=s.value.name,u.value=!0},updateStockData(){r.value.validate()&&(i.value=!0,(0,p.updateKitchenStock)(s.value.id,{name:s.value.newName}).then((a=>{e.notify({type:"positive",message:a.data}),s.value={},b(),u.value=!1,r.value.resetValidation()})).catch((a=>{e.notify({type:"negative",message:a.response.data.length<1e3?a.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1})))},submitStockData(){d.value.validate()&&(i.value=!0,(0,p.createKitchenStock)({...n.value,units_available:"0"}).then((a=>{e.notify({type:"positive",message:a.data}),n.value={},b(),o.value=!1,d.value.resetValidation()})).catch((a=>{e.notify({type:"negative",message:a.response.data.length<1e3?a.response.data:"Server error please contact system administrator"})})).finally((()=>{i.value=!1})))}}}});var v=l(1639),w=l(9885),k=l(8879),f=l(7355),y=l(7220),_=l(2074),h=l(4458),q=l(8326),D=l(1663),S=l(1973),W=l(926),Z=l(6611),V=l(2146),x=l(9984),C=l.n(x);const Q=(0,v.Z)(b,[["render",r]]),H=Q;C()(b,"components",{QPage:w.Z,QBtn:k.Z,QTable:f.Z,QTd:y.Z,QDialog:_.Z,QCard:h.Z,QForm:q.Z,QToolbar:D.Z,QToolbarTitle:S.Z,QSeparator:W.Z,QInput:Z.Z}),C()(b,"directives",{ClosePopup:V.Z})}}]);