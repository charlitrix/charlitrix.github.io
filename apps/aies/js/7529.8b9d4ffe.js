"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[7529],{7529:(e,l,a)=>{a.r(l),a.d(l,{default:()=>F}),a(6727);var t=a(9835),o=a(6970);const n={class:"row q-mb-lg justify-between"},i={class:"row q-gutter-x-xl"},s={class:"row items-center q-gutter-x-md"},r={key:0,class:"text-grey-9 q-ml-sm"},u={key:1,class:"text-grey-9 q-ml-sm"},d={class:"row justify-end"},m={key:0,class:"text-grey-9 q-ml-sm"},p={key:1,class:"text-grey-9 q-ml-sm"},c={class:"row justify-end"},g={key:0,class:"row items-center"},w={id:"reportToPrint"},b={class:"column justify-center q-col-gutter-y-sm"},v={class:"column justify-center q-col-gutter-y-sm"};function f(e,l,a,f,h,k){const D=(0,t.up)("q-select"),_=(0,t.up)("q-form"),y=(0,t.up)("q-btn"),x=(0,t.up)("q-date"),q=(0,t.up)("q-popup-proxy"),W=(0,t.up)("q-field"),P=(0,t.up)("q-separator"),R=(0,t.up)("q-td"),C=(0,t.up)("q-tr"),V=(0,t.up)("q-table"),O=(0,t.up)("q-spinner-ios"),S=(0,t.up)("q-inner-loading"),T=(0,t.up)("q-page"),Z=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(T,{class:"q-pa-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",i,[(0,t._)("div",null,[(0,t.Wm)(_,{ref:"stockItemForm"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedExpensesOption,"onUpdate:modelValue":[l[0]||(l[0]=l=>e.selectedExpensesOption=l),e.expensesOptionChanged],options:e.expensesOptions,"lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.expensesValidOptions.map((e=>e.value))),style:{minWidth:"180px"}},null,8,["modelValue","onUpdate:modelValue","options","rules"])])),_:1},512)]),(0,t._)("div",null,[(0,t.Wm)(D,{dense:"",outlined:"","emit-value":"","map-options":"","options-cover":"","option-label":"label","option-value":"value",modelValue:e.selectedFilter,"onUpdate:modelValue":[l[1]||(l[1]=l=>e.selectedFilter=l),e.filterOptionChanged],options:e.filterOptions},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,t._)("div",null,[(0,t._)("div",s,[(0,t.Wm)(W,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)(" From: "),e.fromDate?((0,t.wg)(),(0,t.iD)("span",r,(0,o.zw)(e.fromDate),1)):((0,t.wg)(),(0,t.iD)("span",u,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(y,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{ref:"fromDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:e.fromDate,"onUpdate:modelValue":[l[2]||(l[2]=l=>e.fromDate=l),e.fromDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t.wy)((0,t.Wm)(y,{flat:"",label:"Close",color:"primary"},null,512),[[Z]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1}),(0,t.Wm)(W,{"stack-label":"",dense:"",borderless:""},{control:(0,t.w5)((()=>[(0,t.Uk)("To: "),e.toDate?((0,t.wg)(),(0,t.iD)("span",m,(0,o.zw)(e.toDate),1)):((0,t.wg)(),(0,t.iD)("span",p,"Select date"))])),append:(0,t.w5)((()=>[(0,t.Wm)(y,{flat:"",dense:"",color:"primary",icon:"calendar_month"},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{ref:"toDateDialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:e.toDate,"onUpdate:modelValue":[l[3]||(l[3]=l=>e.toDate=l),e.toDateChanged],mask:"DD/MM/YYYY"},{default:(0,t.w5)((()=>[(0,t._)("div",c,[(0,t.wy)((0,t.Wm)(y,{flat:"",label:"Close",color:"primary"},null,512),[[Z]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1},512)])),_:1})])),_:1})])])]),e.$q.platform.is.electron?((0,t.wg)(),(0,t.iD)("div",g,[(0,t.Wm)(y,{unelevated:"",flat:"","no-caps":"",icon:"print",color:"primary",label:"Print",onClick:l[4]||(l[4]=l=>e.printDocument("reportToPrint",e.printingSettings))}),(0,t.Wm)(P,{vertical:""}),(0,t.Wm)(y,{unelevated:"",flat:"","no-caps":"",icon:"file_download",color:"grey-9",label:"Download",onClick:l[5]||(l[5]=l=>e.printDocumentPDF("reportToPrint"))})])):(0,t.kq)("",!0)]),(0,t._)("div",null,[(0,t._)("div",w,[e.table2Expenses.includes(e.selectedExpensesOption)&&null!==e.selectedExpensesOption?((0,t.wg)(),(0,t.j4)(V,{key:1,flat:"",bordered:"",square:"","hide-pagination":"",loading:e.loadingData,columns:e.tableColumns2,rows:e.tableRows2,pagination:{rowsPerPage:0},title:"","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No stock available","loading-label":"Loading stock..."},{"body-cell-unit":(0,t.w5)((l=>[(0,t.Wm)(R,{props:l},{default:(0,t.w5)((()=>[(0,t._)("div",b,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.row.units_details,(l=>((0,t.wg)(),(0,t.iD)("div",{key:l.id},(0,o.zw)(l.quantity)+" "+(0,o.zw)(l.unit)+" @ "+(0,o.zw)(e.formatPrice(l.unit_price)),1)))),128))])])),_:2},1032,["props"])])),"body-cell-available":(0,t.w5)((e=>[(0,t.Wm)(R,{props:e},{default:(0,t.w5)((()=>[(0,t._)("div",v,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.units_details,(e=>((0,t.wg)(),(0,t.iD)("div",{key:e.id},(0,o.zw)(e.available)+" "+(0,o.zw)(e.unit),1)))),128))])])),_:2},1032,["props"])])),"bottom-row":(0,t.w5)((()=>[e.tableRows2.length>0?((0,t.wg)(),(0,t.j4)(C,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{class:"text-weight-bold text-right",colspan:"5"},{default:(0,t.w5)((()=>[(0,t.Uk)("Total:")])),_:1}),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.formatPrice(e.itemsSum(e.tableRows2,"amount"))),1)])),_:1})])),_:1})):(0,t.kq)("",!0)])),_:1},8,["loading","columns","rows"])):((0,t.wg)(),(0,t.j4)(V,{key:0,flat:"",bordered:"",square:"","hide-pagination":"",loading:e.loadingData,columns:e.tableColumns1,rows:e.tableRows1,pagination:{rowsPerPage:0},title:"","row-key":"id","table-header-class":"bg-primary text-white","no-data-label":"No stock available","loading-label":"Loading stock..."},{"bottom-row":(0,t.w5)((()=>[e.tableRows1.length>0?((0,t.wg)(),(0,t.j4)(C,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{class:"text-weight-bold text-right",colspan:"2"},{default:(0,t.w5)((()=>[(0,t.Uk)("Total:")])),_:1}),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.formatPrice(e.itemsSum(e.tableRows1,"amount"))),1)])),_:1})])),_:1})):(0,t.kq)("",!0)])),_:1},8,["loading","columns","rows"]))]),(0,t.Wm)(S,{label:"Please wait",showing:e.loadingData},{default:(0,t.w5)((()=>[(0,t.Wm)(O,{size:"50px",color:"primary"})])),_:1},8,["showing"])])])),_:1})}var h=a(9302),k=a(499),D=a(4019),_=a(8221);const y=(0,t.aZ)({name:"ReportsIndex",setup(){(0,h.Z)();const e=(0,k.iH)(!1),l=(0,k.iH)(),a=(0,k.iH)(),o=(0,k.iH)("1"),n=(0,k.iH)("?month"),i=(0,k.iH)("month"),s=[{label:"Select Period",value:null,disable:!0},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}],r=(0,k.iH)(""),u=(0,k.iH)(""),d=(0,k.iH)(null),m=[{label:"General",value:"expenses"},{label:"Store",value:"store"},{label:"Kitchen",value:"kitchen"},{label:"Bar",value:"bar"},{label:"Rooms",value:"rooms"},{label:"Other Services ",value:"otherservices"}],p=["kitchen","bar","store"],c=[{label:"Select Item",value:null,disable:!0},...m],g=(0,k.iH)([]),w=(0,k.iH)([]),b=(0,k.iH)(null),v=(0,k.iH)({});function f(){n.value=`?from_date=${r.value}&to_date=${u.value}`,x(),i.value=null}function y(e){return"expenses"==e?(0,D.getExpensesReports)("/expenses"+n.value):"kitchen"==e?(0,D.getKitchenReports)("/expenses"+n.value):"bar"==e?(0,D.getBarReports)("/expenses"+n.value):"rooms"==e?(0,D.getRoomReports)("/expenses"+n.value):"otherservices"==e?(0,D.getOtherServicesReports)("/expenses"+n.value):"store"==e?(0,D.getStoreReports)("/incoming-stock"+n.value):new Promise(((e,l)=>{l()}))}function x(){b.value.validate().then((l=>{l&&(e.value=!0,g.value=[],w.value=[],y(d.value).then((e=>{p.includes(d.value)?w.value=e.data:g.value=e.data})).finally((()=>{e.value=!1})),b.value.resetValidation())}))}function q(){return(0,D.getGeneralSettings)("?name=PRINTERS").then((e=>{v.value=e.data.details["items"].find((e=>"rooms receipts"==e.item))||e.data.details["items"].find((e=>"receipts"==e.item))}))}return(0,t.bv)((()=>{q()})),{loadingData:e,toDateDialog:l,fromDateDialog:a,fromDate:r,toDate:u,tabs:o,selectedFilter:i,filterOptions:s,selectedExpensesOption:d,expensesOptions:c,expensesValidOptions:m,tableRows1:g,stockItemForm:b,table2Expenses:p,tableRows2:w,printingSettings:v,tableColumns1:[{label:"Created",field:"created",align:"left",name:"created"},{label:"Name",field:"name",align:"left",name:"name"},{label:"Amount",align:"left",name:"amount",field:e=>(0,_.formatPrice)(e.amount)}],tableColumns2:[{label:"Date",field:"date",align:"left",name:"date"},{label:"Name",field:e=>e.stock_item?e.stock_item.name:e.brand_item?e.brand_item.name:e.item?e.item.name:"",align:"left",name:"name"},{label:"Units",align:"left",name:"unit"},{label:"Available",align:"left",name:"available"},{label:"Total",align:"left",name:"total",field:"units"},{label:"Total Amount",field:e=>(0,_.formatPrice)(e.amount),align:"left",name:"amount"}],fromDateChanged(e,l,t){null!=r.value&&null!=u.value&&f(),a.value.hide()},toDateChanged(e,a,t){null!=r.value&&null!=u.value&&f(),l.value.hide()},filterOptionChanged(e){e&&(r.value=null,u.value=null,n.value=`?filter=${e}`,x())},expensesOptionChanged(){null===n.value&&""==n.value||x()}}}});var x=a(1639),q=a(9885),W=a(8326),P=a(4581),R=a(8149),C=a(8879),V=a(2765),O=a(4351),S=a(926),T=a(7355),Z=a(3532),H=a(7220),U=a(854),Q=a(8359),z=a(2146),Y=a(9984),j=a.n(Y);const E=(0,x.Z)(y,[["render",f]]),F=E;j()(y,"components",{QPage:q.Z,QForm:W.Z,QSelect:P.Z,QField:R.Z,QBtn:C.Z,QPopupProxy:V.Z,QDate:O.Z,QSeparator:S.Z,QTable:T.Z,QTr:Z.Z,QTd:H.Z,QInnerLoading:U.Z,QSpinnerIos:Q.Z}),j()(y,"directives",{ClosePopup:z.Z})}}]);