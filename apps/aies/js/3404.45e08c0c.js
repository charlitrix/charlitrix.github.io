"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[3404],{3404:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A}),t(6727);var l=t(9835),n=t(6970);const i={class:"row justify-end q-mb-md"},o={class:"bg-blue-7 q-pa-md text-white text-weight-medium"},s={key:0,class:"bg-blue-1"},r=(0,l._)("th",null,"Date",-1),d=(0,l._)("th",null,"Description",-1),u=(0,l._)("th",null,"Debit",-1),c=(0,l._)("th",null,"Credit",-1),p=(0,l._)("th",null,"Balance",-1),g=(0,l._)("th",null,"Actions",-1),m={key:1,class:"q-pa-md text-grey-9"},_={class:"bg-grey-3"},f={key:0,class:"text-no-wrap"},w={key:0,class:"text-no-wrap"},b={class:"text-no-wrap"},y={key:0,class:"row justify-center no-wrap q-gutter-x-sm"};function h(e,a,t,h,k,D){const v=(0,l.up)("q-breadcrumbs-el"),q=(0,l.up)("q-breadcrumbs"),T=(0,l.up)("q-btn"),B=(0,l.up)("q-btn-toggle"),j=(0,l.up)("q-markup-table"),E=(0,l.up)("q-spinner-ios"),x=(0,l.up)("q-inner-loading"),C=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(C,{class:"q-pa-xl"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{to:{name:"Ledgers"}},{default:(0,l.w5)((()=>[(0,l.Uk)("Ledgers")])),_:1})])),_:1}),(0,l._)("div",i,[e.permissionRequired("accounts","add_accountjournals")?((0,l.wg)(),(0,l.j4)(T,{key:0,color:"primary",label:"Add Entries",to:{name:"CreateTransaction"}})):(0,l.kq)("",!0)]),(0,l.Wm)(B,{modelValue:e.filterOption,"onUpdate:modelValue":[a[0]||(a[0]=a=>e.filterOption=a),e.filterOptionChanged],spread:"",unelevated:"",rounded:"","no-caps":"","text-color":"primary","toggle-color":"primary","toggle-text-color":"white",options:e.filterOptions,style:(0,n.j5)({border:"1px solid var(--q-primary)"}),class:"q-mb-md"},null,8,["modelValue","options","style","onUpdate:modelValue"]),(0,l._)("div",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.ledgersDataList,((a,t)=>((0,l.wg)(),(0,l.iD)("div",{key:t,class:"q-mb-xl"},[(0,l._)("div",o,(0,n.zw)(a.name)+" Account ",1),(0,l.Wm)(j,{flat:"",bordered:"",square:"","wrap-cells":"",separator:"vertical"},{default:(0,l.w5)((()=>[a.account_journals.length>0?((0,l.wg)(),(0,l.iD)("thead",s,[(0,l._)("tr",null,[r,d,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.additional_fields,((e,a)=>((0,l.wg)(),(0,l.iD)("th",{key:a,class:"text-capitalize"},(0,n.zw)(e),1)))),128)),u,c,p,g])])):((0,l.wg)(),(0,l.iD)("div",m,"No entries ...")),(0,l._)("tbody",_,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.account_journals,((t,i)=>((0,l.wg)(),(0,l.iD)("tr",{key:i},[(0,l._)("td",null,(0,n.zw)(e.parseDate(t.date)),1),(0,l._)("td",null,(0,n.zw)(t.description),1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.additional_fields,((a,i)=>((0,l.wg)(),(0,l.iD)("td",{key:i},(0,n.zw)(e.findFieldValue(t.additional_data,a)),1)))),128)),(0,l._)("td",null,["DEBIT"==t.entry_type?((0,l.wg)(),(0,l.iD)("span",f,(0,n.zw)(e.formatPrice(t.amount)),1)):(0,l.kq)("",!0)]),(0,l._)("td",null,["CREDIT"==t.entry_type?((0,l.wg)(),(0,l.iD)("span",w,(0,n.zw)(e.formatPrice(t.amount)),1)):(0,l.kq)("",!0)]),(0,l._)("td",null,[(0,l._)("span",b,(0,n.zw)(e.calculateBalance(i,a.account_journals)),1)]),(0,l._)("td",null,[!t.transaction||t.is_budget_entry||Object.keys(t.additional_data).includes("editable")&&!t.additional_data.editable?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",y,[e.permissionRequired("accounts","change_accountjournals")?((0,l.wg)(),(0,l.j4)(T,{key:0,flat:"",round:"",dense:"",color:"primary",icon:"edit",to:{name:"TransactionDetails",params:{id:t.transaction}}},null,8,["to"])):(0,l.kq)("",!0),e.permissionRequired("accounts","delete_accountjournals")?((0,l.wg)(),(0,l.j4)(T,{key:1,flat:"",round:"",dense:"",color:"red",icon:"delete",loading:e.submitting,onClick:a=>e.deleteEntry(t.transaction)},null,8,["loading","onClick"])):(0,l.kq)("",!0)]))])])))),128))])])),_:2},1024)])))),128))]),(0,l.Wm)(x,{dark:"",color:"primary",showing:e.loadingData},{default:(0,l.w5)((()=>[(0,l.Wm)(E,{size:"50px",color:"white"})])),_:1},8,["showing"])])),_:1})}t(6890),t(9665);var k=t(499),D=t(9302),v=(t(4170),t(1353)),q=t(1809),T=t(4019),B=t(8221),j=t(8339);const E=(0,l.aZ)({name:"BudgetDraft",setup(){const e=(0,D.Z)(),a=(0,v.F)(),t=(0,j.tv)(),{fiscalYear:n}=(0,q.Jk)(a),i=(0,k.iH)([]),o=(0,k.iH)(null),s=(0,k.iH)([]),r=(0,k.iH)(!1),d=(0,k.iH)(!1);function u(){d.value=!0,(0,T.getAccountsJournals)(o.value?`?filter=${o.value}`:"").then((e=>{i.value=[...e.data].map((e=>(0!=e.opening_balance&&e.account_journals.unshift({date:e.date,description:"Balance B/F",amount:e.opening_balance,entry_type:e.opening_balance>0?"DEBIT"==e.account_type.increase?"DEBIT":"CREDIT":"DEBIT"!=e.account_type.increase?"DEBIT":"CREDIT",comments:"",additional_data:{}}),e)))})).finally((()=>{d.value=!1}))}function c(){return(0,T.getFiscalYearFeatureSettings)(n.value.id,"?item=LEDGERS").then((a=>{a.data&&a.data.enabled||e.dialog({title:"Attention!!!",message:"Please enable ledger settings to access this page",noEscDismiss:!0,noBackdropDismiss:!0,persistent:!0}).onOk((()=>{t.push({name:"DocumentSettings"})})),a.data.enabled&&a.data.details.fields&&(s.value=a.data.details.fields.map((e=>e.name)))}))}return(0,l.bv)((()=>{c().then((()=>{u()}))})),{fiscalYear:n,ledgersDataList:i,filterOption:o,additional_fields:s,submitting:r,loadingData:d,filterOptions:[{label:"Today",value:"day"},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"All",value:null}],deleteEntry(a){e.dialog({title:"Confirm",message:"Please confirm delete",cancel:!0,persistent:!0}).onOk((()=>{r.value=!0,(0,T.deleteTransaction)(a).then((e=>{(0,B.displayNotification)(e.data,"positive"),u()})).catch((e=>{(0,B.displayNotification)(e.response.data,"red")})).finally((()=>{r.value=!1}))}))},calculateBalance(e,a){let t=a.slice(0,e+1).reduce(((e,a)=>e+a.amount),0);return t<0?`(${(0,B.formatPrice)(t)})`:(0,B.formatPrice)(t)},filterOptionChanged(e){u()},findFieldValue(e,a){if(e.ledger_additional_fields){let t=e.ledger_additional_fields.find((e=>e.label==a));return t?t.value:""}return""}}}});var x=t(1639),C=t(9885),Z=t(2605),z=t(8052),I=t(8879),O=t(1389),H=t(6933),Q=t(854),P=t(8359),R=t(9984),W=t.n(R);const Y=(0,x.Z)(E,[["render",h]]),A=Y;W()(E,"components",{QPage:C.Z,QBreadcrumbs:Z.Z,QBreadcrumbsEl:z.Z,QBtn:I.Z,QBtnToggle:O.Z,QMarkupTable:H.Z,QInnerLoading:Q.Z,QSpinnerIos:P.Z})}}]);