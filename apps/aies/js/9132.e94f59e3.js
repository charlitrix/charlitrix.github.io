"use strict";(globalThis["webpackChunkaies"]=globalThis["webpackChunkaies"]||[]).push([[9132],{9132:(e,a,l)=>{l.r(a),l.d(a,{default:()=>L});var t=l(9835),o=l(6970);const n={class:"q-px-xl q-pb-xl q-pt-lg column q-gutter-y-lg"},u=(0,t._)("div",{class:"text-h5"},"Accounts Category Details",-1),i={class:"column q-gutter-y-md q-mb-lg"},d={class:"q-px-lg"},c={class:"row justify-between"},m={key:0},s=(0,t._)("span",{else:""}," -- ",-1),r={class:"row no-wrap"};function p(e,a,l,p,g,f){const y=(0,t.up)("q-input"),b=(0,t.up)("q-btn"),_=(0,t.up)("q-form"),w=(0,t.up)("q-item-label"),v=(0,t.up)("q-item-section"),W=(0,t.up)("q-item"),A=(0,t.up)("q-list"),h=(0,t.up)("q-card"),V=(0,t.up)("q-spinner-ios"),q=(0,t.up)("q-inner-loading"),D=(0,t.up)("q-page"),C=(0,t.up)("q-toolbar-title"),k=(0,t.up)("q-toolbar"),U=(0,t.up)("q-separator"),x=(0,t.up)("q-select"),I=(0,t.up)("q-checkbox"),Z=(0,t.up)("q-card-section"),Q=(0,t.up)("q-card-actions"),S=(0,t.up)("q-dialog"),H=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(D,{class:"q-pa-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{flat:"",class:"q-mb-xl"},{default:(0,t.w5)((()=>[(0,t._)("div",n,[u,(0,t.Wm)(_,{ref:"accountCategoryForm",onSubmit:e.updateCategory},{default:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t.Wm)(y,{label:"Code",modelValue:e.categoryData.code,"onUpdate:modelValue":a[0]||(a[0]=a=>e.categoryData.code=a)},null,8,["modelValue"]),(0,t.Wm)(y,{label:"Name",modelValue:e.categoryData.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.categoryData.name=a),"lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t._)("div",d,[(0,t.Wm)(b,{rounded:"",class:"full-width",color:"primary",label:"Update",type:"submit",loading:e.submitting},null,8,["loading"])])])])),_:1},8,["onSubmit"]),(0,t._)("div",c,[(0,t._)("div",{class:"text-grey-9",style:(0,o.j5)({fontSize:"1.2rem"})}," Accounts ",4),(0,t.Wm)(b,{color:"primary",class:"q-px-xl",label:"Add Account",onClick:a[2]||(a[2]=a=>e.addAccountDialog=!e.addAccountDialog)})]),(0,t._)("div",null,[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(W,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,{class:"text-grey-8"},{default:(0,t.w5)((()=>[(0,t.Uk)("Code")])),_:1})])),_:1}),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,{class:"text-grey-8"},{default:(0,t.w5)((()=>[(0,t.Uk)("Name")])),_:1})])),_:1}),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,{class:"text-grey-8"},{default:(0,t.w5)((()=>[(0,t.Uk)("Opening Balance")])),_:1})])),_:1}),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,{class:"text-grey-8"},{default:(0,t.w5)((()=>[(0,t.Uk)("Type")])),_:1})])),_:1}),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,{class:"text-grey-8"},{default:(0,t.w5)((()=>[(0,t.Uk)("Actions")])),_:1})])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.categoryData.accounts,((a,l)=>((0,t.wg)(),(0,t.j4)(W,{key:l},{default:(0,t.w5)((()=>[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[a.code?((0,t.wg)(),(0,t.iD)("span",m,(0,o.zw)(a.code),1)):(0,t.kq)("",!0),s])),_:2},1024)])),_:2},1024),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(a.name),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.formatPrice(a.opening_balance)),1)])),_:2},1024),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(a.accounttype.name),1)])),_:2},1024),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t._)("div",r,[(0,t.Wm)(b,{flat:"",round:"",color:"primary",icon:"edit",onClick:a=>e.selectEditAccount(l),loading:e.submitting},null,8,["onClick","loading"]),(0,t.Wm)(b,{flat:"",round:"",color:"red",icon:"delete",onClick:l=>e.showDeleteDialog(a.id),loading:e.submitting},null,8,["onClick","loading"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])])),_:1}),(0,t.Wm)(q,{dark:"",color:"primary",showing:e.loadingData},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{size:"50px",color:"white"})])),_:1},8,["showing"])])),_:1}),(0,t.Wm)(S,{persistent:"",modelValue:e.addAccountDialog,"onUpdate:modelValue":a[8]||(a[8]=a=>e.addAccountDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{style:{width:"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{ref:"addAccountForm",onSubmit:e.addAccount},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Uk)("New Account")])),_:1}),(0,t.wy)((0,t.Wm)(b,{flat:"",round:"",size:"md",icon:"close"},null,512),[[H]])])),_:1}),(0,t.Wm)(U),(0,t.Wm)(Z,{class:"column q-gutter-y-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{"map-options":"","emit-value":"",loading:e.loadingOptions,modelValue:e.accountItem.account_type,"onUpdate:modelValue":a[3]||(a[3]=a=>e.accountItem.account_type=a),options:e.accountTypesOptions,"option-label":"name","option-value":"id",label:"Type","lazy-rules":"ondemand",rules:e.selectInputRequiredRules(e.accountTypesOptions.map((e=>e.id)))},null,8,["loading","modelValue","options","rules"]),(0,t.Wm)(y,{modelValue:e.accountItem.code,"onUpdate:modelValue":a[4]||(a[4]=a=>e.accountItem.code=a),modelModifiers:{trim:!0},label:"Code"},null,8,["modelValue"]),(0,t.Wm)(y,{modelValue:e.accountItem.name,"onUpdate:modelValue":a[5]||(a[5]=a=>e.accountItem.name=a),modelModifiers:{trim:!0},label:"Name","input-class":"text-capitalize","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(y,{modelValue:e.accountItem.opening_balance,"onUpdate:modelValue":a[6]||(a[6]=a=>e.accountItem.opening_balance=a),modelModifiers:{number:!0},label:"Opening Balance",type:"number","lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(I,{modelValue:e.accountItem.cash_analysis,"onUpdate:modelValue":a[7]||(a[7]=a=>e.accountItem.cash_analysis=a),label:"Add to Cash Analysis"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(Q,{align:"evenly",class:"q-mb-lg q-mx-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{rounded:"",label:"Add",type:"submit",class:"full-width",color:"primary",loading:e.submitting},null,8,["loading"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(S,{persistent:"",modelValue:e.editAccountDialog,"onUpdate:modelValue":a[13]||(a[13]=a=>e.editAccountDialog=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{style:{width:"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{ref:"accountUpdateForm",onSubmit:e.submitEditAccountData},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Update Account Details")])),_:1}),(0,t.wy)((0,t.Wm)(b,{flat:"",round:"",size:"md",icon:"close"},null,512),[[H]])])),_:1}),(0,t.Wm)(U),(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:e.editAccountData.code,"onUpdate:modelValue":a[9]||(a[9]=a=>e.editAccountData.code=a),modelModifiers:{trim:!0},label:"Code"},null,8,["modelValue"]),(0,t.Wm)(y,{modelValue:e.editAccountData.name,"onUpdate:modelValue":a[10]||(a[10]=a=>e.editAccountData.name=a),modelModifiers:{trim:!0},label:"Name","lazy-rules":"ondemand",rules:e.textInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(y,{modelValue:e.editAccountData.opening_balance,"onUpdate:modelValue":a[11]||(a[11]=a=>e.editAccountData.opening_balance=a),modelModifiers:{number:!0},label:"Opening Balance",type:"number","lazy-rules":"ondemand",rules:e.numberInputRequiredRules()},null,8,["modelValue","rules"]),(0,t.Wm)(I,{modelValue:e.editAccountData.cash_analysis,"onUpdate:modelValue":a[12]||(a[12]=a=>e.editAccountData.cash_analysis=a),label:"Add to Cash Analysis"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(Q,{align:"evenly",class:"q-mb-lg q-mx-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{rounded:"",label:"Update",class:"full-width",color:"primary",type:"submit",loading:e.submitting},null,8,["loading"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])],64)}var g=l(499),f=l(9302),y=l(8221),b=l(4019),_=l(1353),w=l(1809);const v=(0,t.aZ)({name:"AccountsEdit",props:["id"],setup(e){const a=(0,f.Z)(),l=(0,_.F)(),{fiscalYear:o}=(0,w.Jk)(l),n=(0,g.iH)({}),u=(0,g.iH)(!0),i=(0,g.iH)(!1),d=(0,g.iH)(!1),c=(0,g.iH)({}),m=(0,g.iH)(!1),s=(0,g.iH)({cash_analysis:!1,opening_balance:0,code:""}),r=(0,g.iH)([]),p=(0,g.iH)(!1),v=(0,g.iH)(null),W=(0,g.iH)(null),A=(0,g.iH)(null);function h(){return u.value=!0,(0,b.getAccountCategory)(e.id).then((e=>{n.value=e.data})).finally((()=>{u.value=!1}))}return(0,t.bv)((()=>{h().then((()=>{p.value=!0,(0,b.getFiscalYearAccountTypes)(o.value.id).then((e=>{r.value=e.data})).finally((()=>{p.value=!1}))}))})),{categoryData:n,loadingData:u,submitting:i,addAccountDialog:m,accountItem:s,loadingOptions:p,accountTypesOptions:r,editAccountData:c,editAccountDialog:d,accountCategoryForm:v,accountUpdateForm:W,addAccountForm:A,selectEditAccount(e){let a={...n.value.accounts[e]};c.value={id:a.id,code:a.code?a.code:"",name:a.name,opening_balance:a.opening_balance,cash_analysis:!(!a.additional_data.CASH_ANALYSIS||!a.additional_data.CASH_ANALYSIS.enabled)},d.value=!0},updateCategory(){v.value.validate().then((l=>{a.dialog({title:"Confirmation",message:"Confirm update",cancel:!0}).onOk((()=>{i.value=!0,(0,b.updateAccountCategory)(e.id,{code:n.value.code,name:n.value.name,additional_data:n.value.additional_data}).then((e=>{(0,y.displayNotification)(e.data,"positive"),v.value.resetValidation(),h()})).catch((e=>{(0,y.displayNotification)(e.response.data,"negative")})).finally((()=>{i.value=!1}))}))}))},addAccount(){A.value.validate().then((e=>{a.dialog({title:"Confirmation",message:"Confirm update",cancel:!0}).onOk((()=>{i.value=!0,(0,b.createFiscalYearAccount)(o.value.id,{id:n.value.id,name:n.value.name,code:n.value.code?n.value.code:"",accounts:[s.value]}).then((e=>{(0,y.displayNotification)(e.data,"positive"),m.value=!1,A.value.resetValidation(),h()})).catch((e=>{(0,y.displayNotification)(e.response.data,"negative")})).finally((()=>{i.value=!1}))}))}))},submitEditAccountData(){W.value.validate().then((e=>{e&&a.dialog({title:"Confirmation",message:"Confirm update",cancel:!0}).onOk((()=>{i.value=!0;let e=c.value.id;delete c.value.id,(0,b.updateAccount)(e,{...c.value}).then((e=>{(0,y.displayNotification)(e.data,"positive"),d.value=!1,W.value.resetValidation(),h()})).catch((e=>{(0,y.displayNotification)(e.response.data,"negative")})).finally((()=>{i.value=!1}))}))}))},showDeleteDialog(e){a.dialog({title:"Confirm",message:"Please confirm delete",cancel:!0}).onOk((()=>{i.value=!0,(0,b.deleteAccount)(e).then((e=>{(0,y.displayNotification)(e.data,"positive"),h()})).finally((()=>{i.value=!1})).catch((e=>{(0,y.displayNotification)(e.response.data,"negative")}))}))}}}});var W=l(1639),A=l(9885),h=l(4458),V=l(8326),q=l(6611),D=l(8879),C=l(3246),k=l(490),U=l(1233),x=l(3115),I=l(854),Z=l(8359),Q=l(2074),S=l(1663),H=l(1973),z=l(926),N=l(3190),O=l(4581),R=l(1221),T=l(1821),F=l(2146),Y=l(9984),M=l.n(Y);const E=(0,W.Z)(v,[["render",p]]),L=E;M()(v,"components",{QPage:A.Z,QCard:h.Z,QForm:V.Z,QInput:q.Z,QBtn:D.Z,QList:C.Z,QItem:k.Z,QItemSection:U.Z,QItemLabel:x.Z,QInnerLoading:I.Z,QSpinnerIos:Z.Z,QDialog:Q.Z,QToolbar:S.Z,QToolbarTitle:H.Z,QSeparator:z.Z,QCardSection:N.Z,QSelect:O.Z,QCheckbox:R.Z,QCardActions:T.Z}),M()(v,"directives",{ClosePopup:F.Z})}}]);